import{useApi as t,defineInterface as e}from"@directus/extensions-sdk";import{defineComponent as a,ref as r,inject as n,resolveComponent as o,openBlock as i,createElementBlock as s,Fragment as l,createCommentVNode as c,createVNode as d,withCtx as u,createTextVNode as f,createBlock as h,toDisplayString as p}from"vue";for(var y={},m={byteLength:function(t){var e=E(t),a=e[0],r=e[1];return 3*(a+r)/4-r},toByteArray:function(t){var e,a,r=E(t),n=r[0],o=r[1],i=new w(function(t,e,a){return 3*(e+a)/4-a}(0,n,o)),s=0,l=o>0?n-4:n;for(a=0;a<l;a+=4)e=v[t.charCodeAt(a)]<<18|v[t.charCodeAt(a+1)]<<12|v[t.charCodeAt(a+2)]<<6|v[t.charCodeAt(a+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=255&e;2===o&&(e=v[t.charCodeAt(a)]<<2|v[t.charCodeAt(a+1)]>>4,i[s++]=255&e);1===o&&(e=v[t.charCodeAt(a)]<<10|v[t.charCodeAt(a+1)]<<4|v[t.charCodeAt(a+2)]>>2,i[s++]=e>>8&255,i[s++]=255&e);return i},fromByteArray:function(t){for(var e,a=t.length,r=a%3,n=[],o=16383,i=0,s=a-r;i<s;i+=o)n.push(b(t,i,i+o>s?s:i+o));1===r?(e=t[a-1],n.push(g[e>>2]+g[e<<4&63]+"==")):2===r&&(e=(t[a-2]<<8)+t[a-1],n.push(g[e>>10]+g[e>>4&63]+g[e<<2&63]+"="));return n.join("")}},g=[],v=[],w="undefined"!=typeof Uint8Array?Uint8Array:Array,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=0;$<64;++$)g[$]=_[$],v[_.charCodeAt($)]=$;function E(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=t.indexOf("=");return-1===a&&(a=e),[a,a===e?0:4-a%4]}function b(t,e,a){for(var r,n,o=[],i=e;i<a;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),o.push(g[(n=r)>>18&63]+g[n>>12&63]+g[n>>6&63]+g[63&n]);return o.join("")}v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63;var A={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,a,r,n){var o,i,s=8*n-r-1,l=(1<<s)-1,c=l>>1,d=-7,u=a?n-1:0,f=a?-1:1,h=t[e+u];for(u+=f,o=h&(1<<-d)-1,h>>=-d,d+=s;d>0;o=256*o+t[e+u],u+=f,d-=8);for(i=o&(1<<-d)-1,o>>=-d,d+=r;d>0;i=256*i+t[e+u],u+=f,d-=8);if(0===o)o=1-c;else{if(o===l)return i?NaN:1/0*(h?-1:1);i+=Math.pow(2,r),o-=c}return(h?-1:1)*i*Math.pow(2,o-r)},write:function(t,e,a,r,n,o){var i,s,l,c=8*o-n-1,d=(1<<c)-1,u=d>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,i=d):(i=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-i))<1&&(i--,l*=2),(e+=i+u>=1?f/l:f*Math.pow(2,1-u))*l>=2&&(i++,l/=2),i+u>=d?(s=0,i=d):i+u>=1?(s=(e*l-1)*Math.pow(2,n),i+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,n),i=0));n>=8;t[a+h]=255&s,h+=p,s/=256,n-=8);for(i=i<<n|s,c+=n;c>0;t[a+h]=255&i,h+=p,i/=256,c-=8);t[a+h-p]|=128*y}};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
!function(t){var e=m,a=A,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=i,t.SlowBuffer=function(t){+t!=t&&(t=0);return i.alloc(+t)},t.INSPECT_MAX_BYTES=50;var n=2147483647;function o(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,i.prototype),e}function i(t,e,a){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return c(t)}return s(t,e,a)}function s(t,e,a){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var a=0|h(t,e),r=o(a),n=r.write(t,e);n!==a&&(r=r.slice(0,n));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(j(t,Uint8Array)){var e=new Uint8Array(t);return u(e.buffer,e.byteOffset,e.byteLength)}return d(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(j(t,ArrayBuffer)||t&&j(t.buffer,ArrayBuffer))return u(t,e,a);if("undefined"!=typeof SharedArrayBuffer&&(j(t,SharedArrayBuffer)||t&&j(t.buffer,SharedArrayBuffer)))return u(t,e,a);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return i.from(r,e,a);var n=function(t){if(i.isBuffer(t)){var e=0|f(t.length),a=o(e);return 0===a.length||t.copy(a,0,0,e),a}if(void 0!==t.length)return"number"!=typeof t.length||V(t.length)?o(0):d(t);if("Buffer"===t.type&&Array.isArray(t.data))return d(t.data)}(t);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return i.from(t[Symbol.toPrimitive]("string"),e,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function c(t){return l(t),o(t<0?0:0|f(t))}function d(t){for(var e=t.length<0?0:0|f(t.length),a=o(e),r=0;r<e;r+=1)a[r]=255&t[r];return a}function u(t,e,a){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(a||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===a?new Uint8Array(t):void 0===a?new Uint8Array(t,e):new Uint8Array(t,e,a),Object.setPrototypeOf(r,i.prototype),r}function f(t){if(t>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function h(t,e){if(i.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var a=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===a)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return x(t).length;default:if(n)return r?-1:F(t).length;e=(""+e).toLowerCase(),n=!0}}function p(t,e,a){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if((a>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,a);case"utf8":case"utf-8":return D(this,e,a);case"ascii":return S(this,e,a);case"latin1":case"binary":return N(this,e,a);case"base64":return C(this,e,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,a);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,a){var r=t[e];t[e]=t[a],t[a]=r}function g(t,e,a,r,n){if(0===t.length)return-1;if("string"==typeof a?(r=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),V(a=+a)&&(a=n?0:t.length-1),a<0&&(a=t.length+a),a>=t.length){if(n)return-1;a=t.length-1}else if(a<0){if(!n)return-1;a=0}if("string"==typeof e&&(e=i.from(e,r)),i.isBuffer(e))return 0===e.length?-1:v(t,e,a,r,n);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,a):Uint8Array.prototype.lastIndexOf.call(t,e,a):v(t,[e],a,r,n);throw new TypeError("val must be string, number or Buffer")}function v(t,e,a,r,n){var o,i=1,s=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;i=2,s/=2,l/=2,a/=2}function c(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(n){var d=-1;for(o=a;o<s;o++)if(c(t,o)===c(e,-1===d?0:o-d)){if(-1===d&&(d=o),o-d+1===l)return d*i}else-1!==d&&(o-=o-d),d=-1}else for(a+l>s&&(a=s-l),o=a;o>=0;o--){for(var u=!0,f=0;f<l;f++)if(c(t,o+f)!==c(e,f)){u=!1;break}if(u)return o}return-1}function w(t,e,a,r){a=Number(a)||0;var n=t.length-a;r?(r=Number(r))>n&&(r=n):r=n;var o=e.length;r>o/2&&(r=o/2);for(var i=0;i<r;++i){var s=parseInt(e.substr(2*i,2),16);if(V(s))return i;t[a+i]=s}return i}function _(t,e,a,r){return L(F(e,t.length-a),t,a,r)}function $(t,e,a,r){return L(function(t){for(var e=[],a=0;a<t.length;++a)e.push(255&t.charCodeAt(a));return e}(e),t,a,r)}function E(t,e,a,r){return L(x(e),t,a,r)}function b(t,e,a,r){return L(function(t,e){for(var a,r,n,o=[],i=0;i<t.length&&!((e-=2)<0);++i)r=(a=t.charCodeAt(i))>>8,n=a%256,o.push(n),o.push(r);return o}(e,t.length-a),t,a,r)}function C(t,a,r){return 0===a&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(a,r))}function D(t,e,a){a=Math.min(t.length,a);for(var r=[],n=e;n<a;){var o,i,s,l,c=t[n],d=null,u=c>239?4:c>223?3:c>191?2:1;if(n+u<=a)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(o=t[n+1]))&&(l=(31&c)<<6|63&o)>127&&(d=l);break;case 3:o=t[n+1],i=t[n+2],128==(192&o)&&128==(192&i)&&(l=(15&c)<<12|(63&o)<<6|63&i)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:o=t[n+1],i=t[n+2],s=t[n+3],128==(192&o)&&128==(192&i)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&i)<<6|63&s)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),n+=u}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);var a="",r=0;for(;r<e;)a+=String.fromCharCode.apply(String,t.slice(r,r+=I));return a}(r)}t.kMaxLength=n,i.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(t,e,a){return s(t,e,a)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(t,e,a){return function(t,e,a){return l(t),t<=0?o(t):void 0!==e?"string"==typeof a?o(t).fill(e,a):o(t).fill(e):o(t)}(t,e,a)},i.allocUnsafe=function(t){return c(t)},i.allocUnsafeSlow=function(t){return c(t)},i.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==i.prototype},i.compare=function(t,e){if(j(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var a=t.length,r=e.length,n=0,o=Math.min(a,r);n<o;++n)if(t[n]!==e[n]){a=t[n],r=e[n];break}return a<r?-1:r<a?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var a;if(void 0===e)for(e=0,a=0;a<t.length;++a)e+=t[a].length;var r=i.allocUnsafe(e),n=0;for(a=0;a<t.length;++a){var o=t[a];if(j(o,Uint8Array))n+o.length>r.length?i.from(o).copy(r,n):Uint8Array.prototype.set.call(r,o,n);else{if(!i.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,n)}n+=o.length}return r},i.byteLength=h,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},i.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?D(this,0,t):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var e="",a=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(e+=" ... "),"<Buffer "+e+">"},r&&(i.prototype[r]=i.prototype.inspect),i.prototype.compare=function(t,e,a,r,n){if(j(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===a&&(a=t?t.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),e<0||a>t.length||r<0||n>this.length)throw new RangeError("out of range index");if(r>=n&&e>=a)return 0;if(r>=n)return-1;if(e>=a)return 1;if(this===t)return 0;for(var o=(n>>>=0)-(r>>>=0),s=(a>>>=0)-(e>>>=0),l=Math.min(o,s),c=this.slice(r,n),d=t.slice(e,a),u=0;u<l;++u)if(c[u]!==d[u]){o=c[u],s=d[u];break}return o<s?-1:s<o?1:0},i.prototype.includes=function(t,e,a){return-1!==this.indexOf(t,e,a)},i.prototype.indexOf=function(t,e,a){return g(this,t,e,a,!0)},i.prototype.lastIndexOf=function(t,e,a){return g(this,t,e,a,!1)},i.prototype.write=function(t,e,a,r){if(void 0===e)r="utf8",a=this.length,e=0;else if(void 0===a&&"string"==typeof e)r=e,a=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(a)?(a>>>=0,void 0===r&&(r="utf8")):(r=a,a=void 0)}var n=this.length-e;if((void 0===a||a>n)&&(a=n),t.length>0&&(a<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,a);case"utf8":case"utf-8":return _(this,t,e,a);case"ascii":case"latin1":case"binary":return $(this,t,e,a);case"base64":return E(this,t,e,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,t,e,a);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function S(t,e,a){var r="";a=Math.min(t.length,a);for(var n=e;n<a;++n)r+=String.fromCharCode(127&t[n]);return r}function N(t,e,a){var r="";a=Math.min(t.length,a);for(var n=e;n<a;++n)r+=String.fromCharCode(t[n]);return r}function P(t,e,a){var r=t.length;(!e||e<0)&&(e=0),(!a||a<0||a>r)&&(a=r);for(var n="",o=e;o<a;++o)n+=q[t[o]];return n}function O(t,e,a){for(var r=t.slice(e,a),n="",o=0;o<r.length-1;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}function T(t,e,a){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>a)throw new RangeError("Trying to access beyond buffer length")}function U(t,e,a,r,n,o){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw new RangeError('"value" argument is out of bounds');if(a+r>t.length)throw new RangeError("Index out of range")}function B(t,e,a,r,n,o){if(a+r>t.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function M(t,e,r,n,o){return e=+e,r>>>=0,o||B(t,0,r,4),a.write(t,e,r,n,23,4),r+4}function k(t,e,r,n,o){return e=+e,r>>>=0,o||B(t,0,r,8),a.write(t,e,r,n,52,8),r+8}i.prototype.slice=function(t,e){var a=this.length;(t=~~t)<0?(t+=a)<0&&(t=0):t>a&&(t=a),(e=void 0===e?a:~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,i.prototype),r},i.prototype.readUintLE=i.prototype.readUIntLE=function(t,e,a){t>>>=0,e>>>=0,a||T(t,e,this.length);for(var r=this[t],n=1,o=0;++o<e&&(n*=256);)r+=this[t+o]*n;return r},i.prototype.readUintBE=i.prototype.readUIntBE=function(t,e,a){t>>>=0,e>>>=0,a||T(t,e,this.length);for(var r=this[t+--e],n=1;e>0&&(n*=256);)r+=this[t+--e]*n;return r},i.prototype.readUint8=i.prototype.readUInt8=function(t,e){return t>>>=0,e||T(t,1,this.length),this[t]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(t,e){return t>>>=0,e||T(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(t,e){return t>>>=0,e||T(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(t,e){return t>>>=0,e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(t,e){return t>>>=0,e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,a){t>>>=0,e>>>=0,a||T(t,e,this.length);for(var r=this[t],n=1,o=0;++o<e&&(n*=256);)r+=this[t+o]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*e)),r},i.prototype.readIntBE=function(t,e,a){t>>>=0,e>>>=0,a||T(t,e,this.length);for(var r=e,n=1,o=this[t+--r];r>0&&(n*=256);)o+=this[t+--r]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*e)),o},i.prototype.readInt8=function(t,e){return t>>>=0,e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){t>>>=0,e||T(t,2,this.length);var a=this[t]|this[t+1]<<8;return 32768&a?4294901760|a:a},i.prototype.readInt16BE=function(t,e){t>>>=0,e||T(t,2,this.length);var a=this[t+1]|this[t]<<8;return 32768&a?4294901760|a:a},i.prototype.readInt32LE=function(t,e){return t>>>=0,e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return t>>>=0,e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return t>>>=0,e||T(t,4,this.length),a.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return t>>>=0,e||T(t,4,this.length),a.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return t>>>=0,e||T(t,8,this.length),a.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return t>>>=0,e||T(t,8,this.length),a.read(this,t,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(t,e,a,r){(t=+t,e>>>=0,a>>>=0,r)||U(this,t,e,a,Math.pow(2,8*a)-1,0);var n=1,o=0;for(this[e]=255&t;++o<a&&(n*=256);)this[e+o]=t/n&255;return e+a},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(t,e,a,r){(t=+t,e>>>=0,a>>>=0,r)||U(this,t,e,a,Math.pow(2,8*a)-1,0);var n=a-1,o=1;for(this[e+n]=255&t;--n>=0&&(o*=256);)this[e+n]=t/o&255;return e+a},i.prototype.writeUint8=i.prototype.writeUInt8=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,1,255,0),this[e]=255&t,e+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeIntLE=function(t,e,a,r){if(t=+t,e>>>=0,!r){var n=Math.pow(2,8*a-1);U(this,t,e,a,n-1,-n)}var o=0,i=1,s=0;for(this[e]=255&t;++o<a&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+a},i.prototype.writeIntBE=function(t,e,a,r){if(t=+t,e>>>=0,!r){var n=Math.pow(2,8*a-1);U(this,t,e,a,n-1,-n)}var o=a-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+a},i.prototype.writeInt8=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeInt16BE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeInt32LE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},i.prototype.writeInt32BE=function(t,e,a){return t=+t,e>>>=0,a||U(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeFloatLE=function(t,e,a){return M(this,t,e,!0,a)},i.prototype.writeFloatBE=function(t,e,a){return M(this,t,e,!1,a)},i.prototype.writeDoubleLE=function(t,e,a){return k(this,t,e,!0,a)},i.prototype.writeDoubleBE=function(t,e,a){return k(this,t,e,!1,a)},i.prototype.copy=function(t,e,a,r){if(!i.isBuffer(t))throw new TypeError("argument should be a Buffer");if(a||(a=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<a&&(r=a),r===a)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-a&&(r=t.length-e+a);var n=r-a;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,a,r):Uint8Array.prototype.set.call(t,this.subarray(a,r),e),n},i.prototype.fill=function(t,e,a,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,a=this.length):"string"==typeof a&&(r=a,a=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var n=t.charCodeAt(0);("utf8"===r&&n<128||"latin1"===r)&&(t=n)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<a)throw new RangeError("Out of range index");if(a<=e)return this;var o;if(e>>>=0,a=void 0===a?this.length:a>>>0,t||(t=0),"number"==typeof t)for(o=e;o<a;++o)this[o]=t;else{var s=i.isBuffer(t)?t:i.from(t,r),l=s.length;if(0===l)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<a-e;++o)this[o+e]=s[o%l]}return this};var R=/[^+/0-9A-Za-z-_]/g;function F(t,e){var a;e=e||1/0;for(var r=t.length,n=null,o=[],i=0;i<r;++i){if((a=t.charCodeAt(i))>55295&&a<57344){if(!n){if(a>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(i+1===r){(e-=3)>-1&&o.push(239,191,189);continue}n=a;continue}if(a<56320){(e-=3)>-1&&o.push(239,191,189),n=a;continue}a=65536+(n-55296<<10|a-56320)}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,a<128){if((e-=1)<0)break;o.push(a)}else if(a<2048){if((e-=2)<0)break;o.push(a>>6|192,63&a|128)}else if(a<65536){if((e-=3)<0)break;o.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return o}function x(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(R,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function L(t,e,a,r){for(var n=0;n<r&&!(n+a>=e.length||n>=t.length);++n)e[n+a]=t[n];return n}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function V(t){return t!=t}var q=function(){for(var t="0123456789abcdef",e=new Array(256),a=0;a<16;++a)for(var r=16*a,n=0;n<16;++n)e[r+n]=t[a]+t[n];return e}()}(y);var C=(t=>(t.BRACKET="Bracket",t.MIN_DEDUCTION="Minimum Deduction",t.MAX_CAP="Maximum Cap",t))(C||{}),D=(t=>(t.PERCENTAGE="Percentage",t.FRACTIONAL="Fractional",t))(D||{}),I=(t=>(t.WET_WEIGHT="wet_weight",t.MOISTURE="moisture",t.DRY_WEIGHT="dry_weight",t))(I||{}),S=(t=>(t.METHOD="method",t.WET_WEIGHT_UOM="wet_weight_uom",t.MOISTURE_UOM="moisture_uom",t.DRY_WEIGHT_UOM="dry_weight_uom",t))(S||{});const N={Advance:0,"Second Advance":1,"Third Advance":2,"Fourth Advance":3,Provisional:4,"Second Provisional":5,"Third Provisional":6,"Fourth Provisional":7,Final:8};var P=a({props:{value:{type:Object,default:null}},emits:["input"],setup(e,{emit:a}){const o=r(""),i=r(!1),s=r(!1),l=t(),c=n("values",r({}));function d(t){if(console.log("[evaluateWeightData]"),0===t.length)return;const e=f(t,I.DRY_WEIGHT),a=f(t,I.WET_WEIGHT);return{method:u(t,S.METHOD),lots:t,dry_weight_uom:u(t,S.DRY_WEIGHT_UOM),wet_weight_uom:u(t,S.WET_WEIGHT_UOM),dry_weight:e,wet_weight:a,moisture:(a-e)/a*100}}function u(t,e){if(console.log("[getFirstValueAsSharedValue]"),0!==t.length)return console.log(`lots[0][${e.toString()}]=${t[0][e.toString()]}`),t[0][e.toString()]}function f(t,e){return console.log("[evaluateAggregateValue]"),t.reduce(((t,a)=>{var r;return t+(null!=(r=a[e.toString()])?r:0)}),0)}function h(t){return null==t}function p(t,e=2,a=!0){if(console.log("[formatNumber]"),isNaN(t)||null===t)return"-";const r=Math.round(t*Math.pow(10,e))/Math.pow(10,e),[n,o]=r.toString().split("."),i=n.replace(/\B(?=(\d{3})+(?!\d))/g,",");if(!o&&!a)return i;return`${i}.${(null!=o?o:"").padEnd(e,"0")}`}function m(t){if(console.log("[parseNumber]"),!t)return 0;const e=parseFloat(t.replace(/,/g,""));return console.log(`[parseNumber] number: ${t} to ${e}`),e}function g(t,e,a){var r,n,o;if(console.log("[findBracket]"),1===t.length){if(e>=(null!=(r=t[0].lower_threshold)?r:0)&&(null===t[0].upper_threshold||void 0===t[0].upper_threshold||e<t[0].upper_threshold))return t[0];throw new Error(`Evaluated monetary value $${e} does not fall within the only ${a.type} bracket with range ${null!=(n=t[0].lower_threshold)?n:0} - ${null!=(o=t[0].upper_threshold)?o:"∞"}`)}return t.find((t=>{var a,r;const n=e>(null!=(a=t.lower_threshold)?a:0)&&(null===t.upper_threshold||void 0===t.upper_threshold||e<t.upper_threshold)||t.lower_threshold_inclusive&&e===(null!=(r=t.lower_threshold)?r:0)||t.upper_threshold_inclusive&&e===t.upper_threshold;return console.log(`[findBracket] value=${e} for bracket: ${JSON.stringify(t)}? match=${!!n}`),n}))}function v(t,e){var a,r,n,o,i,s,l;console.log("[evaluateFinalValueFromBrackets]");const c=(t-(null!=(a=e.initial_adjustment)?a:0)*(null!=(r=e.initial_adjustment_conversion_factor)?r:1))*(null!=(n=e.rate)?n:0)*(e.rate_type===D.PERCENTAGE?.01:1)+(null!=(o=e.final_adjustment)?o:0)*(null!=(i=e.final_adjustment_conversion_factor)?i:1);switch(e.bracket_type){case C.MIN_DEDUCTION:if(null===e.comparator||void 0===e.comparator)throw new Error("Minimum deduction not found");const a=e.comparator*(null!=(s=e.comparator_conversion_factor)?s:1);return t-c<a?t-a:c;case C.MAX_CAP:if(null===e.comparator||void 0===e.comparator)throw new Error("Maximum cap not found");const r=e.comparator*(null!=(l=e.comparator_conversion_factor)?l:1);return c>r?r:c;case C.BRACKET:return c;default:throw new Error(`bracket type ${e.bracket_type} is not supported`)}}async function w(t,e,a,r){var n,o,i,s,l,c,d,u;if(console.log("[evaluatePayableAssay]"),!a||0===a.length)return{};const f=g(a,t,{commodityCode:r,type:"Payable Assay"});if(!f)throw new Error(`Bracket not found for value ${t}, please ensure the brackets for all commodities defined in the contract cover all range of possible values for payable assays`);let h,y,m=1;f.initial_adjustment_uom&&void 0!==f.initial_adjustment_uom&&null!==f.initial_adjustment_uom&&f.initial_adjustment_uom!==e&&(m=await k(f.initial_adjustment_uom,e),h=R(f.initial_adjustment_uom,e));let w,_=1;f.bracket_type===C.MAX_CAP?(y=null!=(n=f.maximum_cap)?n:0,void 0!==f.maximum_cap_uom&&null!==f.maximum_cap_uom&&f.maximum_cap_uom!==e&&(_=await k(f.maximum_cap_uom,e),w=R(f.maximum_cap_uom,e))):f.bracket_type===C.MIN_DEDUCTION&&(y=null!=(o=f.minimum_deduction)?o:0,void 0!==f.minimum_deduction_uom&&null!==f.minimum_deduction_uom&&f.minimum_deduction_uom!==e&&(_=await k(f.minimum_deduction_uom,e),w=R(f.minimum_deduction_uom,e)));const $=v(t,{bracket_type:f.bracket_type,rate:null!=(i=f.rate)?i:1,rate_type:null!=(s=f.rate_type)?s:D.FRACTIONAL,initial_adjustment:null!=(l=f.initial_adjustment)?l:0,initial_adjustment_conversion_factor:m,comparator:y,comparator_conversion_factor:_});let E="";const b=void 0!==f.initial_adjustment&&null!==f.initial_adjustment;if(f.bracket_type===C.BRACKET)E=`${b?"(":""}${p(t,4)}${null!=e?e:""}${b?` - ${p(f.initial_adjustment,4)}${null!=(c=f.initial_adjustment_uom)?c:`${null!=e?e:""}`}`:""}${b&&1!==m?` * ${p(m,4)}${h}`:""}${b?")":""} * ${p(f.rate,4)}${f.rate_type===D.PERCENTAGE?"/100":`/${p(1,4)}`}`;else if(f.bracket_type===C.MIN_DEDUCTION){E=$===t-y*_?`${p(t,4)}${null!=e?e:""} - ${p(y,4)}${null!=e?e:""}${1!==_?` * ${p(_,4)}${w}`:""}`:`${b?"(":""}${p(t,4)}${null!=e?e:""}${b?` - ${p(f.initial_adjustment,4)}${null!=(d=f.initial_adjustment_uom)?d:`${null!=e?e:""}`}`:""}${b&&1!==m?` * ${p(m,4)}${h}`:""}${b?")":""} * ${p(f.rate,4)}${f.rate_type===D.PERCENTAGE?"/100":`/${p(1,4)}`}`}else{if(f.bracket_type!==C.MAX_CAP)throw new Error(`[buildPayableAssayExpression] unknown bracket method: ${f.bracket_type}`);E=$===y*_?`${p(y,4)}${null!=e?e:""}${1!==_?` * ${p(_,4)}${w}`:""}`:`${b?"(":""}${p(t,4)}${null!=e?e:""}${b?` - ${p(f.initial_adjustment,4)}${null!=(u=f.initial_adjustment_uom)?u:`${null!=e?e:""}`}`:""}${b&&1!==m?` * ${p(m,4)}${h}`:""}${b?")":""} * ${p(f.rate,4)}${f.rate_type===D.PERCENTAGE?"/100":`/${p(1,4)}`}`}return{payableAssay:$,expression:E}}console.log("[main] formValues=",c);const _="above the lower threshold, plus",$="below the upper threshold, minus";function E(t,e,a,r,n){var o,i,s,l,c;if(console.log("[evaluateCharge]"),!a||!a.length)return;const d=g(a,t,{commodityCode:r,type:n});if(!d)throw new Error(`Bracket not found for value ${t}, please ensure the brackets for all commodities defined in the contract cover all range of possible values for ${n}`);let u=0,f=1;const h=null!=(o=d.escalator_reference)?o:1;if(d.use_btc)f=0,u=0;else if(f=(null!=(i=d.rate)?i:1)/h,d.for_every_unit===_)u=null!=(s=d.lower_threshold)?s:0;else{if(d.for_every_unit!==$)throw new Error(`[evaluateCharge] unknown for_every_unit: ${d.for_every_unit}`);u=null!=(l=d.upper_threshold)?l:0}const p={bracket_type:C.BRACKET,rate:f,rate_type:D.FRACTIONAL,initial_adjustment:u,final_adjustment:null!=(c=d.base_treatment_charge)?c:0};return console.log(`[evaluateCharge] bracketForEvaluation: ${JSON.stringify(p)}`),{finalValue:v(t,p),baseTreatmentCharge:d.base_treatment_charge}}function b(t,e,a,r,n){var o,i,s,l;if(console.log("[evaluatePenalty]"),!e||!e.length)return{};const c=g(e,t,{commodityCode:n,type:"Penalty"});if(!c)throw new Error(`[evaluatePenalty] Bracket not found for value ${t}, please ensure the brackets for all commodities defined in the contract cover all range of possible values for penalty`);let d=0,u=1;const f=null!=(o=c.escalator_reference)?o:1;if(c.no_penalty)u=0,d=0;else if(u=(null!=(i=c.rate)?i:1)/f,c.for_every_unit===_)d=null!=(s=c.lower_threshold)?s:0;else{if(c.for_every_unit!==$)throw new Error(`[evaluatePenalty] unknown for_every_unit: ${c.for_every_unit}`);d=null!=(l=c.upper_threshold)?l:0}const h={bracket_type:C.BRACKET,rate:u,rate_type:D.FRACTIONAL,initial_adjustment:d,final_adjustment:0};console.log(`[evaluatePenalty] bracketForEvaluation: ${JSON.stringify(h)}`);const y=v(t,h),m=null!=h.initial_adjustment;let w="";return w=c.rate&&0!==c.rate?`${m?"(":""}${p(t,4)}${m?` - ${p(d,4)})`:""} / ${p(f,4)} * ${null!=a?a:""} ${p(u,4)}/${null!=r?r:""}`:"No penalty",{penalty:y,expression:w,bracket:c}}function A(t){return t.toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" ")}function P(t){const e=t.getDate(),a=t.getMonth(),r=t.getFullYear();return`${e} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a]} ${r}`}function O(t,e=!0){const a=t.getMonth()+1,r=t.getDate();return`${t.getFullYear()}${e?"-":" "}${a<10?"0":""}${a}${e?"-":" "}${r<10?"0":""}${r}`}function T(t,e,a=!1){const r=new Date(t.valueOf());let n=e-(a?1:0);for(;n>0;)r.setDate(r.getDate()-1),0!==r.getDay()&&6!==r.getDay()&&(n-=1);return r.getHours()>=12&&r.setDate(r.getDate()+1),r}function U(t,e){const a=new Date(t.valueOf());return a.setMonth(a.getMonth()+e,1),a}function B(t,e){const a=new Date(t.valueOf());return a.setMonth(a.getMonth()+e+1,0),a}async function M(t,e){if(t===e)return 1;const a=await l.get(`/items/${Ot}?filter[${Tt}]=${t}`,{params:{fields:[kt]}});if(0===a.data.data.length||null===a.data.data[0][kt]||void 0===a.data.data[0][kt])throw new Error(`[getWeightUnitConversionValue] failed to get conversion value for source weight unit ${t}. Ensure that the symbol is correct and is a weight unit symbol`);const r=await l.get(`/items/${Ot}?filter[${Tt}]=${e}`,{params:{fields:[kt]}});if(0===r.data.data.length||null===r.data.data[0][kt]||void 0===r.data.data[0][kt])throw new Error(`[getWeightUnitConversionValue] failed to get conversion value for the target weight unit ${e}. Ensure that the symbol is correct and is a weight unit symbol`);const n=parseFloat(a.data.data[0][kt]);if(isNaN(n))throw new Error(`[getWeightUnitConversionValue] source weight unit ${t} conversion value=${n} is not a number`);const o=parseFloat(r.data.data[0][kt]);if(isNaN(o))throw new Error(`[getWeightUnitConversionValue] target weight unit ${e} conversion value=${o} is not a number`);return n/o}async function k(t,e){if(null==t||null==e)return 1;if(t===e)return 1;const a=await l.get(`/items/${Rt}?filter[${Ft}]=${t}`,{params:{fields:[xt]}});if(0===a.data.data.length||void 0===a.data.data[0][xt]||null===a.data.data[0][xt])throw new Error(`[getAssayUnitConversionValue] failed to get conversion value for source weight unit ${t}. Ensure that the symbol is correct and is a weight unit symbol`);const r=await l.get(`/items/${Rt}?filter[${Ft}]=${e}`,{params:{fields:[xt]}});if(0===r.data.data.length||void 0===r.data.data[0][xt]||null===r.data.data[0][xt])throw new Error(`[getAssayUnitConversionValue] failed to get conversion value for the target weight unit ${e}. Ensure that the symbol is correct and is a weight unit symbol`);const n=parseFloat(a.data.data[0][xt]);if(isNaN(n))throw new Error(`[getAssayUnitConversionValue] source weight unit ${t} conversion value=${n} is not a number`);console.log(`[getAssayUnitConversionValue] source unit conversion value=${n}`);const o=parseFloat(r.data.data[0][xt]);if(isNaN(o))throw new Error(`[getAssayUnitConversionValue] target weight unit ${t} conversion value=${o} is not a number`);return console.log(`[getAssayUnitConversionValue] target unit conversion value=${o}`),console.log("[getAssayUnitConversionValue] returning "+n/o),n/o}function R(t,e){if(void 0===t||void 0===e||null===t||null===e)return;const a=t.split("/"),r=e.split("/");if(a.length>2||r.length>2)throw new Error(`[getConversionUnit] sourceUnit=${t} and targetUnit=${e} must be in the format of 'unit1/unit2', an extra '/' was found`);if(1===a.length&&1===r.length)return`${r[0]}/${a[0]}`;if(1===a.length){const t=r[0]===a[0]?"":`${r[1]}(${a[1]})`,e=r[1];return""===e?t:`${t}/${e}`}if(1===r.length){const t=a[1],e=a[0]===r[0]?"":`${a[1]}(${r[0]})`;return""===e?t:`${t}/${e}`}{const t=a[0]===r[0],e=a[1]===r[1],n=t||""===a[0],o=t||""===r[0],i=e||""===a[1],s=e||""===r[1],l=!i&&!o,c=!n&&!s,d=`${i?"":a[1]}${l?"(":""}${o?"":`${r[0]}`}${l?")":""}`,u=`${n?"":a[0]}${c?"(":""}${s?"":`${r[1]}`}${c?")":""}`;return""===u?d:`${d}/${u}`}}async function F(t,e,a){const r=await l.get(`/items/${Ot}?filter[${Ut}]=${e}`,{params:{fields:[Tt]}});if(!r.data.data||!r.data.data[0]||!r.data.data[0][Tt])throw new Error(`[getConversionValuesAndUnitsForPayableMetalCalculation] Dry weight uom not found for symbol ${e}`);const n=r.data.data[0][Tt];if("%"===a){if(n===t)return{};const e=R(n,t);if(!e)throw new Error(`[getConversionValuesAndUnitsForPayableMetalCalculation] no conversion unit found for dry weight unit ${n} and target weight unit ${t}`);return{finalConversion:{conversionFactor:await M(n,t),conversionUom:e}}}let o=a.split("/");if(1==o.length){const t=await async function(t){const e=await l.get(`/items/${Rt}`,{params:{fields:[Ft,Lt],filter:{[Lt]:{_nnull:!0},[Ft]:{_eq:t}}}});if(200!==e.status||!e.data||0===e.data.data.length)throw new Error("[getAssayUnitComposition] no assay units found with composition");return e.data.data[0][Lt]}(a);if(!t)throw new Error(`[getConversionValuesAndUnitsForPayableMetalCalculation] assay unit ${a} does not have a composition`);o=t.split("/")}if(o.length>2||0===o.length)throw new Error(`[getConversionValuesAndUnitsForPayableMetalCalculation] assay unit ${a} is not in the format of 'unit1/unit2'`);const i=o[0],s=o[1],c={};if(s!==n){const t=R(n,s);if(!t)throw new Error(`[getConversionValuesAndUnitsForPayableMetalCalculation] no conversion unit found for dry weight unit ${n} and assay unit denominator unit ${s}`);c.initialConversion={conversionFactor:await M(n,s),conversionUom:t}}if(i!==t){const e=R(i,t);if(!e)throw new Error(`[getConversionValuesAndUnitsForPayableMetalCalculation] no conversion unit found for target weight unit ${t} and assay unit numerator unit ${i}`);c.finalConversion={conversionFactor:await M(i,t),conversionUom:e}}return c}const x="foreign_key",L="lot_number",j="method",V="contract",q="counterparty",J="assay_results",W="weight_result",G="estimate_arrival_date",H="actual_arrival_date",Y="bl_date",K="estimated_shipment_date",z="qp_selection",Q="vessel",X="origin",Z="destination",tt="shipment_code",et="invoice_due_date",at="adjustments",rt="parcel_finalisation_date",nt="assay_uom",ot="contract_currency",it="invoice_type",st="pay_percent",lt="pa_days",ct="pa_day_type",dt="pa_ref_day",ut="pp_days",ft="pp_day_type",ht="pp_ref_day",pt="commodity",yt="payable_commodity",mt="price_per_uom",gt="related_commodity_in_contract",vt="lower_threshold",wt="lower_threshold_inclusive",_t="upper_threshold",$t="upper_threshold_inclusive",Et="rate",bt="navarch_treatment_charge_bracket",At="base_treatment_charge",Ct="use_btc",Dt="escalator_reference",It="for_every_unit",St="name",Nt="code",Pt="code",Ot="navarch_unit",Tt="symbol",Ut="dry_symbol",Bt="dry_unit",Mt="wet_unit",kt="conversionToGram",Rt="navarch_assay_unit",Ft="unit",xt="conversion_to_ppb",Lt="composition",jt="name",Vt="navarch_address_id",qt="name",Jt="logo",Wt="line_1",Gt="line_2",Ht="city",Yt="state",Kt="country",zt="zip",Qt="phone_code",Xt="phone_number",Zt="signatory_name",te="signatory_title",ee="remittance_details",ae="signature",re="navarch_country",ne="name",oe="phone_code",ie="line_1",se="line_2",le="city",ce="state",de="country",ue="zip",fe="name",he="navarch_world_port",pe="port_name",ye="country",me="navarch_commodity_price",ge="price_pm",ve="average_price",we="date",_e="name",$e="navarch_invoices",Ee="parcel",be="invoice",Ae="document_type",Ce="revision_invoice",De="invoice_type",Ie="invoice_date",Se="amount_paid";async function Ne(){const t=await l.get(`/folders?filter[name][_eq]=${encodeURI("Invoices")}`);return 200===t.status&&t.data&&t.data.data?0===t.data.data.length?await async function(){return(await l.post("/folders",{name:"Invoices"})).data.data.id}():t.data.data[0].id:null}function Pe(t){const a=null!=t?t:e.value.doc_name;console.log(`[viewPdf] doc ID: ${a}`),window.open(`/assets/${a}?access_token=9TKZlOUjs29Svyop45nyyyN02lYPlX_x`)}return{isGeneraingDoc:i,invoiceUrl:c.value,generateInvoice:async function(){var t,e,r,n,s,u,f,g,v,_,$,C,D,I,S,O,T,U,B,M,k,R,kt,Rt,Ft,xt,Lt,me,ge,ve,we,Le,je,Ve,qe,Je,We,Ge,He,Ye,Ke,ze;o.value="";try{i.value=!0,console.log("[generateInvoice] formValues=",c);const Qe=c.value[Ee];if(!Qe)return o.value="Parcel not selected for invoice document generation",void(i.value=!1);const Xe=c.value[Ie]?new Date(c.value[Ie]):new Date,Ze=c.value[De],ta=await l.get(`/items/navarch_parcel/${Qe}`,{params:{fields:[J,W,V,q,G,H,Y,K,z,Q,X,Z,tt,et,at]}});console.log(`parcelResponce.data.data=${JSON.stringify(ta.data.data)}`),function(t){if(!t)throw new Error("Parcel data not found, please ensure the selected parcel still exists");if(!t[V])throw new Error("The selected parcel does not have a contract, please ensure that the contract field for the parcel is not empty");if(!t[q])throw new Error("The selected parcel does not have a counterparty, please ensure that the counterparty field for the parcel is not empty");if(!t[J])throw new Error("The selected parcel does not have assay results");if(!t[W])throw new Error("The selected parcel does not have weight results");if(!t[X])throw new Error("The selected parcel does not have an origin port");if(!t[Z])throw new Error("The selected parcel does not have a destination port");if(!t[tt])throw new Error("The selected parcel does not have a shipment code")}(ta.data.data);const ea=ta.data.data[J],aa=ta.data.data[W],ra=ta.data.data[V],na=await l.get(`/items/navarch_contract_payment_information?filter[related_contract]=${ra}`,{params:{fields:[it,st,lt,ct,dt,ut,ft,ht]}});if(na.data.data&&0===na.data.data.length)return o.value="No invoice type found for the contract",void(i.value=!1);const oa=na.data.data.find((t=>t[it]===Ze));if(!oa)return o.value=`Cannot find payment information for ${Ze} in the contract, please ensure that data for it has been entered and saved`,void(i.value=!1);const ia=await l.get(`/items/navarch_weight_lot?filter[${x}]=${aa}&sort[]=${L}`,{params:{fields:["id","dry_weight","wet_weight",j,"moisture","wet_weight_uom","dry_weight_uom"]}});console.log(`weightLotResponse.data.data=${JSON.stringify(ia.data.data)}`),function(t){if(!t||0===t.length)throw new Error("No weight lots found for the selected parcel")}(ia.data.data);const sa=function(t){console.log("[evaluateWeights]");const e={};for(const a of t)e[a.method]||(console.log(`adding method ${a.method} to weightData object`),e[a.method]=[]),console.log(`adding lot ${a.id} to weightData.${a.method} array`),e[a.method.toString()].push(a);const a=[];for(const t of Object.keys(e)){if(!e[t]){console.log(`method=${t} does not exist in weightData object`);continue}console.log(`adding lots and other values to weights for method=${t}`);const r=d(e[t]);r&&a.push(r)}return a}(ia.data.data),la=c.value.weight_method;let ca=sa.find((t=>t.method===la));if(ca||(ca=sa.find((t=>"Outturn"===t.method))),ca||(ca=sa.find((t=>"Inturn Final"===t.method))),ca||(ca=sa.find((t=>"Inturn"===t.method))),ca||(ca=sa.find((t=>"Estimated"===t.method))),ca||(ca=sa.find((t=>"Planned"===t.method))),!ca)throw new Error("No weight lot data found for all weight methods. Please ensure weight lot data has been entered in the selected parcel.");if(void 0===ca.dry_weight||null===ca.dry_weight||void 0===ca.wet_weight||null===ca.wet_weight||void 0===ca.moisture||null===ca.moisture||void 0===ca.dry_weight_uom||null===ca.dry_weight_uom||void 0===ca.wet_weight_uom||null===ca.wet_weight_uom||void 0===ca.method||null===ca.method)throw new Error("One of the fields for weight lots is undefined");const da=await l.get(`/items/${Ot}?filter[${Ut}]=${ca.dry_weight_uom}`,{params:{fields:[Bt]}}),ua=await l.get(`/items/${Ot}?filter[wet_symbol]=${ca.wet_weight_uom}`,{params:{fields:[Mt]}});if(!da.data.data||!da.data.data[0]||!da.data.data[0][Bt])throw new Error(`Dry weight uom not found for symbol ${ca.dry_weight_uom}`);if(!ua.data.data||!ua.data.data[0]||!ua.data.data[0][Mt])throw new Error(`Wet weight uom not found for symbol ${ca.wet_weight_uom}`);const fa=da.data.data[0][Bt],ha=0===fa.indexOf("dry")?fa:`dry ${fa}`,pa=ua.data.data[0][Mt],ya=0===pa.indexOf("wet")?pa:`wet ${pa}`,ma=await l.get(`/items/navarch_assay_lot?filter[${x}]=${ea}&sort[]=${L}`,{params:{fields:["id","commodity",j,"dry_weight","dry_weight_uom","buyer_assay","seller_assay","final_assay","lot_number",nt]}});console.log(`assayLotResponse.data.data=${JSON.stringify(ma.data.data)}`),function(t){if(!t||0===t.length)throw new Error("No assay lots found for the selected parcel")}(ma.data.data);const ga=function(t){var e;console.log("[evaluateAnalyticalAssay]");const a={};for(const e of t)a[e.method]||(a[e.method]={}),a[e.method][e.commodity]||(a[e.method][e.commodity]=[]),null!==e.lot_number?(1===a[e.method][e.commodity].length&&null===a[e.method][e.commodity][0].lot_number&&(a[e.method][e.commodity]=[]),a[e.method][e.commodity].push(e)):null===e.lot_number&&0===a[e.method][e.commodity].length&&a[e.method][e.commodity].push(e);console.log(`[evaluateAnalyticalAssay] group: ${JSON.stringify(a)}}`);const r={};for(const t in a){console.log(`[evaluateAnalyticalAssay] methodKey: ${t}, group[methodKey]: ${JSON.stringify(a[t])}`);for(const n in a[t]){console.log(`[evaluateAnalyticalAssay] commodityKey: ${n}, group[methodKey][commodityKey]: ${JSON.stringify(a[t][n])}`),r[t]=null!=(e=r[t])?e:{},r[t][n]={};const i=a[t][n].reduce(((t,e)=>t+e.dry_weight),0);if(console.log(`[evaluateAnalyticalAssay] totalDryWeight: ${i} from ${JSON.stringify(a[t][n])}`),0===i||isNaN(i))throw o.value=`Please provide dry weight for ${n} commodity in ${t} method, total dry weight cannot be ${i}`,new Error("[evaluateAnalyticalAssay] totalDryWeight is 0");console.log(`[evaluateAnalyticalAssay] totalDryWeight: ${i}`),r[t][n].analytical_assay=a[t][n].reduce(((e,a)=>{var r,i;const s=null!=(i=a.final_assay)?i:null!=(r=a.seller_assay)?r:a.buyer_assay;if(null==s)throw o.value=`Please provide Final, Seller or Buyer assay value for ${n} commodity in ${t} method`,new Error("[evaluateAnalyticalAssay] assay value is not defined for assay lot");const l=e+s*a.dry_weight;return console.log(`[evaluateAnalyticalAssay] evaluated analytical assay: ${l} for method=${t}, commodity=${n}; with values accumulator=${e}, assayValue=${s}, dryWeight=${a.dry_weight}`),l}),0)/i,console.log(`[evaluateAnalyticalAssay] analytical assay: ${r[t][n].analytical_assay}`),a[t][n].length>0&&(r[t][n][nt]=a[t][n][0][nt])}}return console.log(`[evaluateAnalyticalAssay] analyticalAssay: ${JSON.stringify(r)}`),r}(ma.data.data),va=c.value.assay_method;let wa;if(va&&(wa=ga[va.toString()]),wa||(wa=ga.Outturn),wa||(wa=ga["Inturn Final"]),wa||(wa=ga.Inturn),wa||(wa=ga.Estimated),wa||(wa=ga.Planned),!wa)throw new Error("No assay lot data found for all assay methods. Please ensure assay lot data has been entered in the selected parcel.");console.log(`WEIGHT: ${JSON.stringify(ca)}`),console.log(`ASSAYS: ${JSON.stringify(wa)}`);const _a=await l.get(`/items/navarch_contract/${ra}`,{params:{fields:[ot]}});!function(t){if(!t)throw new Error("Contract data not found, please ensure the selected contract still exists");if(!t[ot])throw new Error("The selected contract does not have a set currency, please ensure that the currency field for the contract is not empty")}(_a.data.data);const $a=await l.get(`/items/navarch_currency/${_a.data.data.contract_currency}`,{params:{fields:[Pt]}});!function(t){if(!t)throw new Error("Currency data not found, please ensure the selected currency still exists");if(!t[Pt])throw new Error("The selected currency in the contract is not valid")}($a.data.data);const Ea=$a.data.data.code,ba=await l.get(`/items/navarch_commodity_in_contract?filter[contract]=${ra}`,{params:{fields:["id",pt,"primary_commodity",yt,"price_method","quotational_periods","payable_assay_rates","penalty_rates","penalty_per_uom",mt,"treatment_charge_per_uom"]}});!function(t){if(!t||0===t.length)throw new Error("No commodity data found in selected contract for parcel");if(!t.every((t=>t[pt])))throw new Error("The selected contract has an undefined commodity, please ensure that the 'Commodity' field for all commodites in the contract is not empty");if(!t.every((t=>!t[yt]||t[mt])))throw new Error("The selected contract has an undefined base price Uom for commodity, please ensure that the 'Base Price Uom' field for all commodites in the contract is not empty")}(ba.data.data),console.log(`\tcommodityInContractResponse: ${JSON.stringify(ba.data.data)}`);const Aa=[],Ca=[];let Da="",Ia=[];for(const{id:a,commodity:o,primary_commodity:i,price_method:c,quotational_periods:d,price_per_uom:h,penalty_per_uom:y,treatment_charge_per_uom:m}of ba.data.data){const A=await l.get(`/items/navarch_commodity/${o}`,{params:{fields:[St,Nt]}});if(Me(A.data.data,o),!wa[A.data.data.code]){console.log(`[generateInvoice] no analytical assay for commodity ${A.data.data.code} found, skipping...`);continue}if(i&&(Da=A.data.data[St]),null!==d){const o=d;console.log(`\tquotationalPeriods: ${JSON.stringify(o)}`);const i=Array.isArray(o)?o.find((t=>t.default)):null;if(!i)throw new Error(`No default quotational period found for commodity ${A.data.data.code}`);const y=o.filter((t=>!t.default)).map((t=>`${t.qp_period} ${t.qp_code}`)),b=[`${i.qp_period} ${i.qp_code}`,...y].join(", ");console.log(`[generateInvoice] evaluate payable assay for ${A.data.data.code} with an analytical assay=${null==(t=wa[A.data.data.code])?void 0:t.analytical_assay}`);const N=await l.get(`/items/navarch_payable_assay_bracket?filter[${gt}]=${a}`,{params:{fields:["bracket_type",vt,wt,_t,$t,Et,"rate_type","initial_adjustment","initial_adjustment_uom","minimum_deduction","minimum_deduction_uom","maximum_cap","maximum_cap_uom"]}}),{payableAssay:x,expression:L}=await w(null==(e=wa[A.data.data.code])?void 0:e.analytical_assay,null==(r=wa[A.data.data.code])?void 0:r.assay_uom,N.data.data,A.data.data[St]);let j=null,V=null;if("Final"!==Ze){const t=await Oe(A.data.data.code,ta.data.data,c,(async()=>Te(oa,ta.data.data,Ze)));if(null===t)throw new Error(`[generateInvoice] Provisional pricing dates not found for commodity ${A.data.data.code}`);if(null===t.provisionalPricingStartDate||!(t.provisionalPricingStartDate instanceof Date))throw new Error(`[generateInvoice] Invalid provisional pricing start date for commodity ${A.data.data.code} of invoice type ${Ze}`);if(j=t.provisionalPricingStartDate,null===t.provisionalPricingEndDate||!(t.provisionalPricingEndDate instanceof Date))throw new Error(`[generateInvoice] Invalid provisional pricing end date for commodity ${A.data.data.code} of invoice type ${Ze}`);V=t.provisionalPricingEndDate}else{const t=await Oe(A.data.data.code,ta.data.data,c,(async()=>Ue(i,ta.data.data)),!0);if(null===t)throw new Error(`[generateInvoice] Provisional pricing dates not found for commodity ${A.data.data.code}`);if(null===t.provisionalPricingStartDate||!(t.provisionalPricingStartDate instanceof Date))throw new Error(`[generateInvoice] Invalid provisional pricing start date for commodity ${A.data.data.code} of invoice type ${Ze}`);if(j=t.provisionalPricingStartDate,null===t.provisionalPricingEndDate||!(t.provisionalPricingEndDate instanceof Date))throw new Error(`[generateInvoice] Invalid provisional pricing end date for commodity ${A.data.data.code} of invoice type ${Ze}`);V=t.provisionalPricingEndDate,Ia.push(V),console.log(`[generateInvoice] Provisional pricing start date=${j.toString()} and end date=${V.toString()}`)}console.log(`[generateInvoice] provisional pricing date range: ${j.toString()} - ${V.toString()}`);const q=await Be(A.data.data.code,c,j,V);let J;const W=await l.get(`/items/${bt}?filter[related_contract_commodity_tc]=${a}`,{params:{fields:[vt,wt,_t,$t,At,Ct,Dt,It,Et]}});let G,H;if(void 0!==W.data.data&&null!==W.data.data&&W.data.data.length>0&&(J=await E(q,null==(n=wa[A.data.data.code])||n.assay_uom,W.data.data,A.data.data[St],"Treatment Charge")),J){if(!m)throw new Error(`Charge Rate UOM is not defined for commodity ${A.data.data[St]}`);const t=await l.get(`/items/${Ot}/${m}`,{params:{fields:[Tt]}});Re(t.data.data,A.data.data[St]),G=t.data.data[Tt]}const Y=await l.get(`/items/${bt}?filter[related_contract_commodity_rc]=${a}`,{params:{fields:[vt,wt,_t,$t,At,Ct,Dt,It,Et]}});if(void 0!==Y.data.data&&null!==Y.data.data&&Y.data.data.length>0&&(H=await E(q,null==(s=wa[A.data.data.code])||s.assay_uom,Y.data.data,A.data.data[St],"Refining Charge")),H){if(!m)throw new Error(`Charge Rate UOM is not defined for commodity ${A.data.data[St]}`);const t=await l.get(`/items/${Ot}/${m}`,{params:{fields:[Tt]}});Re(t.data.data,A.data.data[St]),G=t.data.data[Tt]}const K=await l.get(`/items/${Ot}/${h}`,{params:{fields:[Tt]}});ke(K.data.data,A.data.data[St]);const z=K.data.data[Tt],Q=await F(z,ca.dry_weight_uom,null==(u=wa[A.data.data.code])?void 0:u.assay_uom);console.log(`[generateInvoice] payableMetalConversion for commodity ${A.data.data.name}: ${JSON.stringify(Q)}`),Q.initialConversion=1===(null==(f=Q.initialConversion)?void 0:f.conversionFactor)?void 0:Q.initialConversion,Q.finalConversion=1===(null==(g=Q.finalConversion)?void 0:g.conversionFactor)?void 0:Q.finalConversion;const X=await l.get(`/items/navarch_price_method/${c}`,{params:{fields:[_e]}});xe(X.data.data,c,A.data.data[St]),Aa.push({commodity:A.data.data.name,analytical_assay:p(null==(v=wa[A.data.data.code])?void 0:v.analytical_assay,4),deduction_expression:L,payable_assay:p(x,4),assay_uom:null==(_=wa[A.data.data.code])?void 0:_.assay_uom,payable_metal:p(ca.dry_weight*(null!=(C=null==($=Q.initialConversion)?void 0:$.conversionFactor)?C:1)*(null!=x?x:1)*(null!=(I=null==(D=Q.finalConversion)?void 0:D.conversionFactor)?I:1)*("%"!==(null==(S=wa[A.data.data.code])?void 0:S.assay_uom)?1:.01),4),payable_metal_expression:`${p(ca.dry_weight,4)}${ca.dry_weight_uom}${Q.initialConversion?` * ${p(Q.initialConversion.conversionFactor,4)}${Q.initialConversion.conversionUom}`:""} * ${p(null!=x?x:1,4)}${"%"!==(null==(O=wa[A.data.data.code])?void 0:O.assay_uom)?`${null==(T=wa[A.data.data.code])?void 0:T.assay_uom}`:" / 100"}${Q.finalConversion?` * ${p(Q.finalConversion.conversionFactor,4)}${Q.finalConversion.conversionUom}`:""}`,payable_metal_uom:z,qp:b,qp_start_date:P(j),qp_end_date:P(V),price_method:X.data.data[_e],price_rate:p(q,4),price_per_uom:z,price:p(ca.dry_weight*(null!=(B=null==(U=Q.initialConversion)?void 0:U.conversionFactor)?B:1)*(null!=x?x:1)*(null!=(k=null==(M=Q.finalConversion)?void 0:M.conversionFactor)?k:1)*("%"!==(null==(R=wa[A.data.data.code])?void 0:R.assay_uom)?1:.01)*q),treatment_charge:J?{rate:p(J.baseTreatmentCharge,4),discount:p((null!=(kt=J.baseTreatmentCharge)?kt:0)-(null!=(Rt=J.finalValue)?Rt:0),4),final_rate:p(J.finalValue,4),per_uom:G,final_amount:p(ca.dry_weight*(null!=(Ft=J.finalValue)?Ft:1))}:void 0,refining_charge:H?{rate:p(H.baseTreatmentCharge,4),discount:p((null!=(xt=H.baseTreatmentCharge)?xt:0)-(null!=(Lt=H.finalValue)?Lt:0),4),final_rate:p(H.finalValue,4),per_uom:G,final_amount:p(ca.dry_weight*(null!=(me=H.finalValue)?me:1))}:void 0,final_total:p(ca.dry_weight*(null!=(ve=null==(ge=Q.initialConversion)?void 0:ge.conversionFactor)?ve:1)*(null!=x?x:1)*(null!=(Le=null==(we=Q.finalConversion)?void 0:we.conversionFactor)?Le:1)*("%"!==(null==(je=wa[A.data.data.code])?void 0:je.assay_uom)?1:.01)*q-(J?1:0)*(ca.dry_weight*(null!=(Ve=null==J?void 0:J.finalValue)?Ve:1))-(H?1:0)*(ca.dry_weight*(null!=(qe=null==H?void 0:H.finalValue)?qe:1)))})}const N=await l.get(`/items/navarch_penalty_bracket?filter[${gt}]=${a}`,{params:{fields:[vt,wt,_t,$t,"no_penalty","escalator_reference","for_every_unit",Et]}});if(N.data.data.length>0){if(null===y)throw new Error(`[generateInvoice] penalty_per_uom is null for ${A.data.data.code}`);const t=await l.get(`/items/${Ot}/${y}`,{params:{fields:[Tt]}});Fe(t.data.data,A.data.data[St]);const e=t.data.data[Tt],{penalty:a,expression:r,bracket:n}=await b(null==(Je=wa[A.data.data.code])?void 0:Je.analytical_assay,N.data.data,Ea,e,A.data.data[St]);console.log(`[generateInvoice] evaluate penalty for ${A.data.data.code} with an analytical assay=${null==(We=wa[A.data.data.code])?void 0:We.analytical_assay}, penaltyRate=${null==n?void 0:n.rate}, finalPenaltyRate=${a}, expression='${r}'`),Ca.push({commodity:A.data.data.name,analytical_assay:p(null==(Ge=wa[A.data.data.code])?void 0:Ge.analytical_assay,4),deduction_expression:r,assay_uom:null==(He=wa[A.data.data.code])?void 0:He.assay_uom,penalty_rate:p(null==n?void 0:n.rate,4),penalty_per_uom:e,final_penalty_rate:p(a,4),final_penalty:p((null!=a?a:1)*ca.dry_weight)})}}console.log(`[generateInvoice] COMMODITIES: ${JSON.stringify(Aa)}`),console.log(`[generateInvoice] PENALTIES: ${JSON.stringify(Ca)}`);const Sa=Aa.reduce(((t,e)=>t+m(e.price)),0),Na=Aa.reduce(((t,e)=>{var a;return t+m(null==(a=e.treatment_charge)?void 0:a.final_amount)}),0),Pa=Aa.reduce(((t,e)=>{var a;return t+m(null==(a=e.refining_charge)?void 0:a.final_amount)}),0),Oa=Ca.reduce(((t,e)=>t+m(e.final_penalty)),0);console.log(`[generateInvoice] TOTAL_REVENUE=${Sa}, TOTAL_TREATMENT_CHARGE=${Na}, TOTAL_REFINING_CHARGE=${Pa}, TOTAL_PENALTIES=${Oa}`);let Ta,Ua=0;const Ba=!!ta.data.data[at];Ba&&(Ua=ta.data.data[at].reduce(((t,e)=>t+e.amount),0),Ta={adjustments:ta.data.data[at].map((t=>({description:t.description,amount:p(t.amount)}))),total_adjustments:p(Ua)});const Ma=oa[st],ka=Sa-Na-Pa-Oa+Ua,Ra=null!=Ma?ka*Ma/100:void 0,Fa=await l.get(`/items/navarch_counterparty/${ta.data.data[q]}`,{params:{fields:[jt]}});!function(t){if(console.log("[validateCounterparty]"),!t)throw new Error("Counterparty for parcel not found");if(!t[jt])throw new Error("No name defined for counterparty of the selected parcel")}(Fa.data.data);const xa=await l.get(`/items/navarch_counterparty_navarch_address?filter[navarch_counterparty_id]=${ta.data.data[q]}`,{params:{fields:[Vt]}});!function(t){if(console.log("[validateCounterpartyAddress]"),!t||0===t.length)throw new Error("Counterparty address for parcel not found");if(!t[0][Vt])throw new Error("No address defined for counterparty of the selected parcel")}(xa.data.data);const La=xa.data.data[0][Vt],ja=await l.get(`/items/navarch_address/${La}`,{params:{fields:[ie,se,le,ce,de,ue]}});!function(t){if(!t)throw new Error("Buyer address for parcel not found");if(!t[ie])throw new Error("No address line 1 defined for buyer address of the selected parcel");if(!t[de])throw new Error("No country defined for buyer address of the selected parcel")}(ja.data.data);const Va=ja.data.data[ie],qa=ja.data.data[se]?`,\n${ja.data.data[se]}`:"",Ja=ja.data.data[le]?`,\n${ja.data.data[le]}`:"",Wa=ja.data.data[ce]?`,\n${ja.data.data[ce]}`:"",Ga=await l.get(`/items/${re}/${ja.data.data[de]}`,{params:{fields:[ne]}});!function(t){if(!t)throw new Error("Something went wrong when getting the buyer's based country")}(Ga.data.data);const Ha=Ga.data.data[ne]?`, ${Ga.data.data[ne]}`:"",Ya=`${Va}${qa}${Ja}${ja.data.data[ue]?` ${ja.data.data[ue]}`:""}${Wa}${Ha}`,Ka=ta.data.data[Q];let za;Ka&&(za=await l.get(`/items/navarch_vessel/${Ka}`,{params:{fields:[fe]}}),function(t){if(console.log("[validateVessel]"),!t)throw new Error("Vessel for parcel not found");if(!t[fe])throw new Error("No name defined for vessel of the selected parcel")}(za.data.data));const Qa=(await l.get("/items/navarch_company",{params:{fields:[qt,Jt,Wt,Gt,Ht,Yt,zt,Kt,Qt,Xt,Zt,te,ee,ae]}})).data.data;let Xa=null;if(Qa[Jt]){const t=Qa[Jt],e=await l.get(`/assets/${t}?access_token=9TKZlOUjs29Svyop45nyyyN02lYPlX_x`,{responseType:"arraybuffer"});Xa=y.Buffer.from(e.data,"binary").toString("base64")}const Za=Qa[ae];let tr=null;if(Za){const t=await l.get(`/assets/${Za}?access_token=9TKZlOUjs29Svyop45nyyyN02lYPlX_x`,{responseType:"arraybuffer"});tr=y.Buffer.from(t.data,"binary").toString("base64")}!function(t){if(console.log("[validateCompanyData]"),!t)throw new Error("Company data not found");if(!t[qt])throw new Error("Please set company name in Directories > Company");if(!t[Qt])throw new Error("Please set company phone code in Directories > Company");if(!t[Wt])throw new Error("Please set company address line 1 in Directories > Company");if(!t[Kt])throw new Error("Please set the country the company is based in Directories > Company");if(!t[Xt])throw new Error("Please set the company phone number in Directories > Company");if(!t[Zt])throw new Error("Please set the company signatory name in Directories > Company");if(!t[te])throw new Error("Please set the company signatory title in Directories > Company");if(!t[ee])throw new Error("Please set the company remittance details in Directories > Company");if(!t[ae])throw new Error("Please set the company signature in Directories > Company")}(Qa);const er=Qa[qt],ar=await l.get(`/items/${re}/${Qa[Qt]}`,{params:{fields:[oe]}});!function(t){if(!t)throw new Error("Company phone code not found, please ensure phone code selected for Directories > Company is valid");if(!t[oe])throw new Error("Company country phone code not found, please contact Navarch support for assistance")}(ar.data.data);const rr=ar.data.data[oe],nr=Qa[Xt],or=Qa[Wt],ir=Qa[Gt]?`,\n${Qa[Gt]}`:"",sr=Qa[Ht]?`,\n${Qa[Ht]}`:"",lr=Qa[Yt]?`,\n${Qa[Yt]}`:"",cr=await l.get(`/items/${re}/${Qa[Kt]}`,{params:{fields:[ne]}});!function(t){if(!t)throw new Error("Country not found, please ensure country selected for Directories > Company is valid");if(!t[ne])throw new Error("Country name not found, please contact Navarch support for assistance")}(cr.data.data);const dr=cr.data.data[ne]?`, ${cr.data.data[ne]}`:"",ur=`${or}${ir}${sr}${Qa[zt]?` ${Qa[zt]}`:""}${lr}${dr}`,fr=await l.get(`/items/${he}/${ta.data.data[X]}`,{params:{fields:[pe,ye]}});!function(t){if(!t)throw new Error("Origin port for parcel not found");if(!t[pe])throw new Error("No name defined for origin port of the selected parcel");if(!t[ye])throw new Error("No country defined for origin port of the selected parcel")}(fr.data.data);const hr=await l.get(`/items/${he}/${ta.data.data[Z]}`,{params:{fields:[pe,ye]}});!function(t){if(!t)throw new Error("Destination port for parcel not found");if(!t[pe])throw new Error("No name defined for destination port of the selected parcel");if(!t[ye])throw new Error("No country defined for destination port of the selected parcel")}(hr.data.data);let pr=(await l.get(`/items/${$e}?filter[${Ee}]=${Qe}`,{params:{fields:["id",be]}})).data.data.reduce(((t,e)=>t+(e[be]?1:0)),0)+1,yr=Qe;const mr=pr.toString().padStart(2,"0"),gr=`${ta.data.data[tt]} (#${mr})`,vr=yr.toString().padStart(2,"0"),wr=ta.data.data[et];let _r=null;if(wr){const t=null==(Ye=wr[Ze])?void 0:Ye.due_date;h(t)||(_r=new Date(t))}if(h(_r)){const t={invoice_type:Ze,days:oa[lt],day_type:oa[ct],ref_day:"Final"===Ze?void 0:oa[dt]};if(!t)throw new Error(`Contract does not have a payment advice for invoice type ${Ze}`);let e,a="";if("Final"!==Ze)switch(t.ref_day){case"Arrival Date":a="Actual/Estimated Arrival Date from the Parcel form",e=null!=(Ke=ta.data.data[H])?Ke:ta.data.data[G];break;case"B/L Date":a="B/L Date (or Estimated Shipment Date) from the Parcel form",e=null!=(ze=ta.data.data[Y])?ze:ta.data.data[K];break;case"Invoice Date":a="Invoice Date from the Invoice form",e=c.value[Ie];break;case"Estimated Shipment Date":a="Estimated Shipment Date from the Parcel form",e=ta.data.data[K];break;case"Parcel Finalisation":if(void 0===ta.data.data[rt]||null===ta.data.data[rt])throw new Error("[generateInvoice] Parcel has not been finalised, please fill in the the parcel finalisation date in the parcel form.");a="Parcel Finalisation Date from the Parcel form",e=ta.data.data[rt];break;default:throw new Error(`Invalid reference day for payment advice: ${t.ref_day}; please contact Navarch for support`)}else a="Last day of the last QP Month";if("Final"!==Ze&&h(e))throw new Error(`Reference day for payment advice ${a} is empty in parcel`);const r="Final"===Ze?function(t,e){if(0===t.length)throw new Error(e);return t.reduce(((t,e)=>h(e)&&e.valueOf()>t.valueOf()?e:t),t[0])}(Ia,"No QP Month end dates found when evaluating due date for Final invoice"):new Date(e),n=parseInt(t.days),o=t.day_type;switch(o){case"Business Day(s)":_r=function(t,e,a=!1){const r=new Date(t.valueOf());let n=e-(a?1:0);for(;n>0;)r.setDate(r.getDate()+1),0!==r.getDay()&&6!==r.getDay()&&(n-=1);return r.getHours()>=12&&r.setDate(r.getDate()+1),r}(r,n,!0);break;case"Calendar Day(s)":_r=new Date(r.valueOf()),_r.getHours()>=12?_r.setDate(_r.getDate()+n+1):_r.setDate(_r.getDate()+n);break;default:throw new Error(`[generateInvoice] Invalid day_type for payment advice ${o}`)}}if(!_r)throw new Error(`Due date could not be calculated for invoice type ${Ze}`);console.log(`[generateInvoice] payment advice due date: ${_r.toString()}`);const $r=P(_r),Er=[];let br,Ar,Cr,Dr;if(c.value[Ce]){const t=await l.get(`/items/${$e}/${c.value[Ce]}`,{params:{fields:[Ee,be,De,Ae]}});if(console.log(`[generateInvoice] revisionParcelResponse: ${JSON.stringify(t.data)}`),200!==t.status||!t.data.data)throw new Error(`[generateInvoice] Failed to get invoice ${c.value[Ce]}`);if(t.data.data[Ee]!==Qe)throw new Error(`[generateInvoice] Parcel ID mismatch between this invoice with parcel ${Qe}, and the revision invoice ${c.value[Ce]} with parcel id ${t.data.data[Ee]}`);if(!t.data.data[be])throw new Error(`[generateInvoice] No invoice pdf has been generated yet for invoice ${c.value[Ce]}`);if(!t.data.data[De])throw new Error(`[generateInvoice] No invoice type found for the revision invoice ${c.value[Ce]}`);Cr=t.data.data[De],Dr=t.data.data[Ae];const e=t.data.data[be];if(function(t){if(!t)throw new Error("Revision invoice data not found");if(!t.invoice_number)throw new Error("Revision invoice data does not have an invoice number in generated document");if(!t.balance_in_sellers_favor)throw new Error("Revision invoice data does not have a valid 'Balance in Sellers Favor' in generated document")}(e),console.log(`[generateInvoice] revisionInvoiceData: ${JSON.stringify(e)}`),br=e.invoice_number,!br||""===br)throw new Error(`[generateInvoice] Could not find invoice number in revision invoice ${c.value[Ce]}`);const a=e.balance_in_sellers_favor.replace(/,/g,"");if(Ar=parseFloat(a),!Ar||isNaN(Ar))throw new Error(`[generateInvoice] Total payment=${e.balance_in_sellers_favor} found is not convertible to monetary amount for revision invoice ${c.value[Ce]}`)}const Ir=na.data.data.map((t=>t[it])),Sr=N[Ze];if(void 0===Sr)throw new Error(`'${Ze}' is not a valid Invoice Type`);const Nr=Ir.filter((t=>N[t]<Sr)),Pr=await l.get(`/items/${$e}`,{params:{filter:{[Ee]:{_eq:Qe},[De]:{_in:Nr},[be]:{_nnull:!0},[Se]:{_nnull:!0}},fields:[be,Se,De,Ae]}});let Or=0;Pr.data.data.forEach((t=>{const e=t[Ae],a=t[De],r=t[Se];if(h(t[be]))throw new Error(`No generated invoice data found for invoice of type ${a} with document type ${e}`);const n=t[be].invoice_number;if(h(n))throw new Error(`No invoice number found for the generated invoice of type ${a} and document type ${e}`);var o;n&&r&&e&&(Or+=r,Er.push({invoice_type:a,payment_received_source:`${a}.${e}.${n}`,payment_received:(o=r,console.log("[formatNumbersBracketIfNegative]"),isNaN(o)||null===o?"-":o<0?`(${p(Math.abs(o))})`:p(o))}))})),Er.sort(((t,e)=>N[t.invoice_type]-N[e.invoice_type]));const Tr=null!=Ra?Ra-Or-(null!=Ar?Ar:0):void 0,Ur={signatoryName:Qa[Zt],signatoryTitle:Qa[te],signature:null!=tr?tr:null,company:er},Br={folder_id:await Ne(),company_logo:null!=Xa?Xa:null,seller:er,seller_address:ur,seller_phone_number:`+${rr} ${nr}`,signatory:Ur,remittance:Qa[ee],buyer:Fa.data.data[jt],buyer_address:Ya,shipment_code:ta.data.data[tt],vessel:za?za.data.data[fe]:"N/A",bl_date:ta.data.data[Y]?P(new Date(ta.data.data[Y])):"N/A",invoice_type:Ze,invoice_date:P(Xe),revision:br&&Ar?Dr:void 0,invoice_number:gr,parcel:`${ta.data.data[tt]} (#${vr})`,port_of_loading:`${fr.data.data[pe]}, ${fr.data.data[ye]}`,port_of_discharge:`${hr.data.data[pe]}, ${hr.data.data[ye]}`,primary_commodity:`${Da} Concentrates`,due_date:$r,wet_weight:p(ca.wet_weight,4),wet_weight_uom:ca.wet_weight_uom,wet_weight_uom_name:A(ya),moisture:p(ca.moisture,4),moisture_uom:"%",dry_weight:p(ca.dry_weight,4),dry_weight_uom:ca.dry_weight_uom,dry_weight_uom_name:A(ha),total_revenue:p(Sa),total_deductions:p(Oa+Na+Pa),currency:Ea,commodities:Aa,penalties:{penalties:Ca,total_penalties:p(Oa)},adjustments:Ba?Ta:void 0,invoice_value:p(ka),payable_percentage:p(Ma),payable_amount:p(Ra),payments_received:Er,balance_in_sellers_favor:p(Tr)};let Mr;try{Mr=await l.post("/generate/invoice",Br)}catch(t){throw console.error(`[generateInvoice] error: ${t}`),new Error(JSON.stringify(t.response.data))}if(200!==Mr.status)return console.log(`[generateInvoice] invoice response status: ${Mr.status}`),o.value=Mr.data,void(i.value=!1);const kr=await async function(t){if(!t)throw console.error("[uploadGeneratedDoc] fileData is empty"),new Error("A failure occured while trying to upload the generated document, no file data found. Please try again.");const e=function(t){console.log("[convertJsonToFormData] json=",JSON.stringify(t));const e=new FormData;for(let a in t)"file"!==a&&e.append(a,t[a]);const a=t.file,r=function(t,e){const a=atob(t),r=new ArrayBuffer(a.length),n=new Uint8Array(r);for(let t=0;t<a.length;t++)n[t]=a.charCodeAt(t);const o=new Blob([n],{type:e});return o}(a,"application/pdf");return e.append("file",r,t.filename_download),e}(t),a=await l.post("/files",e,{headers:{"Content-Type":"multipart/form-data"}});if(200!==a.status)throw console.error(`[uploadGeneratedDoc] uploadedFileData status: ${a.status}`),new Error("A failure occured while trying to upload the generated document. Please try again.");return a.data.data.id}(Mr.data);a("input",{...Br,doc_name:kr}),console.log(`[generateInvoice] invoice response: ${JSON.stringify(c.value)}`),i.value=!1,Pe(kr)}catch(t){return i.value=!1,console.log(`generating invoice went wrong due to: ${t}`),void(o.value=t)}},viewPdf:Pe,isCopying:s,copy:async function(){s.value=!0;const{id:t,user_created:e,date_created:a,user_updated:r,date_updated:n,invoice:i,...d}=c.value;console.log(`[invoice::copy] requestBody=${JSON.stringify(d)}`);const u=await l.post("/items/navarch_invoices",d);if(200!==u.status)return console.log(`[invoice::copy] copy response status: ${u.status}`),void(o.value=`Failed to duplicate invoice with status ${u.status}`);s.value=!1,window.open(`/admin/content/navarch_invoices/${u.data.data.id}`)},failureReason:o};async function Oe(t,e,a,r,n=!1){if(h(e[z])||h(e[z][t]))return await r();const o=await async function(t,e,a,r){var n,o;if(r&&!t.declared)return null;const i=null==t?void 0:t.qp_selected;if(!i)return null;const s=i.split(" "),c={qp_period:parseInt(s[0]),qp_code:s[1]};let d,u,f,h;switch(c.qp_code){case"MAMA":d=new Date(null!=(n=e[H])?n:e[G]),u="Actual/Estimated Arrival Date";break;case"MOSS":d=new Date(e[K]),u="Estimated Shipment Date";break;case"MOS":case"MOAS":d=new Date(null!=(o=e[Y])?o:e[K]),u="B/L Date (or Estimated Shipment Date)";break;default:throw new Error(`Unsupported QP code ${c.qp_code} in the contract commodities, please ensure all commodity QP codes are MAMA, MOS, MOSS, or MOAS`)}if(null==d)throw new Error(`[generateInvoice] Invalid reference day for ${u} from ${c.qp_code}`);if(f=U(d,c.qp_period),f.valueOf()>Date.now())return null;if(h=B(d,c.qp_period),h.valueOf()>Date.now())return null;if(h.valueOf()<=Date.now()){0===h.getDay()?h=T(h,2,!0):6===h.getDay()&&(h=T(h,1,!0));const t=await l.get(`/items/${me}`,{params:{filter:{_and:[{date:{_eq:O(h)}},{price_method:{_eq:a}}]},fields:[ge,ve]}});if(!t.data.data||0===t.data.data.length)return null}return{provisionalPricingStartDate:f,provisionalPricingEndDate:h}}(e[z][t],e,a,n);return o||await r()}async function Te(t,e,a){var r,n;let o,i,s;const l={invoice_type:a,days:t[ut],day_type:t[ft],ref_day:t[ht]};if(!l)throw new Error(`[generateInvoice] No provisional pricing found for invoice type ${a}`);let d;switch(l.ref_day){case"Arrival Date":d=null!=(r=e[H])?r:e[G],o="Actual/Estimated Arrival Date from the Parcel form";break;case"B/L Date":d=null!=(n=e[Y])?n:e[K],o="B/L Date (or Estimated Shipment Date) from the Parcel form";break;case"Invoice Date":d=c.value[Ie],o="Invoice Date from the Invoice form";break;case"Estimated Shipment Date":d=e[K],o="Estimated Shipment Date from the Parcel form";break;default:throw new Error(`Invalid reference day for invoice pricing: ${l.ref_day}; please contact Navarch for support`)}if(null==d)throw new Error(`Reference day for invoice pricing ${o} is empty`);s=new Date(d);const u=parseInt(l.days),f=l.day_type;switch(f){case"Business Day(s)":i=T(s,u,!0);break;case"Calendar Day(s)":i=new Date(s.valueOf()),i.setDate(i.getDate()-u);break;default:throw new Error(`Invalid day type ${f} for ${a} Invoice in the contract, please ensure it is either Calendar Day(s) or Business Day(s)`)}if(i.valueOf()>Date.now())throw new Error(`Start date for provisional pricing ${i} (${o}) for ${a} Invoice has not occurred yet`);if(s.valueOf()>Date.now())throw new Error(`End date for provisional pricing ${s} (${o}) for ${a} Invoice has not occurred yet`);return{provisionalPricingStartDate:i,provisionalPricingEndDate:s}}async function Ue(t,e){var a,r;let n,o,i,s;switch(t.qp_code){case"MAMA":s=new Date(null!=(a=e[H])?a:e[G]),n="Actual/Estimated Arrival Date";break;case"MOSS":s=new Date(e[K]),n="Estimated Shipment Date";break;case"MOS":case"MOAS":s=new Date(null!=(r=e[Y])?r:e[K]),n="B/L Date (or Estimated Shipment Date)";break;default:throw new Error(`Unsupported QP code ${t.qp_code} in the contract commodities, please ensure all commodity QP codes are MAMA, MOS, MOSS, or MOAS`)}if(null==s)throw new Error(`[generateInvoice] Invalid reference day for ${n} from ${t.qp_code}`);if(o=U(s,t.qp_period),o.valueOf()>Date.now())throw new Error(`[generateInvoice] Start date for provisional pricing ${o} (${n}) based on default QP has not occurred yet`);if(i=B(s,t.qp_period),i.valueOf()>Date.now())throw new Error(`[generateInvoice] End date for provisional pricing ${i} (${n}) based on default QP has not occurred yet`);return{provisionalPricingStartDate:o,provisionalPricingEndDate:i}}async function Be(t,e,a,r,n=1){if(h(t))throw new Error("Commodity is not defined for price calcualtion");if(h(e))throw new Error(`Price method for commodity ${t} is not defined for price calcualtion`);if(h(a))throw new Error(`Start date is not defined for price calcualtion with ${e} has not been properly defined, please ensure that contract QP is properly defined`);if(h(r))throw new Error(`End date is not defined for price calcualtion with ${e} has not been properly defined, please ensure that contract QP is properly defined`);const o=await l.get(`/items/${me}?filter[_and][0][price_method][_eq]=${e}&filter[_and][0][currency][_eq]=${n}&filter[_and][1][date][_between][0]=${O(a)}&filter[_and][1][date][_between][1]=${O(r)}`,{params:{fields:[ge,ve,we,"price_method"]}});if(!o||!o.data||!o.data.data)throw new Error(`[getCommodityAvgPrice] Failed to get commodity prices for commodity ${t} between ${O(a)} and ${O(r)}`);if(0===o.data.data.length)throw new Error(`No commodity prices found for commodity ${t} between ${O(a)} and ${O(r)}`);return o.data.data.reduce(((t,a)=>{if(!a[ve]&&!a[ge])throw new Error(`Commodity for ${e} on the date of ${a[we]} does not have a price, please contact Navarch for assistance`);let r;if(null!==a[ve]&&(r=Number(a[ve])),null===a[ge])throw new Error(`The commodity price for Price Method #${e} for the date of ${a[we]} is not a valid number, please contact Navarch for assistance`);return r=Number(a[ge]),t+r}),0)/o.data.data.length}function Me(t,e){var a,r;if(console.log("[validateCommodityData]"),!t)throw new Error("commodity data response is null");if(!t[St])throw new Error(`Commodity name for commodity ${null!=(a=t[Nt])?a:e} is undefined, please contact Navarch for assistance`);if(!t[Nt])throw new Error(`Commodity code for commodity ${null!=(r=t[St])?r:e} is not defined, please contact Navarch for assistance`)}function ke(t,e){if(!t)throw new Error(`Price per UOM for commodity ${e} is not a valid`);if(!t[Tt])throw new Error(`Price per UOM for commodity ${e} does not have a valid unit symbol, please contact Navarch for assistance`)}function Re(t,e){if(!t)throw new Error(`Charge per UOM for commodity ${e} is not a valid`);if(!t[Tt])throw new Error(`Charge per UOM for commodity ${e} does not have a valid unit symbol, please contact Navarch for assistance`)}function Fe(t,e){if(!t)throw new Error(`Penalty per UOM for commodity ${e} is not a valid`);if(!t[Tt])throw new Error(`Penalty per UOM for commodity ${e} does not have a valid unit symbol, please contact Navarch for assistance`)}function xe(t,e,a){if(!t)throw new Error(`Price method ${e} for commodity ${a} is not defined, please contact Navarch for assistance`);if(!t[_e])throw new Error(`Price method ${e} for commodity ${a} has no name, please contact Navarch for assistance`)}}});const O={key:0},T={key:1};var U=[],B=[];!function(t,e){if(t&&"undefined"!=typeof document){var a,r=!0===e.prepend?"prepend":"append",n=!0===e.singleTag,o="string"==typeof e.container?document.querySelector(e.container):document.getElementsByTagName("head")[0];if(n){var i=U.indexOf(o);-1===i&&(i=U.push(o)-1,B[i]={}),a=B[i]&&B[i][r]?B[i][r]:B[i][r]=s()}else a=s();65279===t.charCodeAt(0)&&(t=t.substring(1)),a.styleSheet?a.styleSheet.cssText+=t:a.appendChild(document.createTextNode(t))}function s(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),e.attributes)for(var a=Object.keys(e.attributes),n=0;n<a.length;n++)t.setAttribute(a[n],e.attributes[a[n]]);var i="prepend"===r?"afterbegin":"beforeend";return o.insertAdjacentElement(i,t),t}}(".margin-top-16px[data-v-64969d30] {\n  margin-top: 16px;\n}",{}),P.render=function(t,e,a,r,n,y){const m=o("v-button"),g=o("v-notice");return i(),s(l,null,[c(' <input :value="value" @input="handleChange($event.target.value)" /> '),c(" create a button only interface for Directus"),t.value?(i(),s("div",T,[d(m,{onClick:e[1]||(e[1]=()=>t.viewPdf())},{default:u((()=>[f("View Invoice ")])),_:1})])):(i(),s("div",O,[d(m,{onClick:e[0]||(e[0]=()=>t.generateInvoice()),loading:t.isGeneraingDoc},{default:u((()=>[f("Generate Invoice")])),_:1},8,["loading"]),t.failureReason?(i(),h(g,{key:0},{default:u((()=>[f(p(t.failureReason),1)])),_:1})):c("v-if",!0)])),d(m,{class:"margin-top-16px",onClick:e[2]||(e[2]=()=>t.copy()),loading:t.isCopying},{default:u((()=>[f("Copy")])),_:1},8,["loading"])],64)},P.__scopeId="data-v-64969d30",P.__file="src/interface.vue";var M=e({id:"invoice_generator_button",name:"Generate Invoice Button",icon:"receipt_long",description:"This is a custom interface for Navarch's Invoice Generator Button.",component:P,options:null,types:["json"],group:"standard"});export{M as default};
