import{useApi as t,defineInterface as e}from"@directus/extensions-sdk";import{defineComponent as r,ref as n,inject as o,resolveComponent as a,openBlock as i,createElementBlock as s,Fragment as f,createElementVNode as u,createVNode as c,withCtx as l,createTextVNode as h,createBlock as d,toDisplayString as p,createCommentVNode as y}from"vue";for(var g={},w={byteLength:function(t){var e=A(t),r=e[0],n=e[1];return 3*(r+n)/4-n},toByteArray:function(t){var e,r,n=A(t),o=n[0],a=n[1],i=new E(function(t,e,r){return 3*(e+r)/4-r}(0,o,a)),s=0,f=a>0?o-4:o;for(r=0;r<f;r+=4)e=b[t.charCodeAt(r)]<<18|b[t.charCodeAt(r+1)]<<12|b[t.charCodeAt(r+2)]<<6|b[t.charCodeAt(r+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=255&e;2===a&&(e=b[t.charCodeAt(r)]<<2|b[t.charCodeAt(r+1)]>>4,i[s++]=255&e);1===a&&(e=b[t.charCodeAt(r)]<<10|b[t.charCodeAt(r+1)]<<4|b[t.charCodeAt(r+2)]>>2,i[s++]=e>>8&255,i[s++]=255&e);return i},fromByteArray:function(t){for(var e,r=t.length,n=r%3,o=[],a=16383,i=0,s=r-n;i<s;i+=a)o.push(_(t,i,i+a>s?s:i+a));1===n?(e=t[r-1],o.push(m[e>>2]+m[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],o.push(m[e>>10]+m[e>>4&63]+m[e<<2&63]+"="));return o.join("")}},m=[],b=[],E="undefined"!=typeof Uint8Array?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=0;B<64;++B)m[B]=v[B],b[v.charCodeAt(B)]=B;function A(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function _(t,e,r){for(var n,o,a=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),a.push(m[(o=n)>>18&63]+m[o>>12&63]+m[o>>6&63]+m[63&o]);return a.join("")}b["-".charCodeAt(0)]=62,b["_".charCodeAt(0)]=63;var I={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,r,n,o){var a,i,s=8*o-n-1,f=(1<<s)-1,u=f>>1,c=-7,l=r?o-1:0,h=r?-1:1,d=t[e+l];for(l+=h,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+t[e+l],l+=h,c-=8);for(i=a&(1<<-c)-1,a>>=-c,c+=n;c>0;i=256*i+t[e+l],l+=h,c-=8);if(0===a)a=1-u;else{if(a===f)return i?NaN:1/0*(d?-1:1);i+=Math.pow(2,n),a-=u}return(d?-1:1)*i*Math.pow(2,a-n)},write:function(t,e,r,n,o,a){var i,s,f,u=8*a-o-1,c=(1<<u)-1,l=c>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,p=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,i=c):(i=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-i))<1&&(i--,f*=2),(e+=i+l>=1?h/f:h*Math.pow(2,1-l))*f>=2&&(i++,f/=2),i+l>=c?(s=0,i=c):i+l>=1?(s=(e*f-1)*Math.pow(2,o),i+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,o),i=0));o>=8;t[r+d]=255&s,d+=p,s/=256,o-=8);for(i=i<<o|s,u+=o;u>0;t[r+d]=255&i,d+=p,i/=256,u-=8);t[r+d-p]|=128*y}};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
!function(t){const e=w,r=I,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=i,t.SlowBuffer=function(t){+t!=t&&(t=0);return i.alloc(+t)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,i.prototype),e}function i(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,r)}function s(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|d(t,e);let n=a(r);const o=n.write(t,e);o!==r&&(n=n.slice(0,o));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(X(t,Uint8Array)){const e=new Uint8Array(t);return l(e.buffer,e.byteOffset,e.byteLength)}return c(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(X(t,ArrayBuffer)||t&&X(t.buffer,ArrayBuffer))return l(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(X(t,SharedArrayBuffer)||t&&X(t.buffer,SharedArrayBuffer)))return l(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return i.from(n,e,r);const o=function(t){if(i.isBuffer(t)){const e=0|h(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||Z(t.length)?a(0):c(t);if("Buffer"===t.type&&Array.isArray(t.data))return c(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return i.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return f(t),a(t<0?0:0|h(t))}function c(t){const e=t.length<0?0:0|h(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function l(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,i.prototype),n}function h(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function d(t,e){if(i.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||X(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(t).length;default:if(o)return n?-1:q(t).length;e=(""+e).toLowerCase(),o=!0}}function p(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return U(this,e,r);case"ascii":return N(this,e,r);case"latin1":case"binary":return O(this,e,r);case"base64":return _(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function g(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=i.from(e,n)),i.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,o){let a,i=1,s=t.length,f=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;i=2,s/=2,f/=2,r/=2}function u(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(o){let n=-1;for(a=r;a<s;a++)if(u(t,a)===u(e,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===f)return n*i}else-1!==n&&(a-=a-n),n=-1}else for(r+f>s&&(r=s-f),a=r;a>=0;a--){let r=!0;for(let n=0;n<f;n++)if(u(t,a+n)!==u(e,n)){r=!1;break}if(r)return a}return-1}function b(t,e,r,n){r=Number(r)||0;const o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;const a=e.length;let i;for(n>a/2&&(n=a/2),i=0;i<n;++i){const n=parseInt(e.substr(2*i,2),16);if(Z(n))return i;t[r+i]=n}return i}function E(t,e,r,n){return V(q(e,t.length-r),t,r,n)}function v(t,e,r,n){return V(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function B(t,e,r,n){return V(Y(e),t,r,n)}function A(t,e,r,n){return V(function(t,e){let r,n,o;const a=[];for(let i=0;i<t.length&&!((e-=2)<0);++i)r=t.charCodeAt(i),n=r>>8,o=r%256,a.push(o),a.push(n);return a}(e,t.length-r),t,r,n)}function _(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function U(t,e,r){r=Math.min(t.length,r);const n=[];let o=e;for(;o<r;){const e=t[o];let a=null,i=e>239?4:e>223?3:e>191?2:1;if(o+i<=r){let r,n,s,f;switch(i){case 1:e<128&&(a=e);break;case 2:r=t[o+1],128==(192&r)&&(f=(31&e)<<6|63&r,f>127&&(a=f));break;case 3:r=t[o+1],n=t[o+2],128==(192&r)&&128==(192&n)&&(f=(15&e)<<12|(63&r)<<6|63&n,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:r=t[o+1],n=t[o+2],s=t[o+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(f=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&s,f>65535&&f<1114112&&(a=f))}}null===a?(a=65533,i=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),o+=i}return function(t){const e=t.length;if(e<=$)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=$));return r}(n)}t.kMaxLength=o,i.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(t,e,r){return s(t,e,r)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(t,e,r){return function(t,e,r){return f(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},i.allocUnsafe=function(t){return u(t)},i.allocUnsafeSlow=function(t){return u(t)},i.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==i.prototype},i.compare=function(t,e){if(X(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),X(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let o=0,a=Math.min(r,n);o<a;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=i.allocUnsafe(e);let o=0;for(r=0;r<t.length;++r){let e=t[r];if(X(e,Uint8Array))o+e.length>n.length?(i.isBuffer(e)||(e=i.from(e)),e.copy(n,o)):Uint8Array.prototype.set.call(n,e,o);else{if(!i.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},i.byteLength=d,i.prototype._isBuffer=!0,i.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},i.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},i.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},i.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?U(this,0,t):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(i.prototype[n]=i.prototype.inspect),i.prototype.compare=function(t,e,r,n,o){if(X(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;let a=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0);const f=Math.min(a,s),u=this.slice(n,o),c=t.slice(e,r);for(let t=0;t<f;++t)if(u[t]!==c[t]){a=u[t],s=c[t];break}return a<s?-1:s<a?1:0},i.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},i.prototype.indexOf=function(t,e,r){return g(this,t,e,r,!0)},i.prototype.lastIndexOf=function(t,e,r){return g(this,t,e,r,!1)},i.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return B(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const $=4096;function N(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function O(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function R(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let o="";for(let n=e;n<r;++n)o+=H[t[n]];return o}function S(t,e,r){const n=t.slice(e,r);let o="";for(let t=0;t<n.length-1;t+=2)o+=String.fromCharCode(n[t]+256*n[t+1]);return o}function C(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,r,n,o,a){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function x(t,e,r,n,o){G(e,n,o,t,r,7);let a=Number(e&BigInt(4294967295));t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a;let i=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,r}function L(t,e,r,n,o){G(e,n,o,t,r,7);let a=Number(e&BigInt(4294967295));t[r+7]=a,a>>=8,t[r+6]=a,a>>=8,t[r+5]=a,a>>=8,t[r+4]=a;let i=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=i,i>>=8,t[r+2]=i,i>>=8,t[r+1]=i,i>>=8,t[r]=i,r+8}function P(t,e,r,n,o,a){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(t,e,n,o,a){return e=+e,n>>>=0,a||P(t,0,n,4),r.write(t,e,n,o,23,4),n+4}function M(t,e,n,o,a){return e=+e,n>>>=0,a||P(t,0,n,8),r.write(t,e,n,o,52,8),n+8}i.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,i.prototype),n},i.prototype.readUintLE=i.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t],o=1,a=0;for(;++a<e&&(o*=256);)n+=this[t+a]*o;return n},i.prototype.readUintBE=i.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t+--e],o=1;for(;e>0&&(o*=256);)n+=this[t+--e]*o;return n},i.prototype.readUint8=i.prototype.readUInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),this[t]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readBigUInt64LE=K((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))})),i.prototype.readBigUInt64BE=K((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(o)})),i.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t],o=1,a=0;for(;++a<e&&(o*=256);)n+=this[t+a]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*e)),n},i.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=e,o=1,a=this[t+--n];for(;n>0&&(o*=256);)a+=this[t+--n]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*e)),a},i.prototype.readInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){t>>>=0,e||C(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(t,e){t>>>=0,e||C(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readBigInt64LE=K((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),i.prototype.readBigInt64BE=K((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),i.prototype.readFloatLE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){T(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=1,a=0;for(this[e]=255&t;++a<r&&(o*=256);)this[e+a]=t/o&255;return e+r},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){T(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=r-1,a=1;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=t/a&255;return e+r},i.prototype.writeUint8=i.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,255,0),this[e]=255&t,e+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeBigUInt64LE=K((function(t,e=0){return x(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),i.prototype.writeBigUInt64BE=K((function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),i.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,t,e,r,n-1,-n)}let o=0,a=1,i=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===i&&0!==this[e+o-1]&&(i=1),this[e+o]=(t/a|0)-i&255;return e+r},i.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,t,e,r,n-1,-n)}let o=r-1,a=1,i=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===i&&0!==this[e+o+1]&&(i=1),this[e+o]=(t/a|0)-i&255;return e+r},i.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},i.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeBigInt64LE=K((function(t,e=0){return x(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),i.prototype.writeBigInt64BE=K((function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),i.prototype.writeFloatLE=function(t,e,r){return k(this,t,e,!0,r)},i.prototype.writeFloatBE=function(t,e,r){return k(this,t,e,!1,r)},i.prototype.writeDoubleLE=function(t,e,r){return M(this,t,e,!0,r)},i.prototype.writeDoubleBE=function(t,e,r){return M(this,t,e,!1,r)},i.prototype.copy=function(t,e,r,n){if(!i.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const o=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),o},i.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{const a=i.isBuffer(t)?t:i.from(t,n),s=a.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=a[o%s]}return this};const F={};function D(t,e,r){F[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function j(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function G(t,e,r,n,o,a){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let o;throw o=a>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(a+1)}${n}`:`>= -(2${n} ** ${8*(a+1)-1}${n}) and < 2 ** ${8*(a+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,r){W(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||z(e,t.length-(r+1))}(n,o,a)}function W(t,e){if("number"!=typeof t)throw new F.ERR_INVALID_ARG_TYPE(e,"number",t)}function z(t,e,r){if(Math.floor(t)!==t)throw W(t,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}D("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),D("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),D("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,o=r;return Number.isInteger(r)&&Math.abs(r)>2**32?o=j(String(r)):"bigint"==typeof r&&(o=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(o=j(o)),o+="n"),n+=` It must be ${e}. Received ${o}`,n}),RangeError);const J=/[^+/0-9A-Za-z-_]/g;function q(t,e){let r;e=e||1/0;const n=t.length;let o=null;const a=[];for(let i=0;i<n;++i){if(r=t.charCodeAt(i),r>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(i+1===n){(e-=3)>-1&&a.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&a.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function Y(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,r,n){let o;for(o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function X(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const H=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let o=0;o<16;++o)e[n+o]=t[r]+t[o]}return e}();function K(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}}(g);const U=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],N="foreign_key",O="lot_number",R="method",S="contract",C="shipment_code",T="counterparty",x="assay_results",L="weight_result",P="bl_date",k="vessel",M="origin",F="destination",D="commodity",j="seller_assay",G="assay_uom",W="dry_weight",z="wet_weight",J="wet_weight_uom",q="dry_weight_uom",Y="name",V="name",X="name",Z="line_1",H="line_2",K="city",Q="state",tt="country",et="zip",rt="phone_code",nt="phone_number",ot="signatory_name",at="signatory_title",it="signature",st="logo",ft="navarch_country",ut="name",ct="phone_code",lt="navarch_world_port",ht="port_name",dt="country",pt="name",yt="code",gt="name";var wt=(t=>(t.AssayExchange="Assay Exchange",t.CertOfOrigin="Cert Of Origin",t.Invoices="Invoices",t.LoadportDisportComparison="Loadport-Disport Comparison",t.PenaltyElements="Penalty Elements",t.ShipmentLatest="Shipment Latest",t.WeightAndAssayCert="Weight & Assay Cert",t))(wt||{}),mt=(t=>(t.PNG="image/png",t.JPEG="image/jpeg",t.JPG="image/jpg",t))(mt||{}),bt=Object.getOwnPropertySymbols,Et=Object.prototype.hasOwnProperty,vt=Object.prototype.propertyIsEnumerable;function Bt(t,e=!1){const r=e&&!isNaN(t.getDay())?U[t.getDay()]:void 0,n=t.getDate(),o=t.getMonth(),a=t.getFullYear();return`${n} ${$[o]} ${a}${r?` (${r})`:""}`}async function At(t,e){if(!t)throw console.error("[uploadGeneratedDoc] fileData is empty"),new Error("A failure occured while trying to upload the generated document, no file data found. Please try again.");const r=function(t){console.log("[convertJsonToFormData] json=",JSON.stringify(t));const e=new FormData;for(let r in t)"file"!==r&&e.append(r,t[r]);const r=t.file,n=function(t,e){const r=atob(t),n=new ArrayBuffer(r.length),o=new Uint8Array(n);for(let t=0;t<r.length;t++)o[t]=r.charCodeAt(t);const a=new Blob([o],{type:e});return a}(r,"application/pdf");return e.append("file",n,t.filename_download),e}(t),n=await e.post("/files",r,{headers:{"Content-Type":"multipart/form-data"}});if(200!==n.status)throw console.error(`[uploadGeneratedDoc] uploadedFileData status: ${n.status}`),new Error("A failure occured while trying to upload the generated document. Please try again.");return n.data.data.id}function _t(t,e,r,n){return async()=>{const o=((t,e)=>{var r={};for(var n in t)Et.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&bt)for(var n of bt(t))e.indexOf(n)<0&&vt.call(t,n)&&(r[n]=t[n]);return r})(t,["id","user_created","date_created","user_updated","date_updated"]);o[n]=null;const a=await e.post(`/items/${r}`,o);if(200!==a.status)throw console.error(`[duplicate doc] copy response status: ${a.status}`),new Error(`Failed to duplicate assay exchange with status ${a.status}`);window.open(`/admin/content/${r}/${a.data.data.id}`)}}async function It(t,e,r){if(t){const n=await e.get(`/assets/${t}`,{responseType:"arraybuffer"}),o=r.from(n.data,"binary"),a=n.headers["content-type"];if(Object.values(mt).includes(a))return{imageData:o.toString("base64"),imageType:a}}return null}function Ut(t,e){if(!t||!t.data||!t.data.data)throw new Error(`No ${e} port data found, please contact Navarch to check that the selected port is still valid.`);if(!t.data.data[ht])throw new Error(`Port name for ${e} port not found, please contact Navarch to check that the selected port is still valid.`);if(!t.data.data[dt])throw new Error("Port country for ${portType} port not found, please contact Navarch to check that the selected port is still valid.")}var $t=r({props:{value:{type:String,default:null}},emits:["input"],setup(e,{emit:r}){const a=n(null),i=n(!1),s=n(!1),f=t(),u=o("values",n({})),c=function(t,e){return async()=>{const r=await e.get(`/folders?filter[name][_eq]=${encodeURI(t.toString())}`);return 200===r.status&&r.data&&r.data.data?0===r.data.data.length?(await e.post("/folders",{name:t.toString()})).data.data.id:r.data.data[0].id:null}}(wt.AssayExchange,f),l=function(t,e,r){return async n=>{const o=null!=n?n:t.value.doc_name;if(console.log(`[downloadPdf] doc ID: ${o}`),!o)throw new Error("No document ID found, please ensure the document has been generated");try{const t=(await e.get(`/files/${o}`)).data.data.filename_download,n=await e.get(`/assets/${o}`,{responseType:"arraybuffer"}),a=new Blob([n.data],{type:"application/pdf"}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=null!=t?t:r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}catch(t){throw console.error(`[downloadPdf] error: ${t}`),new Error("Failed to fetch the document, please try again")}}}(e,f,wt.AssayExchange),h=_t(u.value,f,"navarch_assay_exchange","assay_exchange_2");return{isGeneratingDoc:i,failureReason:a,generatePdf:async function(){var t,e,n,o,s,h,d,p;a.value=null,i.value=!0;try{const y=u.value.parcel,w=await f.get(`/items/navarch_parcel/${y}`,{params:{fields:["id",x,L,S,C,T,P,k,M,F]}});!function(t){if(!t||!t.data||!t.data.data)throw new Error("No parcel data found, please ensure the selected parcel still exists.");if(!t.data.data[x])throw new Error("No assay data found in selected parcel");if(!t.data.data[L])throw new Error("No weight data found in selected parcel");if(!t.data.data[S])throw new Error("No contract found in selected parcel");if(!t.data.data[C])throw new Error("No shipment code found in selected parcel");if(!t.data.data[T])throw new Error("No counterparty found in selected parcel");if(!t.data.data[P])throw new Error("No bill of lading date found in selected parcel");if(!t.data.data[M])throw new Error("No origin port found in selected parcel");if(!t.data.data[F])throw new Error("No destination port found in selected parcel")}(w);const m=w.data.data[x],b=w.data.data[L],E=await f.get("/items/navarch_assay_lot",{params:{filter:{[N]:{_eq:m}},sort:[O],fields:[R,O,D,j,G]}});!function(t){if(!t||!t.data||!t.data.data||0===t.data.data.length)throw new Error("No assay lots data found, please ensure assay data has been entered for the selected parcel.");t.data.data.forEach((t=>{if(!t[R])throw new Error("Some assays in the selected parcel does not have a method value");if(!t[D])throw new Error("Some assays in the selected parcel does not have a commodity value");if(!t[j])throw new Error("Some assays in the selected parcel does not have a seller assay value");if(!t[G])throw new Error("Some assays in the selected parcel does not have an assay uom value")}))}(E);const v=E.data.data.reduce(((t,e)=>{const r=e[R],n=t.find((t=>t[0][R]===r));return n?n.push(e):t.push([e]),t}),[]),B=null!=(o=null!=(n=null!=(e=null!=(t=v.find((t=>"Outturn"===t[0][R])))?t:v.find((t=>"Inturn Final"===t[0][R])))?e:v.find((t=>"Inturn"===t[0][R])))?n:v.find((t=>"Estimated"===t[0][R])))?o:v.find((t=>"Planned"===t[0][R]));if(!B)throw new Error("No assay lots with a valid method found in selected parcel");const A=B[0][R];if(!A)throw new Error("No method found in selected parcel");if(!["Outturn","Inturn Final","Inturn","Estimated","Planned"].includes(A))throw new Error(`Invalid method ${A} found in selected parcel`);const _=E.data.data.map((t=>t.commodity)).filter(((t,e,r)=>r.indexOf(t)===e)),I=_.map((t=>({[yt]:{_eq:t}}))),U=await f.get("/items/navarch_commodity",{params:{filter:{_or:I},fields:[pt,yt]}});!function(t){if(!t||!t.data||!t.data.data||0===t.data.data.length)throw new Error("No commodity mapping data found, please contact Navarch for assistance.");t.data.data.forEach((t=>{if(!t[pt])throw new Error("Some commodities in the selected parcel does not have a name, please contact Navarch for assistance.");if(!t[yt])throw new Error("Some commodities in the selected parcel does not have a code, please contact Navarch for assistance.")}))}(U),console.log(`commodity mapping response: ${JSON.stringify(U.data.data)}`);const $=U.data.data.reduce(((t,e)=>(t[e.code]=e.name,t)),{}),wt=B.map((t=>{var e;return{lotNumber:t[O],commodityName:$[t[D]],commodityCode:t[D],analyticalAssay:parseFloat(null!=(e=t[j])?e:"0"),assayUom:t[G]}})),mt=wt.filter((t=>null!==t.lotNumber)),bt=wt.filter((t=>null===t.lotNumber&&void 0===mt.find((e=>e.commodityCode===t.commodityCode)))),Et=await f.get("/items/navarch_weight_lot",{params:{filter:{[N]:{_eq:b},[R]:{_eq:A},[O]:{_nnull:!0}},sort:[O],fields:[R,O,W,z,J,q]}});!function(t){if(!t||!t.data||!t.data.data||0===t.data.data.length)throw new Error("No weight lots data found, please ensure weight data has been entered for the selected parcel.");t.data.data.forEach((t=>{if(!t[R])throw new Error("Some weights in the selected parcel does not have a method");if(!t[z])throw new Error("Some weights in the selected parcel does not have a wet weight value");if(!t[J])throw new Error("Some weights in the selected parcel does not have a wet weight UOM");if(!t[W])throw new Error("Some weights in the selected parcel does not have a dry weight value");if(!t[q])throw new Error("Some weights in the selected parcel does not have a dry weight UOM")}))}(Et);const vt=Et.data.data.reduce(((t,e)=>{const r=e[R],n=t.find((t=>t[0][R]===r));return n?n.push(e):t.push([e]),t}),[]),_t=null!=(p=null!=(d=null!=(h=null!=(s=vt.find((t=>"Outturn"===t[0][R])))?s:vt.find((t=>"Inturn Final"===t[0][R])))?h:vt.find((t=>"Inturn"===t[0][R])))?d:vt.find((t=>"Estimated"===t[0][R])))?p:vt.find((t=>"Planned"===t[0][R]));if(!_t)throw new Error("No weight lots with a valid method found in selected parcel");const $t=_t.map((t=>{var e,r,n,o,a;return{lotNumber:t[O],wetWeight:parseFloat(null!=(e=t[z])?e:"0"),wetWeightUom:t[J],moisture:(parseFloat(null!=(r=t[z])?r:"0")-parseFloat(null!=(n=t[W])?n:"0"))/parseFloat(null!=(o=t[z])?o:"1")*100,moistureUom:"%",dryWeight:parseFloat(null!=(a=t[W])?a:"0"),dryWeightUom:t[q]}})),Nt=w.data.data[k];let Ot;Nt&&(Ot=await f.get(`/items/navarch_vessel/${Nt}`,{params:{fields:[V]}}));const Rt=await f.get("/items/navarch_company",{params:{fields:[X,Z,H,K,Q,et,tt,rt,nt,ot,at,it,st]}});!function(t){if(!t||!t.data||!t.data.data)throw new Error("No company data found, please ensure that company data has been entered.");if(!t.data.data[X])throw new Error("Company name not found.");if(!t.data.data[Z])throw new Error("Please ensure that company address line 1 has been entered.");if(!t.data.data[tt])throw new Error("Company base country not found.");if(!t.data.data[ot])throw new Error("Company signatory name not found.");if(!t.data.data[at])throw new Error("Company signatory title not found.")}(Rt);const St=Rt.data.data,Ct=St[X];let Tt,xt;if(St[rt]){const t=await f.get(`/items/${ft}/${St[rt]}`,{params:{fields:[ct]}});!function(t){if(!t||!t.data||!t.data.data)throw new Error("No company country phone code data found, please contact Navarch for assistance.");if(!t.data.data[ct])throw new Error("Company-based country phone code not found, please contact Navarch for assistance.")}(t),Tt=t.data.data[ct],xt=St[nt]}const Lt=St[Z],Pt=St[H]?`,\n${St[H]}`:"",kt=St[K]?`,\n${St[K]}`:"",Mt=St[Q]?`,\n${St[Q]}`:"",Ft=await f.get(`/items/${ft}/${St[tt]}`,{params:{fields:[ut]}});!function(t){if(!t||!t.data||!t.data.data)throw new Error("No company country base data found, please contact Navarch for assistance.");if(!t.data.data[ut])throw new Error("Company-based country name not found, please contact Navarch for assistance.")}(Ft);const Dt=Ft.data.data[ut]?`, ${Ft.data.data[ut]}`:"",jt=`${Lt}${Pt}${kt}${St[et]?` ${St[et]}`:""}${Mt}${Dt}`,Gt=await It(St[st],f,g.Buffer),Wt=St[it],zt=await It(Wt,f,g.Buffer),Jt={signatoryName:St[ot],signatoryTitle:St[at],signature:null!=zt?zt:null,company:Ct},qt=await f.get(`/items/navarch_counterparty/${w.data.data[T]}`,{params:{fields:[Y]}});!function(t){if(!t||!t.data||!t.data.data)throw new Error("No counterparty data found, please ensure that counterparty data has been entered.");if(!t.data.data[Y])throw new Error("Counterparty name not found, please ensure that the selected counterparty has a name.")}(qt);const Yt=await f.get(`/items/${lt}/${w.data.data[M]}`,{params:{fields:[ht,dt]}});Ut(Yt,"origin");const Vt=await f.get(`/items/${lt}/${w.data.data[F]}`,{params:{fields:[ht,dt]}});Ut(Vt,"destination");const Xt=await f.get(`/items/navarch_contract/${w.data.data[S]}`,{params:{fields:[gt]}});!function(t){if(!t)throw new Error("No contract data found, please ensure the selected parcel has an associated contract");if(!t[gt])throw new Error("No contract name found for the associated contract of the selected parcel")}(Xt.data.data);const Zt={doc_name:null,folder_id:await c(),company_logo:Gt,seller:Ct,seller_address:jt,seller_phone_number:Tt&&xt?`+${Tt} ${xt}`:null,buyer:qt.data.data[Y],vessel:Ot?Ot.data.data[V]:"N/A",contract_ref:Xt.data.data[gt],bl_date:Bt(new Date(w.data.data[P])),parcel_ref:`${w.data.data[C]}`,port_of_loading:`${Yt.data.data[ht]}, ${Yt.data.data[dt]}`,port_of_discharge:`${Vt.data.data[ht]}, ${Vt.data.data[dt]}`,weights:$t,assays:mt,composite_assays:bt,signatory:Jt};let Ht;try{Ht=await f.post("/generate/assay-exchange",Zt)}catch(t){throw console.error(`[generateProvWeightAndAssay] error: ${t}`),new Error(JSON.stringify(t.response.data))}if(200!==Ht.status)return console.log(`[generateProvWeightAndAssay] invoice response status: ${Ht.status}`),i.value=!1,void(a.value="Something went wrong when generating assay exchange cert, please contact Navarch for assistance.");const Kt=await At(Ht.data,f);Zt.doc_name=Kt,Zt.company_logo=null,Zt.signatory&&(Zt.signatory.signature=null),r("input",Zt),i.value=!1,l(Kt)}catch(t){console.error("[generateProvWeightAndAssay] error=",t),a.value=t,i.value=!1}},copy:async()=>{s.value=!0;try{await h()}catch(t){a.value=t.message}s.value=!1},isCopying:s,downloadPdf:l}}});const Nt={style:{display:"flex","flex-direction":"row"}},Ot={key:0},Rt={key:1};var St=[],Ct=[];!function(t,e){if(t&&"undefined"!=typeof document){var r,n=!0===e.prepend?"prepend":"append",o=!0===e.singleTag,a="string"==typeof e.container?document.querySelector(e.container):document.getElementsByTagName("head")[0];if(o){var i=St.indexOf(a);-1===i&&(i=St.push(a)-1,Ct[i]={}),r=Ct[i]&&Ct[i][n]?Ct[i][n]:Ct[i][n]=s()}else r=s();65279===t.charCodeAt(0)&&(t=t.substring(1)),r.styleSheet?r.styleSheet.cssText+=t:r.appendChild(document.createTextNode(t))}function s(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),e.attributes)for(var r=Object.keys(e.attributes),o=0;o<r.length;o++)t.setAttribute(r[o],e.attributes[r[o]]);var i="prepend"===n?"afterbegin":"beforeend";return a.insertAdjacentElement(i,t),t}}(".margin-top-16px[data-v-64969d30] {\n  margin-top: 16px;\n}\n.margin-left-16px[data-v-64969d30] {\n  margin-left: 16px;\n}\n.secondary-button[data-v-64969d30] {\n  --v-button-background-color: var(--background-page);\n  --v-button-color: var(--primary);\n  border: 1px solid var(--primary);\n  border-radius: var(--border-radius);\n}\n.secondary-button[data-v-64969d30]:hover {\n  border-color: var(--v-button-background-color-hover);\n  --v-button-color: inherit;\n}",{}),$t.render=function(t,e,r,n,o,g){const w=a("v-button"),m=a("v-notice");return i(),s(f,null,[u("div",Nt,[t.value?(i(),s("div",Rt,[c(w,{onClick:e[1]||(e[1]=()=>t.downloadPdf())},{default:l((()=>[h("Download Assay Exchange Cert ")])),_:1})])):(i(),s("div",Ot,[c(w,{onClick:e[0]||(e[0]=()=>t.generatePdf()),loading:t.isGeneratingDoc},{default:l((()=>[h("Generate Assay Exchange Cert")])),_:1},8,["loading"])])),c(w,{class:"margin-left-16px secondary-button",onClick:e[2]||(e[2]=()=>t.copy()),loading:t.isCopying},{default:l((()=>[h("Copy")])),_:1},8,["loading"])]),t.failureReason?(i(),d(m,{key:0,class:"margin-top-16px"},{default:l((()=>[h(p(t.failureReason),1)])),_:1})):y("v-if",!0)],64)},$t.__scopeId="data-v-64969d30",$t.__file="src/interface.vue";var Tt=e({id:"navarch-docgen-assay-exchange-v2",name:"Navarch Assay Exchange Cert Generator Button (V2)",icon:"receipt_long",description:"This is a version 2 custom interface for Navarch's Assay Exchange Cert Generator Button.",component:$t,options:null,types:["json"],group:"standard"});export{Tt as default};
