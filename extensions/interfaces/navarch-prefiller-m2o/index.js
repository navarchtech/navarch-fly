import{useApi as e,useStores as t,useExtensions as n}from"@directus/extensions-sdk";import{defineComponent as l,inject as i,ref as o,toRef as a,watch as r,openBlock as s,createBlock as c,resolveDynamicComponent as u,mergeProps as d}from"vue";var p=l({props:{value:{type:String,default:null},currentCollection:{type:String,default:null},listenedField:{type:[String],default:null}},emits:["input"],setup(l,{attrs:s,emit:c}){const u=i("values",o({})),{listenedField:d,currentCollection:p}=l,m=a(l,"value"),f=d[0].split(".");let v="",g="";f.length>=2&&(v=f[0],g=f[1]);const h=e(),{useRelationsStore:y}=t(),w=y().getRelationForField(p,v).related_collection;r((()=>u.value[v]),(async e=>{null!=e&&null==m.value&&async function(e,t,n){let l=await h.get(`/items/${t}/${n}`,{params:{fields:e}});return l.data.data}([g],w,e).then((async e=>{let t=e[g];c("input",t)}))}));const{interfaces:C}=n(),{component:F}=C.value.find((e=>"select-dropdown-m2o"===e.id));return{attrs:s,DropdownM2OComponent:F,handleChange:function(e){m.value=e,c("input",e)}}}});p.render=function(e,t,n,l,i,o){return s(),c(u(e.DropdownM2OComponent),d(e.attrs,{value:e.value,onInput:e.handleChange}),null,16,["value","onInput"])},p.__file="src/interface.vue";var m={id:"navarch-prefilling-select-dropdown-m2o",name:" Navarch Prefilling M2O Extension",description:"Functions like the default Directus M2O interface but can be prefilled with a default value in response to another field in the same collection",icon:"arrow_right_alt",component:p,types:["uuid","string","text","integer","bigInteger"],relational:!0,localTypes:["m2o"],group:"relational",options:({relations:e,collection:t})=>{var n;const l=null===(n=e.m2o)||void 0===n?void 0:n.related_collection;return[{field:"template",name:"$t:interfaces.select-dropdown-m2o.display_template",meta:{interface:"system-display-template",options:{collectionName:l}}},{field:"listenedField",name:"Field to Watch",meta:{interface:"system-fields",options:{collectionName:t}}},{field:"currentCollection",name:"This Collection's Name",meta:{interface:"input"}},{field:"filter",name:"$t:filter",type:"json",meta:{interface:"system-filter",options:{collectionName:l}}}]},recommendedDisplays:["related-values"]};export{m as default};
