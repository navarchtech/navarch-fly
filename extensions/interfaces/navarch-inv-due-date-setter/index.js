import{useApi as t,defineInterface as e}from"@directus/extensions-sdk";import{defineComponent as n,ref as a,inject as l,watch as d,resolveComponent as i,resolveDirective as r,openBlock as o,createBlock as c,withCtx as u,createCommentVNode as s,createElementBlock as v,createVNode as p,Fragment as m,renderList as y,createElementVNode as f,toDisplayString as _,createSlots as h,mergeProps as g,toHandlers as k,withDirectives as b}from"vue";var D=n({props:{value:{type:Object,default:null}},emits:["input"],setup(e,{emit:n}){var i;const r=t(),o=a(),c=a(!1),u=a(""),s=a([]),v=a(null!=(i=e.value)?i:{}),p="contract",m="navarch_contract_payment_information",y="related_contract",f="invoice_type",_=l("values",a({}));return d((()=>_.value[p]),(async t=>{c.value=!!_.value[p],t?(await async function(t){try{const e=await r.get(`/items/${m}`,{params:{filter:{[y]:{_eq:t}},fields:[f]}});s.value=e.data.data.map((t=>t[f])).filter((t=>null!=t))}catch(t){console.error(t)}}(t),function(){const t={};s.value.forEach((e=>{v.value[e]?t[e]=v.value[e]:t[e]={due_date:null,locked:!1,inv_type:e}})),v.value=t}()):n("input",null)}),{immediate:!0}),d(v,(t=>{console.log("[watch] due dates by invoice updated"),n("input",JSON.stringify(t))}),{deep:!0}),{invoiceTypeList:s,dueDatesByInvoiceType:v,isContractSelected:c,failureReason:u,dateTimeMenu:o,updateDueDate:function(t,e){v.value[t].due_date=e},unsetValue:function(t){v.value[t].due_date=null},displayDate:function(t){const e=t?new Date(t):null;return e?e.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):""}}}});const T={key:0},I={key:1},w={class:"list-item-component left"};var x=[],S=[];!function(t,e){if(t&&"undefined"!=typeof document){var n,a=!0===e.prepend?"prepend":"append",l=!0===e.singleTag,d="string"==typeof e.container?document.querySelector(e.container):document.getElementsByTagName("head")[0];if(l){var i=x.indexOf(d);-1===i&&(i=x.push(d)-1,S[i]={}),n=S[i]&&S[i][a]?S[i][a]:S[i][a]=r()}else n=r();65279===t.charCodeAt(0)&&(t=t.substring(1)),n.styleSheet?n.styleSheet.cssText+=t:n.appendChild(document.createTextNode(t))}function r(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),e.attributes)for(var n=Object.keys(e.attributes),l=0;l<n.length;l++)t.setAttribute(n[l],e.attributes[n[l]]);var i="prepend"===a?"afterbegin":"beforeend";return d.insertAdjacentElement(i,t),t}}('.list-item[data-v-64969d30] {\n  margin-bottom: 10px;\n}\n.list-item-component[data-v-64969d30] {\n  float: left;\n}\n.left[data-v-64969d30] {\n  width: 30%;\n}\n.middle[data-v-64969d30] {\n  width: 40%;\n}\n.right[data-v-64969d30] {\n  width: 30%;\n  padding-left: 20px;\n}\n\n/* Clear floats after the columns */\n.list-item[data-v-64969d30]:after {\n  content: "";\n  display: table;\n  clear: both;\n}',{}),D.render=function(t,e,n,a,l,d){const D=i("v-icon"),x=i("v-input"),S=i("v-date-picker"),C=i("v-menu"),B=i("v-checkbox"),V=i("v-list-item"),M=i("v-list"),E=i("v-sheet"),L=r("tooltip");return o(),c(E,null,{default:u((()=>[s(" <div>{{ dueDatesByInvoiceType }}</div>\r\n\t\t<div>{{ invoiceTypeList }}</div>\r\n\t\t<div>{{ dateTimeMenu }}</div> "),t.isContractSelected?t.isContractSelected&&t.invoiceTypeList&&t.dueDatesByInvoiceType?(o(),v("div",I,[p(M,null,{default:u((()=>[(o(!0),v(m,null,y(t.dueDatesByInvoiceType,(e=>(o(),c(V,{class:"list-item",key:e.inv_type},{default:u((()=>[f("div",w,_(e.inv_type),1),p(C,{ref_for:!0,ref:"dateTimeMenu","close-on-content-click":!1,attached:"",disabled:e.locked,"full-height":"",seamless:""},{activator:u((({toggle:n,active:a})=>[p(x,{active:a,clickable:"",readonly:"","model-value":t.displayDate(e.due_date),disabled:e.locked,placeholder:e.due_date,onClick:n},h({_:2},[e.locked?void 0:{name:"append",fn:u((()=>[p(D,g({name:e.due_date?"clear":"today",class:{active:a,"clear-icon":!!e.due_date,"today-icon":!e.due_date}},k({click:e.due_date?()=>t.unsetValue(e.inv_type):null})),null,16,["name","class"])])),key:"0"}]),1032,["active","model-value","disabled","placeholder","onClick"])])),default:u((()=>[p(S,{type:"date",disabled:e.locked,"include-seconds":!1,"use-24":!1,"model-value":t.value,"onUpdate:modelValue":n=>t.updateDueDate(e.inv_type,n),onClose:t.dateTimeMenu?.deactivate},null,8,["disabled","model-value","onUpdate:modelValue","onClose"])])),_:2},1032,["disabled"]),s(' <v-input\r\n\t\t\t\t\t\tref="inputEl"\r\n\t\t\t\t\t\ttype="text"\r\n\t\t\t\t\t\t:pattern="\'\'"\r\n\t\t\t\t\t\t:value="dueDateItem.due_date"\r\n\t\t\t\t\t\t:style="{ width: `${(dueDateItem.due_date?.toString().length || 2) + 1 + \'ch\'}` }"\r\n\t\t\t\t\t\tplaceholder="--"\r\n\t\t\t\t\t\t@input="updateDueDate(dueDateItem.inv_type, $event?.target?.value)"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<v-menu\r\n\t\t\t\t\t\tref="dateTimeMenu"\r\n\t\t\t\t\t\t:close-on-content-click="false"\r\n\t\t\t\t\t\t:show-arrow="true"\r\n\t\t\t\t\t\tplacement="bottom-start"\r\n\t\t\t\t\t\tseamless\r\n\t\t\t\t\t\tfull-height\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<template #activator="{ toggle }">\r\n\t\t\t\t\t\t\t<v-icon class="preview" name="event" small @click="toggle" />\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<div class="date-input">\r\n\t\t\t\t\t\t\t<v-date-picker\r\n\t\t\t\t\t\t\t\ttype="text"\r\n\t\t\t\t\t\t\t\t:model-value="dueDateItem.due_date"\r\n\t\t\t\t\t\t\t\t@update:model-value="(newDate) => updateDueDate(dueDateItem.inv_type, newDate)"\r\n\t\t\t\t\t\t\t\t@close="dateTimeMenu?.deactivate"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</v-menu> '),s(" <interface-datetime /> "),s(' <v-menu>\r\n\t\t\t\t\t\t<template #activator="{ toggle, active }">\r\n\t\t\t\t\t\t\t<v-input :active="active" clickable readonly @click="toggle" />\r\n\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t<v-date-picker :style="{ width: \'50rem\'}" />\r\n\t\t\t\t\t</v-menu> '),s(' <v-menu \r\n\t\t\t\t\t\t:location="location"\r\n\t\t\t\t\t\t:style="{ maxHeight: \'none\', width: \'30rem\'}"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<template #activator="{ toggle }">\r\n\t\t\t\t\t\t\t<v-input\r\n\t\t\t\t\t\t\t\taria-readonly="true"\r\n\t\t\t\t\t\t\t\t@click="toggle"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t<v-date-picker \r\n\t\t\t\t\t\t\tv-model="dueDateItem.due_date"\r\n\t\t\t\t\t\t\t:style="{ width: \'30rem\'}"\r\n\t\t\t\t\t\t\t:include-seconds="true"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</v-menu> '),s(' <v-date-picker v-model="dueDateItem.due_date"></v-date-picker> '),s(' <v-menu>\r\n\t\t\t\t\t\t<template v-slot:activator="{ on, attrs }">\r\n\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\tv-model="dueDateItem.due_date"\r\n\t\t\t\t\t\t\tlabel="Select Date"\r\n\t\t\t\t\t\t\treadonly\r\n\t\t\t\t\t\t\tv-bind="attrs"\r\n\t\t\t\t\t\t\tv-on="on"\r\n\t\t\t\t\t\t\t></v-text-field>\r\n\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t<v-date-picker v-model="dueDateItem.due_date" @input="menuSingle = false"></v-date-picker>\r\n\t\t\t\t\t</v-menu> '),s(' <v-date-picker\r\n\t\t\t\t\t\tclass="list-item-component middle"\r\n\t\t\t\t\t\tv-model="dueDatesByInvoiceType[invType].due_date"\r\n\t\t\t\t\t\t:disabled="dueDatesByInvoiceType[invType].locked"\r\n\t\t\t\t\t\tv-tooltip.bottom="!!dueDatesByInvoiceType[invType].locked ? \'Cannot update due date if locked.\' : null"\r\n\t\t\t\t\t/> '),b(p(B,{class:"list-item-component right",modelValue:e.locked,"onUpdate:modelValue":t=>e.locked=t,"icon-on":"check_box","icon-off":"check_box_outline_blank",label:"Locked",disabled:null===e.due_date},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[L,e.due_date?null:"Please set a due date first.",void 0,{bottom:!0}]])])),_:2},1024)))),128))])),_:1})])):s("v-if",!0):(o(),v("div",T,"Please first select a contract.")),s(' <v-notice v-if="!!failureReason">\r\n\t\t\t{{ failureReason }}\r\n\t\t</v-notice> ')])),_:1})},D.__scopeId="data-v-64969d30",D.__file="src/interface.vue";var C=e({id:"navarch-inv-due-date-setter",name:"Navarch Invoice Due Date Setter",icon:"date_range",description:"For setting invoice due dates for each type of invoice.",component:D,options:null,types:["json"],group:"standard"});export{C as default};
