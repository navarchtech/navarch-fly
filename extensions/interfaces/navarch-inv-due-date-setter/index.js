import{useApi as e,defineInterface as t}from"@directus/extensions-sdk";import{defineComponent as n,ref as a,inject as l,watch as o,resolveComponent as i,resolveDirective as d,openBlock as u,createBlock as c,withCtx as s,createElementVNode as r,toDisplayString as v,createElementBlock as p,createVNode as m,Fragment as f,renderList as y,mergeProps as _,toHandlers as b,createCommentVNode as h,withDirectives as g}from"vue";var k=n({props:{value:{type:Object,default:null}},emits:["input"],setup(t,{emit:n}){var i;const d=e(),u=a(!1),c=a(""),s=a([]),r=a(null!=(i=t.value)?i:{}),v=a({}),p=a(!1),m="contract",f="navarch_contract_payment_information",y="related_contract",_="invoice_type",b=l("values",a({}));return o((()=>b.value[m]),(async e=>{u.value=!!b.value[m],e?(await async function(e){try{const t=await d.get(`/items/${f}`,{params:{filter:{[y]:{_eq:e}},fields:[_]}});s.value=t.data.data.map((e=>e[_]))}catch(e){console.error(e)}}(e),function(){const e={};s.value.forEach((t=>{r.value[t]?e[t]=r.value[t]:e[t]={due_date:null,locked:!1,inv_type:t}})),r.value=e}(),function(){const e={};s.value.forEach((t=>{e[t]=!1})),v.value=e}(),console.log(`Due dates by invoice type: ${JSON.stringify(r.value)}`),console.log(`Invoice types: ${JSON.stringify(s.value)}`)):n("input",null)}),{immediate:!0}),o(r,(e=>{n("input",e)}),{deep:!0}),{invoiceTypeList:s,dueDatesByInvoiceType:r,isContractSelected:u,failureReason:c,menu:v,menuSingle:p}}});const T={key:0},x={key:1},S={class:"list-item-component left"};var V=[],D=[];!function(e,t){if(e&&"undefined"!=typeof document){var n,a=!0===t.prepend?"prepend":"append",l=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(l){var i=V.indexOf(o);-1===i&&(i=V.push(o)-1,D[i]={}),n=D[i]&&D[i][a]?D[i][a]:D[i][a]=d()}else n=d();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function d(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),l=0;l<n.length;l++)e.setAttribute(n[l],t.attributes[n[l]]);var i="prepend"===a?"afterbegin":"beforeend";return o.insertAdjacentElement(i,e),e}}('.list-item[data-v-64969d30] {\n  margin-bottom: 10px;\n}\n.list-item-component[data-v-64969d30] {\n  float: left;\n}\n.left[data-v-64969d30] {\n  width: 30%;\n}\n.middle[data-v-64969d30] {\n  width: 40%;\n}\n.right[data-v-64969d30] {\n  width: 30%;\n  padding-left: 20px;\n}\n\n/* Clear floats after the columns */\n.list-item[data-v-64969d30]:after {\n  content: "";\n  display: table;\n  clear: both;\n}',{}),k.render=function(e,t,n,a,l,o){const k=i("v-text-field"),V=i("v-date-picker"),D=i("v-menu"),I=i("v-checkbox"),B=i("v-list-item"),C=i("v-list"),U=i("v-sheet"),w=d("tooltip");return u(),c(U,null,{default:s((()=>[r("div",null,v(e.dueDatesByInvoiceType),1),r("div",null,v(e.invoiceTypeList),1),r("div",null,v(e.menu),1),e.isContractSelected?e.isContractSelected&&e.invoiceTypeList&&e.dueDatesByInvoiceType?(u(),p("div",x,[m(C,null,{default:s((()=>[(u(!0),p(f,null,y(e.dueDatesByInvoiceType,(n=>(u(),c(B,{class:"list-item",key:n.inv_type},{default:s((()=>[r("div",S,v(n.inv_type),1),m(D,null,{activator:s((({on:e,attrs:t})=>[m(k,_({modelValue:n.due_date,"onUpdate:modelValue":e=>n.due_date=e,label:"Select Date",readonly:""},t,b(e)),null,16,["modelValue","onUpdate:modelValue"])])),default:s((()=>[m(V,{modelValue:n.due_date,"onUpdate:modelValue":e=>n.due_date=e,onInput:t[0]||(t[0]=t=>e.menuSingle=!1)},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),h(' <v-date-picker\n\t\t\t\t\t\tclass="list-item-component middle"\n\t\t\t\t\t\tv-model="dueDatesByInvoiceType[invType].due_date"\n\t\t\t\t\t\t:disabled="dueDatesByInvoiceType[invType].locked"\n\t\t\t\t\t\tv-tooltip.bottom="!!dueDatesByInvoiceType[invType].locked ? \'Cannot update due date if locked.\' : null"\n\t\t\t\t\t/> '),g(m(I,{class:"list-item-component right",modelValue:n.locked,"onUpdate:modelValue":e=>n.locked=e,"icon-on":"check_box","icon-off":"check_box_outline_blank",label:"Locked",disabled:null===n.due_date},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[w,n.due_date?null:"Please set a due date first.",void 0,{bottom:!0}]])])),_:2},1024)))),128))])),_:1})])):h("v-if",!0):(u(),p("div",T,"Please select a contract first.")),h(' <v-notice v-if="!!failureReason">\n\t\t\t{{ failureReason }}\n\t\t</v-notice> ')])),_:1})},k.__scopeId="data-v-64969d30",k.__file="src/interface.vue";var I=t({id:"navarch-inv-due-date-setter",name:"Navarch Invoice Due Date Setter",icon:"date_range",description:"For setting invoice due dates for each type of invoice.",component:k,options:null,types:["json"],group:"standard"});export{I as default};
