import{useApi as e,defineInterface as t}from"@directus/extensions-sdk";import{defineComponent as a,ref as l,inject as o,watch as i,resolveComponent as s,resolveDirective as n,openBlock as r,createElementBlock as u,createCommentVNode as d,createVNode as m,createBlock as c,withCtx as v,createElementVNode as y,toDisplayString as f,withDirectives as p,createTextVNode as _,normalizeClass as g,pushScopeId as h,popScopeId as b}from"vue";var w={},A={},N={};let $;Object.defineProperty(N,"__esModule",{value:!0}),N.default=function(){if(!$&&($="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $(I)};const I=new Uint8Array(16);var S={},U={},E={};Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;E.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Object.defineProperty(U,"__esModule",{value:!0}),U.default=void 0;var O,C=(O=E)&&O.__esModule?O:{default:O};var L=function(e){return"string"==typeof e&&C.default.test(e)};U.default=L,Object.defineProperty(S,"__esModule",{value:!0}),S.default=void 0,S.unsafeStringify=M;var D=function(e){return e&&e.__esModule?e:{default:e}}(U);const T=[];for(let e=0;e<256;++e)T.push((e+256).toString(16).slice(1));function M(e,t=0){return(T[e[t+0]]+T[e[t+1]]+T[e[t+2]]+T[e[t+3]]+"-"+T[e[t+4]]+T[e[t+5]]+"-"+T[e[t+6]]+T[e[t+7]]+"-"+T[e[t+8]]+T[e[t+9]]+"-"+T[e[t+10]]+T[e[t+11]]+T[e[t+12]]+T[e[t+13]]+T[e[t+14]]+T[e[t+15]]).toLowerCase()}var k=function(e,t=0){const a=M(e,t);if(!(0,D.default)(a))throw TypeError("Stringified UUID is invalid");return a};S.default=k,Object.defineProperty(A,"__esModule",{value:!0}),A.default=void 0;var V=function(e){return e&&e.__esModule?e:{default:e}}(N),R=S;let x,F,P=0,H=0;var W=function(e,t,a){let l=t&&a||0;const o=t||new Array(16);let i=(e=e||{}).node||x,s=void 0!==e.clockseq?e.clockseq:F;if(null==i||null==s){const t=e.random||(e.rng||V.default)();null==i&&(i=x=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=F=16383&(t[6]<<8|t[7]))}let n=void 0!==e.msecs?e.msecs:Date.now(),r=void 0!==e.nsecs?e.nsecs:H+1;const u=n-P+(r-H)/1e4;if(u<0&&void 0===e.clockseq&&(s=s+1&16383),(u<0||n>P)&&void 0===e.nsecs&&(r=0),r>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");P=n,H=r,F=s,n+=122192928e5;const d=(1e4*(268435455&n)+r)%4294967296;o[l++]=d>>>24&255,o[l++]=d>>>16&255,o[l++]=d>>>8&255,o[l++]=255&d;const m=n/4294967296*1e4&268435455;o[l++]=m>>>8&255,o[l++]=255&m,o[l++]=m>>>24&15|16,o[l++]=m>>>16&255,o[l++]=s>>>8|128,o[l++]=255&s;for(let e=0;e<6;++e)o[l+e]=i[e];return t||(0,R.unsafeStringify)(o)};A.default=W;var B={},q={},j={};Object.defineProperty(j,"__esModule",{value:!0}),j.default=void 0;var J=function(e){return e&&e.__esModule?e:{default:e}}(U);var Y=function(e){if(!(0,J.default)(e))throw TypeError("Invalid UUID");let t;const a=new Uint8Array(16);return a[0]=(t=parseInt(e.slice(0,8),16))>>>24,a[1]=t>>>16&255,a[2]=t>>>8&255,a[3]=255&t,a[4]=(t=parseInt(e.slice(9,13),16))>>>8,a[5]=255&t,a[6]=(t=parseInt(e.slice(14,18),16))>>>8,a[7]=255&t,a[8]=(t=parseInt(e.slice(19,23),16))>>>8,a[9]=255&t,a[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,a[11]=t/4294967296&255,a[12]=t>>>24&255,a[13]=t>>>16&255,a[14]=t>>>8&255,a[15]=255&t,a};j.default=Y,Object.defineProperty(q,"__esModule",{value:!0}),q.URL=q.DNS=void 0,q.default=function(e,t,a){function l(e,l,o,i){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let a=0;a<e.length;++a)t.push(e.charCodeAt(a));return t}(e)),"string"==typeof l&&(l=(0,G.default)(l)),16!==(null===(s=l)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let n=new Uint8Array(16+e.length);if(n.set(l),n.set(e,l.length),n=a(n),n[6]=15&n[6]|t,n[8]=63&n[8]|128,o){i=i||0;for(let e=0;e<16;++e)o[i+e]=n[e];return o}return(0,K.unsafeStringify)(n)}try{l.name=e}catch(e){}return l.DNS=z,l.URL=Q,l};var K=S,G=function(e){return e&&e.__esModule?e:{default:e}}(j);const z="6ba7b810-9dad-11d1-80b4-00c04fd430c8";q.DNS=z;const Q="6ba7b811-9dad-11d1-80b4-00c04fd430c8";q.URL=Q;var X={};function Z(e){return 14+(e+64>>>9<<4)+1}function ee(e,t){const a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function te(e,t,a,l,o,i){return ee((s=ee(ee(t,e),ee(l,i)))<<(n=o)|s>>>32-n,a);var s,n}function ae(e,t,a,l,o,i,s){return te(t&a|~t&l,e,t,o,i,s)}function le(e,t,a,l,o,i,s){return te(t&l|a&~l,e,t,o,i,s)}function oe(e,t,a,l,o,i,s){return te(t^a^l,e,t,o,i,s)}function ie(e,t,a,l,o,i,s){return te(a^(t|~l),e,t,o,i,s)}Object.defineProperty(X,"__esModule",{value:!0}),X.default=void 0;var se=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let a=0;a<t.length;++a)e[a]=t.charCodeAt(a)}return function(e){const t=[],a=32*e.length,l="0123456789abcdef";for(let o=0;o<a;o+=8){const a=e[o>>5]>>>o%32&255,i=parseInt(l.charAt(a>>>4&15)+l.charAt(15&a),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[Z(t)-1]=t;let a=1732584193,l=-271733879,o=-1732584194,i=271733878;for(let t=0;t<e.length;t+=16){const s=a,n=l,r=o,u=i;a=ae(a,l,o,i,e[t],7,-680876936),i=ae(i,a,l,o,e[t+1],12,-389564586),o=ae(o,i,a,l,e[t+2],17,606105819),l=ae(l,o,i,a,e[t+3],22,-1044525330),a=ae(a,l,o,i,e[t+4],7,-176418897),i=ae(i,a,l,o,e[t+5],12,1200080426),o=ae(o,i,a,l,e[t+6],17,-1473231341),l=ae(l,o,i,a,e[t+7],22,-45705983),a=ae(a,l,o,i,e[t+8],7,1770035416),i=ae(i,a,l,o,e[t+9],12,-1958414417),o=ae(o,i,a,l,e[t+10],17,-42063),l=ae(l,o,i,a,e[t+11],22,-1990404162),a=ae(a,l,o,i,e[t+12],7,1804603682),i=ae(i,a,l,o,e[t+13],12,-40341101),o=ae(o,i,a,l,e[t+14],17,-1502002290),l=ae(l,o,i,a,e[t+15],22,1236535329),a=le(a,l,o,i,e[t+1],5,-165796510),i=le(i,a,l,o,e[t+6],9,-1069501632),o=le(o,i,a,l,e[t+11],14,643717713),l=le(l,o,i,a,e[t],20,-373897302),a=le(a,l,o,i,e[t+5],5,-701558691),i=le(i,a,l,o,e[t+10],9,38016083),o=le(o,i,a,l,e[t+15],14,-660478335),l=le(l,o,i,a,e[t+4],20,-405537848),a=le(a,l,o,i,e[t+9],5,568446438),i=le(i,a,l,o,e[t+14],9,-1019803690),o=le(o,i,a,l,e[t+3],14,-187363961),l=le(l,o,i,a,e[t+8],20,1163531501),a=le(a,l,o,i,e[t+13],5,-1444681467),i=le(i,a,l,o,e[t+2],9,-51403784),o=le(o,i,a,l,e[t+7],14,1735328473),l=le(l,o,i,a,e[t+12],20,-1926607734),a=oe(a,l,o,i,e[t+5],4,-378558),i=oe(i,a,l,o,e[t+8],11,-2022574463),o=oe(o,i,a,l,e[t+11],16,1839030562),l=oe(l,o,i,a,e[t+14],23,-35309556),a=oe(a,l,o,i,e[t+1],4,-1530992060),i=oe(i,a,l,o,e[t+4],11,1272893353),o=oe(o,i,a,l,e[t+7],16,-155497632),l=oe(l,o,i,a,e[t+10],23,-1094730640),a=oe(a,l,o,i,e[t+13],4,681279174),i=oe(i,a,l,o,e[t],11,-358537222),o=oe(o,i,a,l,e[t+3],16,-722521979),l=oe(l,o,i,a,e[t+6],23,76029189),a=oe(a,l,o,i,e[t+9],4,-640364487),i=oe(i,a,l,o,e[t+12],11,-421815835),o=oe(o,i,a,l,e[t+15],16,530742520),l=oe(l,o,i,a,e[t+2],23,-995338651),a=ie(a,l,o,i,e[t],6,-198630844),i=ie(i,a,l,o,e[t+7],10,1126891415),o=ie(o,i,a,l,e[t+14],15,-1416354905),l=ie(l,o,i,a,e[t+5],21,-57434055),a=ie(a,l,o,i,e[t+12],6,1700485571),i=ie(i,a,l,o,e[t+3],10,-1894986606),o=ie(o,i,a,l,e[t+10],15,-1051523),l=ie(l,o,i,a,e[t+1],21,-2054922799),a=ie(a,l,o,i,e[t+8],6,1873313359),i=ie(i,a,l,o,e[t+15],10,-30611744),o=ie(o,i,a,l,e[t+6],15,-1560198380),l=ie(l,o,i,a,e[t+13],21,1309151649),a=ie(a,l,o,i,e[t+4],6,-145523070),i=ie(i,a,l,o,e[t+11],10,-1120210379),o=ie(o,i,a,l,e[t+2],15,718787259),l=ie(l,o,i,a,e[t+9],21,-343485551),a=ee(a,s),l=ee(l,n),o=ee(o,r),i=ee(i,u)}return[a,l,o,i]}(function(e){if(0===e.length)return[];const t=8*e.length,a=new Uint32Array(Z(t));for(let l=0;l<t;l+=8)a[l>>5]|=(255&e[l/8])<<l%32;return a}(e),8*e.length))};X.default=se,Object.defineProperty(B,"__esModule",{value:!0}),B.default=void 0;var ne=ue(q),re=ue(X);function ue(e){return e&&e.__esModule?e:{default:e}}var de=(0,ne.default)("v3",48,re.default);B.default=de;var me={},ce={};Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=void 0;var ve={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};ce.default=ve,Object.defineProperty(me,"__esModule",{value:!0}),me.default=void 0;var ye=_e(ce),fe=_e(N),pe=S;function _e(e){return e&&e.__esModule?e:{default:e}}var ge=function(e,t,a){if(ye.default.randomUUID&&!t&&!e)return ye.default.randomUUID();const l=(e=e||{}).random||(e.rng||fe.default)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t){a=a||0;for(let e=0;e<16;++e)t[a+e]=l[e];return t}return(0,pe.unsafeStringify)(l)};me.default=ge;var he={},be={};function we(e,t,a,l){switch(e){case 0:return t&a^~t&l;case 1:case 3:return t^a^l;case 2:return t&a^t&l^a&l}}function Ae(e,t){return e<<t|e>>>32-t}Object.defineProperty(be,"__esModule",{value:!0}),be.default=void 0;var Ne=function(e){const t=[1518500249,1859775393,2400959708,3395469782],a=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let a=0;a<t.length;++a)e.push(t.charCodeAt(a))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const l=e.length/4+2,o=Math.ceil(l/16),i=new Array(o);for(let t=0;t<o;++t){const a=new Uint32Array(16);for(let l=0;l<16;++l)a[l]=e[64*t+4*l]<<24|e[64*t+4*l+1]<<16|e[64*t+4*l+2]<<8|e[64*t+4*l+3];i[t]=a}i[o-1][14]=8*(e.length-1)/Math.pow(2,32),i[o-1][14]=Math.floor(i[o-1][14]),i[o-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<o;++e){const l=new Uint32Array(80);for(let t=0;t<16;++t)l[t]=i[e][t];for(let e=16;e<80;++e)l[e]=Ae(l[e-3]^l[e-8]^l[e-14]^l[e-16],1);let o=a[0],s=a[1],n=a[2],r=a[3],u=a[4];for(let e=0;e<80;++e){const a=Math.floor(e/20),i=Ae(o,5)+we(a,s,n,r)+u+t[a]+l[e]>>>0;u=r,r=n,n=Ae(s,30)>>>0,s=o,o=i}a[0]=a[0]+o>>>0,a[1]=a[1]+s>>>0,a[2]=a[2]+n>>>0,a[3]=a[3]+r>>>0,a[4]=a[4]+u>>>0}return[a[0]>>24&255,a[0]>>16&255,a[0]>>8&255,255&a[0],a[1]>>24&255,a[1]>>16&255,a[1]>>8&255,255&a[1],a[2]>>24&255,a[2]>>16&255,a[2]>>8&255,255&a[2],a[3]>>24&255,a[3]>>16&255,a[3]>>8&255,255&a[3],a[4]>>24&255,a[4]>>16&255,a[4]>>8&255,255&a[4]]};be.default=Ne,Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var $e=Se(q),Ie=Se(be);function Se(e){return e&&e.__esModule?e:{default:e}}var Ue=(0,$e.default)("v5",80,Ie.default);he.default=Ue;var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.default=void 0;Ee.default="00000000-0000-0000-0000-000000000000";var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.default=void 0;var Ce=function(e){return e&&e.__esModule?e:{default:e}}(U);var Le,De,Te,Me,ke=function(e){if(!(0,Ce.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};Oe.default=ke,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.default}});var t=d(A),a=d(B),l=d(me),o=d(he),i=d(Ee),s=d(Oe),n=d(U),r=d(S),u=d(j);function d(e){return e&&e.__esModule?e:{default:e}}}(w),function(e){e.INTURN="Inturn",e.INTURN_FINAL="Inturn Final",e.OUTTURN="Outturn",e.ESTIMATED="Estimated",e.PLANNED="Planned"}(Le||(Le={})),function(e){e.SELLER="Seller",e.BUYER="Buyer",e.SPLIT="Split"}(De||(De={})),function(e){e.AVG_WITH_MIDDLE_ASSAY_AS_FINAL_FOR_ARBITRATION="AVG_WITH_MIDDLE_ASSAY_AS_FINAL_FOR_ARBITRATION",e.AVG_WITH_AVG_OF_UMPIRE_AND_CLOSEST_AS_FINAL_FOR_ARBITRATION="AVG_WITH_AVG_OF_UMPIRE_AND_CLOSEST_AS_FINAL_FOR_ARBITRATION",e.AVG_OF_UMPIRE_AND_CLOSEST_IF_UMPIRE_IN_BETWEEN_OR_MIDDLE_AS_FINAL_IF_UMPIRE_OUTSIDE="AVG_OF_UMPIRE_AND_CLOSEST_IF_UMPIRE_IN_BETWEEN_OR_MIDDLE_AS_FINAL_IF_UMPIRE_OUTSIDE"}(Te||(Te={})),function(e){e[e.DRY_WEIGHT=0]="DRY_WEIGHT",e[e.DRY_WEIGHT_UOM=1]="DRY_WEIGHT_UOM",e[e.SELLER_ASSAY=2]="SELLER_ASSAY",e[e.BUYER_ASSAY=3]="BUYER_ASSAY",e[e.DIFFERENCE=4]="DIFFERENCE",e[e.SPLITTING_LIMIT=5]="SPLITTING_LIMIT",e[e.TO_UMPIRE=6]="TO_UMPIRE",e[e.UMPIRE_NAME=7]="UMPIRE_NAME",e[e.UMPIRE_ASSAY=8]="UMPIRE_ASSAY",e[e.LOSING_PARTY=9]="LOSING_PARTY",e[e.FINAL_ASSAY=10]="FINAL_ASSAY"}(Me||(Me={}));var Ve=a({props:{value:{type:String,default:null}},emits:["input"],setup(t,{attrs:a,emit:s}){const n=l([{text:"Commodity",value:"commodity_name",sortable:!1,width:150,align:"left"},{text:"Seller Assay",value:"seller_assay",sortable:!1,width:150,align:"left"},{text:"Buyer Assay",value:"buyer_assay",sortable:!1,width:150,align:"left"},{text:"Difference",value:"difference",sortable:!1,width:150,align:"left"},{text:"Splitting Limit",value:"splitting_limit",sortable:!1,width:150,align:"left"},{text:"To Umpire",value:"to_umpire",sortable:!1,width:60,align:"left"},{text:"Umpire Name",value:"umpire_name",sortable:!1,width:150,align:"left"},{text:"Umpire Assay",value:"umpire_assay",sortable:!1,width:150,align:"left"},{text:"Losing Party",value:"losing_party",sortable:!1,width:150,align:"left"},{text:"Final Assay",value:"final_assay",sortable:!1,width:150,align:"left"}]),r=l([{text:"To Delete",value:"delete",sortable:!1,width:60,align:"left"},{text:"Lot",value:"lot_number",sortable:!1,width:60,align:"left"},{text:"Dry Weight",value:"dry_weight",sortable:!1,width:150,align:"left"},{text:"Seller Assay",value:"seller_assay",sortable:!1,width:150,align:"left"},{text:"Buyer Assay",value:"buyer_assay",sortable:!1,width:150,align:"left"},{text:"Difference",value:"difference",sortable:!1,width:150,align:"left"},{text:"To Umpire",value:"to_umpire",sortable:!1,width:60,align:"center"},{text:"Umpire Name",value:"umpire_name",sortable:!1,width:150,align:"left"},{text:"Umpire Assay",value:"umpire_assay",sortable:!1,width:150,align:"left"},{text:"Losing Party",value:"losing_party",sortable:!1,width:150,align:"left"},{text:"Final Assay",value:"final_assay",sortable:!1,width:150,align:"left"}]),u=l(null),d=l([]),m=e(),c="navarch_unit",v="symbol",y="dry_symbol",f="navarch_assay_unit",p="description",_="unit",g="navarch_assay_lot",h="navarch_weight_lot",b="id",A="lot_number",N="dry_weight",$="method",I="navarch_contract",S="weight_uom",U="umpire_when_equal",E="final_assay_equation",O="methods",C="navarch_commodity_in_contract",L="commodity",D="primary_commodity",T="splitting_limit",M="splitting_limit_unit",k="navarch_commodity",V="name",R="code",x="related_parcel",F="contract",P="INVALID_ID",H="-- Deselect method --",W="-- Select a method --",B="assay_results",q=l([]),j=l([]),J=l(!0),Y=l([]),K=l(!0),G=l([]),z=l(!0),Q=l([]),X=l(!0),Z=l([]),ee=l(!0),te=l(!0),ae=l(!1),le=l(-1),oe=l([]),ie=l([]),se=l({}),ne=l([]),re=l([]),ue=l(void 0),de=l(void 0),me=l(void 0),ce=l(void 0),ve=l(void 0),ye=l(!1),fe=l(void 0),pe=l(void 0),_e=l(void 0),ge=l(void 0),he=l(void 0),be=l(void 0),we=l(void 0),Ae=l(void 0),Ne=l(!u.value),$e=l(!1),Ie=l(null),Se=l(!1),Ue=l(null),Ee=o("values",l({}));let Oe=Ee.value[B];Oe||(Oe=w.v4(),console.log(`[setup] key generated for assay lots=${Oe}`));const Ce=l(void 0),Me=l([]);(async function(){return(await Re(c,[v])).map((e=>({text:e[v],value:e[v]})))})().then((e=>{Me.value=e}));const ke=l([]);(async function(){return(await Re(f,[p,_])).map((e=>({text:`${e[p]} - ${e[_]}`,value:e[_]})))})().then((e=>{ke.value=e}));const Ve=l({});async function Re(e,t){return(await m.get(`/items/${e}`,{params:{fields:t}})).data.data}async function xe(){if(console.log(`weight lots for parcel id: ${Ee.value.id} in form values: ${JSON.stringify(Ee.value)}`),Ee.value.id)try{const e=await m.get(`/items/${h}?filter[${x}]=${Ee.value.id}&filter[${A}][_nnull]=true&sort[]=${A}`,{params:{fields:[b,A,N,$]}});console.log(`weight lots successfully fetched in assay results interface: ${JSON.stringify(e.data.data)}`),d.value=e.data.data}catch(e){console.log(`fetching the weight lots went wrong due to: ${e}`)}}function Fe(e){if(!e)throw new Error("Commodity in contract is empty");if(!e[L])throw new Error("Commodity in contract field 'Commodity' is empty for one of the commodities, please ensure all commodities data in the contract is set");if(!e[T]||isNaN(Number(e[T])))throw new Error("Commodity in contract field 'Splitting Limit' is empty or has an invalid value, please ensure all commodities data in the contract is set");if(!e[M])throw new Error("Commodity in contract field 'Assay UOM' is empty, please ensure all commodities data in the contract is set")}function Pe(e,t){if(!e)throw new Error(`Commodity data is empty for commodity ${t}, please contact Navarch for assistance`);if(!e[V])throw new Error(`Commodity field 'Name'is empty for commodity ${t}, please contact Navarch for assistance`);if(!e[R])throw new Error(`Commodity field 'Code' is empty for commodity ${t}, please contact Navarch for assistance`)}m.get(`/items/${g}?filter[foreign_key]=${Oe}&sort[]=lot_number`).then((async e=>{console.log(`assay lots successfully fetched: ${JSON.stringify(e.data.data)}`);const t=e.data.data.map((e=>e.commodity)).filter(((e,t,a)=>a.indexOf(e)===t));if(t.length>0){const e=t.map(((e,t)=>`filter[_or][${t}][code]=${e}`)).join("&"),a=await m.get(`/items/${k}?${e}`,{params:{fields:["name","code"]}});console.log(`commodity mapping response: ${JSON.stringify(a.data.data)}`),Ve.value=a.data.data.reduce(((e,t)=>(e[t.code]=t.name,e)),{}),console.log(`commodity code to name mapping: ${JSON.stringify(Ve.value)}`)}q.value=Qe(e.data.data,Ve.value),console.log(`evaluated assays: ${JSON.stringify(q.value)}`)})).catch((e=>console.log(`fetching the assay lots went wrong due to: ${e}`))),i((()=>Ee.value.id),(async e=>{e&&(console.log(`[setup assay lots] weight lots foreign key watcher: ${e}`),await xe())}),{immediate:!0}),i((()=>Ee.value[F]),(async e=>{await async function(e){if(!e)return u.value=null,void console.log(`contract data cleared in assay results interface; contractData: ${JSON.stringify(u.value)}`);try{const t=await m.get(`/items/${I}/${e}`,{params:{fields:[S,U,E,O]}});console.log(`contract data successfully fetched in assay results interface: ${JSON.stringify(t.data.data)}`);const a=t.data.data;!function(e){if(!e)throw new Error("Contract data response is empty, please ensure the selected contract for this parcel still exists");if(!e[S])throw new Error("Contract field 'Weight UOM' is empty");if(!e[O])throw new Error("Contract field 'Methods' is empty");if(void 0===e[U]||null===e[U]||"boolean"!=typeof e[U])throw new Error(`Contract field 'Allow Split Option' is empty or has an invalid value of ${e[U]}`);if(!e[E]||!Object.values(Te).includes(e[E]))throw new Error(`Contract field 'Final Assay Method' is empty or has an invalid value of ${e[E]}`)}(a);const l=await m.get(`/items/${c}/${a[S]}`,{params:{fields:[y]}});!function(e){if(!e)throw new Error("Weight uom response is empty, please ensure a valid weight UOM has been selected in the contract");if(!e[y])throw new Error(`Contract field 'Weight UOM' may have an invalid 'Dry Symbol' field value of ${e[y]}, please ensure a valid UOM with a proper Dry Symbol is selected`)}(l.data.data);const o=await m.get(`/items/${C}?filter[${F}]=${e}`,{params:{fields:[L,D,T,M]}});console.log(`[getContractData] commodity in contract response: ${JSON.stringify(o.data.data)}`),function(e){if(!e||!Array.isArray(e))throw console.error(`Commodities in contract data response=${JSON.stringify(e)} is null or not of type array`),new Error("Commodities in contract is either empty or not a list");for(const t of e)Fe(t)}(o.data.data);const i=[];for(const e of o.data.data){const t=await m.get(`/items/${k}/${e.commodity}`,{params:{fields:[V,R]}});Pe(t.data.data,e.commodity);const a={name:t.data.data[V],code:t.data.data[R],isPrimaryCommodity:e[D],splittingLimit:e[T],splittingLimitUOM:e[M]};i.push(a)}u.value={commodities:null!=i?i:[],dryWeightUOM:l.data.data[y],methods:a[O],umpires:[],umpireArbitrationWhenSLEqualsDiff:a[U],finalAssayEquation:a[E]},console.log(`contract data: ${JSON.stringify(u.value)}`)}catch(e){Ie.value=`Contract data could not be fetched due to: ${e.message}`,console.error(`fetching the contract data went wrong due to: ${e}`)}}(e),function(){if(console.log("[assignMethodSelectionRef]"),!u.value)return console.error("contract data is not defined"),void(_t.value=[]);const e={text:W,value:void 0};console.log(`[assignMethodSelectionRef] contractData=${JSON.stringify(u.value)}`),_t.value=[e,...u.value[O].map((e=>({text:e,value:e})))],console.log(`[assignMethodSelectionRef] allMethodSelection=${JSON.stringify(_t.value)}`),gt.value=[..._t.value]}(),Ie.value=null}),{immediate:!0}),i((()=>Ee.value.parcel_finalised),(async e=>{console.log(`[setup assay lots] change in parcel finalised field in the parcel form detected with a new value=${e}`),e?(Ie.value="Cannot edit assay lot data to a finalised parcel",$e.value=!0):(Ie.value=null,$e.value=!1)}),{immediate:!0});const He=l(!1);function We(){console.log("[addNewAssayLot]");const e=w.v4(),t={id:e,foreign_key:Oe,lot_number:oe.value.length+1,commodity:me.value,method:de.value};console.log(`[addNewAssayLot] Adding new lot ${t} with generated id=${e}`),oe.value.push(t),ne.value.push(e),console.log(`[addNewAssayLot] Adding new row to assay lots and now has ${oe.value.length} rows`)}async function Be(e,t){if(t.assay_uom||t.dry_weight_uom||void 0!==t.splitting_limit)try{const a=oe.value.map((e=>e.id)).filter((e=>void 0!==e)),l=await async function(e,t,a){if(!a.assay_uom&&!a.dry_weight_uom&&void 0===a.splitting_limit)return void console.log("Properties to batch update are undefined, there are no properties to update");try{m.patch(`/items/${e}?sort[]=lot_number`,{keys:t,data:a}).then((e=>(console.log("[batchUpdateAssays] batch update of assays success"),e.data.data)))}catch(e){console.error(`[batchUpdateAssays] batch update of assays with foreign_key=${Oe} failed with reason: '${e}'`)}}(e,a,t);console.log("batch update of lots success"),oe.value=l,q.value[le.value].lots=oe.value}catch(e){console.log(`batch update of lots with foreign_key=${Oe} failed with reason: '${e}'`)}else console.log("Properties to batch update are undefined, there are no properties to update")}async function qe(e,t){if(console.log("[createAssayLots]"),0==t.length)return console.log("[createAssayLots] no new lot items to be created"),0;try{const a=await m.post(`/items/${e}?sort[]=lot_number`,t);console.log(`[createAssayLots] Item successfully created with response=${JSON.stringify(a.data.data)} to be updated to display assays=${JSON.stringify(oe.value)}`);for(const e of a.data.data){const t=oe.value.findIndex((t=>t.id===e.id));console.log(`[createAssayLots] Item with id=${e.id} has been created to local assay lot array with index=${t}`),oe.value[t]=e}return oe.value.length}catch(e){return console.log(`[createAssayLots] creation of lots with foreign_key=${Oe} failed with reason: '${e}'`),-1}}async function je(e,t){try{const a=await m.post(`/items/${e}`,t);console.log(`[createComposite] Composite item successfully created with response=${JSON.stringify(a.data.data)}`);const l=Xe(a.data.data,Ve.value);null!==l?(console.log(`[createComposite] Assays before adding new one=${q.value}`),q.value.push(l),console.log(`[createComposite] Assay calculated and set to=${JSON.stringify(l)} in ${JSON.stringify(q.value)}}`)):console.log(`[createComposite] Assay could not be calculated for newly created composite item with foreign_key=${t.foreign_key} and id=${a.data.data.id}`)}catch(e){console.log(`[createComposite] creation of composite item with foreign_key=${t.foreign_key} failed with reason: '${e}'`)}}async function Je(e,t){if(0!=t.length)try{const a=await m.delete(`/items/${e}`,{data:t});if(204!==a.status)throw new Error(`response status=${a.status} is not 204`);console.log(`Item successfully deleted with response status=${a.status}`);const l=oe.value.filter((e=>{var a;return!t.includes(null!==(a=e.id)&&void 0!==a?a:"INVALID_ID")}));console.log(`remaining assay lots by ids=${JSON.stringify(l)} vs data=${JSON.stringify(t)}`);const o=l.map(((e,t)=>({id:e.id,lot_number:t+1}))),i=await m.patch(`/items/${g}?sort[]=lot_number`,o);oe.value=i.data.data}catch(e){console.log(`deletion of lots with ids=${t} failed with reason: '${e}'`)}else console.log("no lot items to be deleted")}async function Ye(e){if(console.log("[saveAssayLots]"),-1===le.value||void 0===q.value[le.value])return void console.error("[saveAssayLots] No assay selected. This method should only be called when an assay is selected. Aborting save operation.");if(Ge(),console.log("[saveAssayLots] synced staged changes"),0!==ne.value.length){const t=oe.value.filter((e=>{var t;return ne.value.includes(null!==(t=e.id)&&void 0!==t?t:P)})).map((e=>({...e,assay_uom:ce.value,dry_weight_uom:Ce.value,splitting_limit:ve.value})));console.log(`[saveAssayLots] Creating new lots; ${t.length} number of lots to be created`),await qe(e,t)}let t=!1;ce.value!==q.value[le.value].assay_uom&&(console.log("[saveAssayLots] batch update required for assay_uom"),t=!0,se.value.assay_uom=ce.value),Ce.value!==q.value[le.value].dry_weight_uom&&(console.log("[saveAssayLots] batch update required for dry_weight_uom"),t=!0,se.value.dry_weight_uom=Ce.value),ve.value!==q.value[le.value].splitting_limit&&(console.log("[saveAssayLots] batch update required for splitting_limit"),t=!0,se.value.splitting_limit=ve.value),t&&(console.log("[saveAssayLots] batch update required with properties: ",se.value),await Be(e,se.value)),0!==ie.value.length&&await async function(){if(-1===le.value)return void console.log("no assay selected, aborting update");if(0===ie.value.length)return;const e=ie.value.map((e=>oe.value.find((t=>t.id===e))));console.log(`updating lots=${JSON.stringify(e)}`);try{if(!it(q.value[le.value])){const t=await m.patch(`/items/${g}`,e);console.log(`lot data successfully patched with response id='${t.data.data.id}'`);for(const e of t.data.data){const t=oe.value.findIndex((t=>t.id===e.id));oe.value[t]=e}q.value[le.value].lots=oe.value}}catch(e){console.log(`patching for lots=${JSON.stringify(ie.value)} failed with reason: '${e}'`)}}(),await Je(e,re.value),q.value[le.value].lots=oe.value,console.log(`[saveAssayLots] display assays=${JSON.stringify(oe.value)} vs assay lots=${JSON.stringify(q.value[le.value].lots)}`);const a=Qe(q.value[le.value].lots,Ve.value);a.length<=0?(console.log("[saveAssayLots] evaluated assay lot data is empty, removing assay from assays list"),q.value.splice(le.value,1)):(console.log(`[saveAssayLots] evaluated assay lot data is ${JSON.stringify(a[0])}`),q.value[le.value]=a[0])}async function Ke(){if(console.log("[save]"),He.value){if(me.value&&de.value&&te.value){const e={foreign_key:Oe,dry_weight:pe.value,dry_weight_uom:Ce.value,assay_uom:ce.value,seller_assay:_e.value,buyer_assay:ge.value,difference:he.value,splitting_limit:ve.value,to_umpire:ye.value,umpire_name:fe.value,umpire_assay:we.value,losing_party:Ae.value,final_assay:be.value,commodity:me.value,method:de.value};e.id=w.v4(),await je(g,e),void 0!==Ee.value[B]&&null!==Ee.value[B]||(console.log(`[save] emitting input event with assay lot foreign_key=${Oe}`),s("input",Oe))}else me.value&&de.value?(await async function(){if(console.log("[createAssayLotsOnAddNewAssay]"),Ge(),0!==ne.value.length){const e=oe.value.filter((e=>{var t;return ne.value.includes(null!==(t=e.id)&&void 0!==t?t:P)})).map((e=>({...e,assay_uom:ce.value,dry_weight_uom:Ce.value,splitting_limit:ve.value})));console.log(`[createAssayLotsOnAddNewAssay] Creating new lots; ${e.length} number of lots to be created`);const t=await qe(g,e);if(-1!==t&&0!==t){const e=Qe(oe.value,Ve.value);e.length>0&&q.value.push(e[0])}}console.log("[createAssayLotsOnAddNewAssay] done")}(),void 0!==Ee.value[B]&&null!==Ee.value[B]||(console.log(`[save] emitting input event with assay lot foreign_key=${Oe}`),s("input",Oe))):console.error("[save] No commodity or method selected. Nothing else to save. This should not occur when adding a new assay");pt()}else{if(-1===le.value)return console.log("[save] No assay selected. Nothing else to save"),void pt();if(it(q.value[le.value])||te.value){if(it(q.value[le.value])&&te.value){if(console.log("asdf saving composite as composite"),me.value&&de.value){console.log("asdf final assay="+be.value);const e={foreign_key:Oe,dry_weight:pe.value,dry_weight_uom:Ce.value,assay_uom:ce.value,seller_assay:_e.value,buyer_assay:ge.value,difference:he.value,splitting_limit:ve.value,to_umpire:ye.value,umpire_name:fe.value,umpire_assay:we.value,losing_party:Ae.value,final_assay:be.value,commodity:me.value,method:de.value};e.id=ue.value,await async function(e,t){const{id:a,foreign_key:l,...o}=t;try{const l=await m.patch(`/items/${e}/${a}`,o);console.log(`composite lot data successfully patched with response id='${l.data.data.id}'`),q.value[le.value].composite=l.data.data;const i=Xe(q.value[le.value].composite,Ve.value);null!==i?(q.value[le.value]=i,console.log(`Assay recalculated and set to=${JSON.stringify(q.value[le.value])}`)):console.log(`Assay could not be recalculated for the composite item with foreign_key=${t.foreign_key} and id=${l.data.data.id}`)}catch(e){console.log(`patching for composite lot=${a} with foreign_key=${l} failed with reason: '${e}'`)}}(g,e)}}else if(it(q.value[le.value])&&!te.value)await Ye(g);else if(!it(q.value[le.value])&&te.value){if(me.value&&de.value){const e={foreign_key:Oe,dry_weight:pe.value,dry_weight_uom:Ce.value,assay_uom:ce.value,seller_assay:_e.value,buyer_assay:ge.value,difference:he.value,splitting_limit:ve.value,to_umpire:ye.value,umpire_name:fe.value,umpire_assay:we.value,losing_party:Ae.value,final_assay:be.value,commodity:me.value,method:de.value};e.id=w.v4(),await je(g,e)}await Je(g,oe.value.map((e=>e.id)).filter((e=>void 0!==e)))}}else await Ye(g);pt(),console.log("[save] done")}}function Ge(){ne.value.forEach((e=>{const t=ie.value.findIndex((t=>t===e));-1!==t&&ie.value.splice(t,1)})),re.value.forEach((e=>{const t=ne.value.findIndex((t=>t===e));-1!==t&&ne.value.splice(t,1)})),re.value.forEach((e=>{const t=ie.value.findIndex((t=>t===e));-1!==t&&ie.value.splice(t,1)}))}function ze(e){return null==e}function Qe(e,t){const a=[];if(!e)return a;const l=function(e){const t={Planned:{},Estimated:{},Inturn:{},"Inturn Final":{},Outturn:{}};return e.forEach((e=>{var a;t[e.method]||(t[e.method]={}),t[e.method][e.commodity]?null===(a=t[e.method][e.commodity])||void 0===a||a.push(e):t[e.method][e.commodity]=[e]})),[...Object.values(t.Planned),...Object.values(t.Estimated),...Object.values(t.Inturn),...Object.values(t["Inturn Final"]),...Object.values(t.Outturn)]}(e);let o=null;for(const e of l)o=1!==e.length||ot(e[0])?Ze(e,t):Xe(e[0],t),null!=o&&a.push(o);return a}function Xe(e,t){var a,l,o;if(!e)return null;console.log(`[evaluateAssayDataForComposite] commodity name=${t[e.commodity]} for commodity=${e.commodity}`);return{assay_id:lt(e),method:e.method,commodity:e.commodity,commodity_name:null!==(a=t[e.commodity])&&void 0!==a?a:e.commodity,assay_uom:e.assay_uom,dry_weight_uom:e.dry_weight_uom,seller_assay:e.seller_assay,buyer_assay:e.buyer_assay,difference:e.difference,splitting_limit:e.splitting_limit,to_umpire:e.to_umpire,umpire_name:e.umpire_name,umpire_assay:e.umpire_assay,losing_party:e.losing_party,final_assay:e.final_assay,total_dry_weight:null!==(l=e.dry_weight)&&void 0!==l?l:0,total_arbitrated_dry_weight:e.to_umpire&&null!==(o=e.dry_weight)&&void 0!==o?o:0,composite:e,lots:[]}}function Ze(e,t){var a;if(!e)return null;const l=e.find((e=>!("lot_number"in e))),o=e.filter(ot).filter((e=>!(null==e)));if(0===o.length)return null;const i=o[0];console.log(`[evaluateAssayDataForLots] commodity name=${t[i.commodity]} for commodity=${i.commodity}`);let s={assay_id:lt(i),dry_weight_uom:i.dry_weight_uom,method:i.method,commodity:i.commodity,commodity_name:null!==(a=t[i.commodity])&&void 0!==a?a:i.commodity,assay_uom:i.assay_uom,seller_assay:0,buyer_assay:0,difference:0,splitting_limit:i.splitting_limit,final_assay:0,to_umpire:!1,total_dry_weight:0,total_arbitrated_dry_weight:0,composite:l,lots:o};o.forEach((e=>{s.buyer_assay=et(s.buyer_assay)+et(e.buyer_assay)*et(e.dry_weight),s.difference=et(s.difference)+et(e.difference)*et(e.dry_weight),s.final_assay=et(s.final_assay)+et(e.final_assay)*et(e.dry_weight),s.seller_assay=et(s.seller_assay)+et(e.seller_assay)*et(e.dry_weight),s.to_umpire=at(s.to_umpire)||at(e.to_umpire),e.to_umpire&&(s.umpire_assay=et(s.umpire_assay)+et(e.umpire_assay)*et(e.dry_weight),s.total_arbitrated_dry_weight+=et(e.dry_weight)),s.total_dry_weight+=et(e.dry_weight)})),s.buyer_assay=et(s.buyer_assay)/s.total_dry_weight,s.seller_assay=et(s.seller_assay)/s.total_dry_weight,s.to_umpire&&(s.umpire_assay=et(s.umpire_assay)/s.total_arbitrated_dry_weight),s.final_assay=et(s.final_assay)/s.total_dry_weight,s.difference=et(s.difference)/s.total_dry_weight;const n=o.filter((e=>e.losing_party===De.BUYER)).length,r=o.filter((e=>e.losing_party===De.SELLER)).length;return 0===r&&0===n||(s.losing_party=r>n?De.SELLER:r<n?De.BUYER:De.SPLIT),s}function et(e,t=0){return null==e||isNaN(e)?t:parseFloat(e)}function tt(e,t=0){return null==e||isNaN(e)?t:parseFloat(e)}function at(e,t){return null==e?null!=t&&t:e}function lt(e){return`${e.method}-${e.commodity}-${Oe}`}function ot(e){return!!e&&!(!("lot_number"in e)||!e.lot_number)}function it(e){return!e||!e.lots||0===e.lots.length}function st(e,t){if(e&&t)return dt(e-t)}function nt(e,t,a){return!(!a||Math.abs(e)!==t)||Math.abs(e)>t}function rt(e,t,a){if(ze(a)||isNaN(a)||ze(e)||isNaN(e)||ze(t)||isNaN(t))return;const l=Math.abs(e-a),o=Math.abs(t-a);return l>o?De.SELLER:o>l?De.BUYER:De.SPLIT}function ut(e,t,a,l,o,i){let s=tt(e,null),n=tt(t,null),r=tt(a,null);if(!ze(s)&&!isNaN(s)&&ze(n))return s;if(ze(s)&&!ze(n)&&!isNaN(n))return n;if(!ze(s)||!ze(n)){if(!(ze(s)||isNaN(s)||ze(n)||isNaN(n)||l))return console.log(`[evaluateFinalAssay] Umpire arbitration not required, getting average of Seller assay=${s} and Buyer assay=${n}`),dt((s+n)/2);if(!ze(s)&&!isNaN(s)&&!ze(n)&&!isNaN(n)&&l){if(console.log(`[evaluateFinalAssay] Umpire arbitration required, getting average of Seller assay=${s}, Buyer assay=${n} and Umpire assay=${r}`),ze(r)||isNaN(r))return console.log(`[evaluateFinalAssay] Umpire assay is not provided, calculating final assay with seller assay=${s} and buyer assay=${n}`),(s+n)/2;if(i===Te.AVG_WITH_MIDDLE_ASSAY_AS_FINAL_FOR_ARBITRATION)return dt([r,s,n].sort(((e,t)=>e-t))[1]);if(i===Te.AVG_WITH_AVG_OF_UMPIRE_AND_CLOSEST_AS_FINAL_FOR_ARBITRATION||i===Te.AVG_OF_UMPIRE_AND_CLOSEST_IF_UMPIRE_IN_BETWEEN_OR_MIDDLE_AS_FINAL_IF_UMPIRE_OUTSIDE){if(Te.AVG_OF_UMPIRE_AND_CLOSEST_IF_UMPIRE_IN_BETWEEN_OR_MIDDLE_AS_FINAL_IF_UMPIRE_OUTSIDE&&(r<s&&r<n||r>s&&r>n))return dt([r,s,n].sort(((e,t)=>e-t))[1]);if(void 0===o&&(o=rt(s,n,r)),o===De.SPLIT)return dt([r,s,n].sort(((e,t)=>e-t))[1]);if(o===De.SELLER)return dt((r+n)/2);if(o===De.BUYER)return dt((r+s)/2)}}console.log("[evaluateFinalAssay] No final assay calculated, returning undefined")}}function dt(e,t=4){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}async function mt(){if(console.log("[onCompositeToggle]"),!te.value&&-1!==le.value&&it(q.value[le.value])){if(console.log("[onCompositeToggle] converting previously saved composite assay to assay lots"),!q.value[le.value])return void console.error(`[onCompositeToggle] invalid assay, selected assay index=${le.value} should not have empty assay lots}`);wt.value=[q.value[le.value]];const e=q.value[le.value].method;await xe();const t=d.value.filter((t=>t.method===e.toString())).sort(((e,t)=>e.lot_number-t.lot_number)).map((e=>({weight:e.dry_weight,id:e.id})));for(const e of t)We(),oe.value[oe.value.length-1].weight_lot_id=e.id,oe.value[oe.value.length-1].dry_weight=parseFloat(e.weight),oe.value[oe.value.length-1].dry_weight_uom=Ce.value,oe.value[oe.value.length-1].splitting_limit=ve.value,oe.value[oe.value.length-1].assay_uom=ce.value;console.log("[onCompositeToggle] assayLotsToDisplay: ",oe.value)}else if(He.value&&!te.value&&de.value&&Ce.value&&ce.value&&ve.value){console.log("[onCompositeToggle] converting new assay to assay lots");const e=de.value;await xe();const t=d.value.filter((t=>t.method===e.toString())).sort(((e,t)=>e.lot_number-t.lot_number)).map((e=>({weight:e.dry_weight,id:e.id})));for(const e of t)We(),oe.value[oe.value.length-1].weight_lot_id=e.id,oe.value[oe.value.length-1].dry_weight=parseFloat(e.weight),oe.value[oe.value.length-1].dry_weight_uom=Ce.value,oe.value[oe.value.length-1].splitting_limit=ve.value,oe.value[oe.value.length-1].assay_uom=ce.value;console.log("[onCompositeToggle] assayLotsToDisplay: ",oe.value)}else He&&te.value&&(console.log("[clearNewAssayLots]"),oe.value=[],ne.value=[])}let ct;const vt=7;let yt;const ft=l(!1);function pt(){console.log(`Toggle drawer: ${ft.value} -> ${!ft.value}`),ft.value=!ft.value,ft.value||(oe.value=[],ie.value=[],ne.value=[],re.value=[],wt.value=[],le.value=-1,He.value=!1,ue.value=void 0,pe.value=void 0,Ce.value=void 0,ce.value=void 0,_e.value=void 0,ge.value=void 0,he.value=void 0,ve.value=void 0,ye.value=!1,fe.value=void 0,we.value=void 0,Ae.value=void 0,console.log("asdf 2"),be.value=void 0,me.value=void 0,de.value=void 0,te.value=!0,Ue.value=null)}const _t=l([]),gt=l([]),ht=l(u.value?[{text:"-- Select an commodity --",value:void 0},...u.value.commodities.map((e=>({text:`${e.name} (${e.code})`,value:e.code})))]:[]),bt=l([...ht.value]);i(u,(e=>{Ne.value=!e,e&&(ht.value=[{text:"-- Select an commodity --",value:void 0},...e.commodities.map((e=>({text:`${e.name} (${e.code})`,value:e.code})))],bt.value=[...ht.value])}),{immediate:!0});const wt=l([]),At=l(!1);const Nt=l(!1);function $t(){Nt.value=!1}function It(){$t(),pt()}const St=l(!1);function Ut(){St.value=!1}async function Et(){try{console.log("[confirmSave] is saving assay lot(s)"),Se.value=!0,await Ke()}catch(e){console.error(`[confirmSave] error=${e}`)}finally{console.log("[confirmSave] finished saving assay lot(s)"),Ut(),Se.value=!1}}const Ot=l(!1);function Ct(){Ot.value=!1}return i(te,mt),i(de,(function(){if(console.log("[onMethodSelected] running"),!He.value)return void console.log("[onMethodSelected] is not adding new assay, returning");console.log(`[onMethodSelected] assays for selected method=${JSON.stringify(q.value.find((e=>e.method===de.value)))}`);const e=q.value.filter((e=>e.method===de.value)).map((e=>e.commodity));bt.value=[...ht.value.filter((t=>!e.includes(t.value)))],0===bt.value.length&&(bt.value=[{text:"-- All commodities for this method have existing assays --",value:void 0}]),de.value?gt.value[0].text=H:gt.value[0].text=W,pe.value=d.value.filter((e=>e.method===de.value)).reduce(((e,t)=>{var a;return e+parseFloat(null!==(a=t.dry_weight)&&void 0!==a?a:0)}),0),console.log(`[onMethodSelected] compositeItemWeight=${pe.value}`)})),i(me,(function(){if(console.log("onCommoditySelected() is running"),!He.value)return void console.log("is not adding new assay, returning");if(!u.value)return void console.error("contract data is not defined");console.log(`assays for selected commodity=${JSON.stringify(q.value.find((e=>e.commodity===me.value)))}`);const e=q.value.filter((e=>e.commodity===me.value)).map((e=>e.method));gt.value=[..._t.value.filter((t=>!t.value||!e.includes(t.value)))],0===gt.value.length&&(gt.value=[{text:"-- All methods for this commodity have existing assays --",value:void 0}]),me.value?bt.value[0].text="-- Deselect commodity --":bt.value[0].text="-- Select a commodity --";const t=u.value.commodities.findIndex((e=>e.code===me.value));t>=0&&(ve.value=u.value.commodities[t].splittingLimit,ce.value=u.value.commodities[t].splittingLimitUOM,Ce.value=u.value.dryWeightUOM)})),i([_e,ge],((e,t)=>{u.value?(he.value=st(_e.value,ge.value),ye.value=!(!he.value||!ve.value)&&nt(he.value,ve.value,!!u.value.umpireArbitrationWhenSLEqualsDiff),ye.value&&(we.value=void 0,fe.value=void 0),Ae.value=rt(_e.value,ge.value,we.value),console.log("asdf 4"),be.value=ut(_e.value,ge.value,we.value,ye.value,Ae.value,u.value.finalAssayEquation),console.log("asdf "+be.value)):console.error("contract data is not defined")})),i([he],(function(){if(!u.value)return void console.error("contract data is not defined");if(!he.value||!ve.value)return void console.log("composite difference or splitting limit is undefined");let e=!1;Math.abs(he.value)>ve.value&&!ye.value?(console.log("lot difference is greater than splitting limit"),ye.value=!0,e=!0):Math.abs(he.value)<ve.value&&ye.value?(console.log("lot difference is less than to splitting limit"),ye.value=!1,e=!0):Math.abs(he.value)===ve.value&&!ye.value&&u.value.umpireArbitrationWhenSLEqualsDiff?(console.log("lot difference is equal to splitting limit"),ye.value=!0,e=!0):Math.abs(he.value)===ve.value&&ye.value&&!u.value.umpireArbitrationWhenSLEqualsDiff&&(console.log("lot difference is equal to splitting limit"),ye.value=!1,e=!0),e&&(ye.value||(we.value=void 0,fe.value=void 0,Ae.value=void 0),console.log("asdf 5"),be.value=ut(_e.value,ge.value,we.value,ye.value,Ae.value,u.value.finalAssayEquation))})),i([ye,we],(function(){u.value?(ye.value||(fe.value=void 0,we.value=void 0,Ae.value=void 0),Ae.value=rt(_e.value,ge.value,we.value),console.log("asdf 3"),be.value=ut(_e.value,ge.value,we.value,ye.value,Ae.value,u.value.finalAssayEquation),console.log("asdf "+be.value)):console.error("contract data is not defined")})),i(q,(e=>{console.log(`change in assay detected. New assay=${JSON.stringify(e)}`),j.value=[],Y.value=[],G.value=[],Q.value=[],Z.value=[];for(const t of e)switch(t.method){case Le.INTURN:j.value.push(t);break;case Le.INTURN_FINAL:Y.value.push(t);break;case Le.OUTTURN:G.value.push(t);break;case Le.ESTIMATED:Z.value.push(t);break;case Le.PLANNED:Q.value.push(t)}J.value=0===j.value.length,K.value=0===Y.value.length,z.value=0===G.value.length,X.value=0===Q.value.length,ee.value=0===Z.value.length}),{deep:!0}),{confirmCloseDrawerOverlay:Nt,openConfirmCloseDrawerOverly:function(){ie.value.length>0||re.value.length>0||ne.value.length>0||te.value?Nt.value=!0:It()},closeConfirmCloseDrawerOverlay:$t,confirmCloseDrawer:It,confirmSaveOverlay:St,openConfirmSaveOverlay:function(){ie.value.length>0||re.value.length>0||ne.value.length>0||te.value?Et():Ue.value="Please add new assay lots or make changes to existing assay lots before saving"},closeConfirmSaveOverlay:Ut,confirmSave:Et,confirmDeleteAssayOverlay:Ot,openConfirmDeleteAssayOverlay:function(){Ot.value=!0},closeConfirmDeleteAssayOverlay:Ct,confirmDeleteAssay:async function(){try{console.log("[confirmDeleteAssay] is deleting assay lot(s)"),Se.value=!0,await async function(){console.log("[deleteAssay]");const e=oe.value.map((e=>e.id));e.push(ue.value);const t=await m.delete(`/items/${g}`,{data:e.filter((e=>void 0!==e))});if(204!==t.status)throw new Error(`response status=${t.status} is not 204`);console.log(`Assay successfully deleted with response status=${t.status}`),q.value.splice(le.value,1),pt()}()}catch(e){console.error(`[confirmDeleteAssay] error=${e}`)}finally{console.log("[confirmDeleteAssay] finished deleting assay lot(s)"),Ct(),Se.value=!1}},attrs:a,assayTableHeaders:n,assayLotTableHeaders:r,units:Me,itemDryWeightUnit:Ce,assayUnits:ke,saveAssayLots:Ye,foreign_key:Oe,formValues:Ee,addNewAssayLot:We,isOpen:ft,toggleDrawer:pt,isComposite:te,toggleCompositeBoolean:()=>{te.value=!te.value},methodSelection:gt,commoditySelection:bt,itemMethod:de,itemCommodity:me,itemAssayUoM:ce,itemSplittingLimit:ve,compositeItemWeight:pe,compositeItemSellerAssay:_e,compositeItemBuyerAssay:ge,compositeItemDifference:he,compositeItemFinalAssay:be,compositeItemToUmpire:ye,compositeUmpireName:fe,compositeItemUmpireAssay:we,compositeItemLosingParty:Ae,rowClickHandler:function(e){var t,a,l,o,i,s,n,r,u,d,m,c,v,y,f;console.log(`[rowClickHandler] ${JSON.stringify(e)} after clicking on an assay row`);const p=e.item;var _;le.value=q.value.findIndex((e=>e.assay_id===lt(p))),it(p)?(console.log("[rowClickHandler] keeping is composite toggle enabled"),console.log(`[rowClickHandler] debug rowClickHandler selectedAssayIndex=${le.value}`),At.value=!1,p.composite=p.composite,ue.value=null===(t=p.composite)||void 0===t?void 0:t.id,de.value=null===(a=p.composite)||void 0===a?void 0:a.method,me.value=null===(l=p.composite)||void 0===l?void 0:l.commodity,ce.value=null===(o=p.composite)||void 0===o?void 0:o.assay_uom,ve.value=null===(i=p.composite)||void 0===i?void 0:i.splitting_limit,ye.value=!!(null===(s=p.composite)||void 0===s?void 0:s.to_umpire),fe.value=null===(n=p.composite)||void 0===n?void 0:n.umpire_name,pe.value=null===(r=p.composite)||void 0===r?void 0:r.dry_weight,Ce.value=null===(u=p.composite)||void 0===u?void 0:u.dry_weight_uom,_e.value=null===(d=p.composite)||void 0===d?void 0:d.seller_assay,ge.value=null===(m=p.composite)||void 0===m?void 0:m.buyer_assay,he.value=null===(c=p.composite)||void 0===c?void 0:c.difference,console.log("asdf 6"),be.value=null===(v=p.composite)||void 0===v?void 0:v.final_assay,console.log("asdf "+be.value),we.value=null===(y=p.composite)||void 0===y?void 0:y.umpire_assay,Ae.value=null===(f=p.composite)||void 0===f?void 0:f.losing_party,console.log(`[rowClickHandler] assayLotsToDisplay in composite=${JSON.stringify(oe.value)}`)):(te.value=!1,console.log("[rowClickHandler] disabling is composite toggle"),At.value=!0,console.log(`[rowClickHandler] Selected assay item is of index=${le.value}`),oe.value=(_=p.lots,console.log("[cloneLots]"),[..._].map((e=>({...e})))),console.log(`[rowClickHandler] assayLotsToDisplay=${JSON.stringify(oe.value)}`),-1!==le.value&&void 0!==q.value[le.value]&&(de.value=q.value[le.value].method,me.value=q.value[le.value].commodity,ce.value=oe.value[0].assay_uom,Ce.value=oe.value[0].dry_weight_uom,ve.value=q.value[le.value].splitting_limit,wt.value=[q.value[le.value]])),pt()},assays:q,inturnAssays:j,isInturnAssaysEmpty:J,inturnFinalAssays:Y,isInturnFinalAssaysEmpty:K,outturnAssays:G,isOutturnAssaysEmpty:z,estimateAssays:Z,isEstimateAssaysEmpty:ee,plannedAssays:Q,isPlannedAssaysEmpty:X,selectedAssayForDrawerDisplay:wt,assayLotsToDisplay:oe,assayLotsToDelete:re,onKeyDown:function(e,t,a){var l,o,i;if("Enter"!==a.code&&"NumpadEnter"!==a.code)null!==t&&(yt&&clearTimeout(yt),yt=setTimeout((()=>{if(!u.value)return void console.error("contract data is not defined");console.log(`on key down event: ${JSON.stringify(e)}`);let a=-1;e.id?(a=oe.value.findIndex((t=>t.id===e.id)),a<0?console.log(`No assay lot found with id=${e.id}`):"final_assay"!==t?(e.difference=st(e.seller_assay,e.buyer_assay),void 0!==e.difference&&void 0!==e.splitting_limit&&(e.to_umpire=nt(e.difference,e.splitting_limit,!!u.value.umpireArbitrationWhenSLEqualsDiff)),e.to_umpire&&void 0!==e.umpire_assay&&void 0!==e.seller_assay&&void 0!==e.buyer_assay&&(e.losing_party=rt(e.seller_assay,e.buyer_assay,e.umpire_assay)),e.to_umpire||(e.umpire_assay=void 0,e.umpire_name=void 0,e.losing_party=void 0),e.final_assay=ut(e.seller_assay,e.buyer_assay,e.umpire_assay,e.to_umpire,e.losing_party,u.value.finalAssayEquation),oe.value[a]=e,ne.value.includes(e.id)||ie.value.includes(e.id)||ie.value.push(e.id)):ie.value.push(e.id)):console.log(`No assay lot id found for item ${e}`)}),500));else{const e=null===(l=a.target||a.srcElement)||void 0===l?void 0:l.id;if(!e)return void console.error("currentElementId is not defined");if(!/assaylots-(\d)+-(\d)+/.test(e))return void console.error(`current element id=${e} is not in the correct format`);const[t,s,n]=e.split("-");let r=parseInt(n),u=parseInt(s),d="";do{if(r<oe.value.length)r++,d=`${t}-${u}-${r}`;else{if(u===vt)return;u++,r=1,d=`${t}-${u}-${r}`}}while(document.getElementById(d)&&null!==(null===(o=document.getElementById(d))||void 0===o?void 0:o.getAttribute("disabled")));null===(i=document.getElementById(d))||void 0===i||i.focus()}},deleteButtonHandler:function(e){const t=re.value.findIndex((t=>t===e));-1===t?re.value.push(e):re.value.splice(t,1)},stageSplittingLimitBatchUpdate:function(){1==ct&&clearTimeout(ct),ct=setTimeout((()=>{var e;if(u.value)if(it(q.value[le.value])){if(!he.value||!ve.value)return void console.log("composite difference or splitting limit is undefined");let e=!1;Math.abs(he.value)>ve.value&&!ye.value?(console.log("lot difference is greater than splitting limit"),ye.value=!0,e=!0):Math.abs(he.value)<ve.value&&ye.value?(console.log("lot difference is less than to splitting limit"),ye.value=!1,e=!0):Math.abs(he.value)===ve.value&&!ye.value&&u.value.umpireArbitrationWhenSLEqualsDiff?(console.log("lot difference is equal to splitting limit"),ye.value=!0,e=!0):Math.abs(he.value)===ve.value&&ye.value&&!u.value.umpireArbitrationWhenSLEqualsDiff&&(console.log("lot difference is equal to splitting limit"),ye.value=!1,e=!0),e&&(ye.value||(we.value=0,fe.value=void 0,Ae.value=void 0),console.log("asdf 1"),be.value=ut(_e.value,ge.value,we.value,ye.value,Ae.value,u.value.finalAssayEquation))}else{se.value.splitting_limit=ve.value;let t=!1;for(const a of oe.value)if(void 0!==a.difference&&void 0!==ve.value){if(t=!1,Math.abs(a.difference)>ve.value&&!a.to_umpire?(console.log("lot difference is greater than splitting limit"),a.to_umpire=!0,t=!0):Math.abs(a.difference)<ve.value&&a.to_umpire?(console.log("lot difference is less than to splitting limit"),a.to_umpire=!1,t=!0):Math.abs(a.difference)===ve.value&&!a.to_umpire&&u.value.umpireArbitrationWhenSLEqualsDiff?(console.log("lot difference is equal to splitting limit"),a.to_umpire=!0,t=!0):Math.abs(a.difference)===ve.value&&a.to_umpire&&!u.value.umpireArbitrationWhenSLEqualsDiff&&(console.log("lot difference is equal to splitting limit"),a.to_umpire=!1,t=!0),t){a.to_umpire||(a.umpire_assay=void 0,a.umpire_name=void 0,a.losing_party=void 0),a.final_assay=ut(a.seller_assay,a.buyer_assay,a.umpire_assay,a.to_umpire,a.losing_party,u.value.finalAssayEquation);const t=oe.value.findIndex((e=>e.id===a.id));oe.value[t]=a,ie.value.push(null!==(e=a.id)&&void 0!==e?e:P)}}else console.log("lot difference or splitting limit is undefined")}else console.error("contract data is not defined")}),2e3)},addAssayButtonHandler:async function(){He.value=!0,wt.value=[{}],await xe(),pt()},isAddingNewAssay:He,save:Ke,onCompositeToggle:mt,saveOperationCannotBePerformedReason:Ue,isCompositeToggleDisabled:At,isEditingLotsViaApi:Se,highlightCellToLightSalmon:function(e){return e?"assay_cell_highlighted":"assay_cell"},deleteIcon:function(e){return console.log("[deleteIcon]"),-1===re.value.findIndex((t=>t===e))?"close":"settings_backup_restore"},colourDeleteIcon:function(e){return console.log("[colourDeleteIcon]"),-1===re.value.findIndex((t=>t===e))?"v-icon-delete-button-small-foreground-subdued":"v-icon-delete-button-small-red"},isEditingDisabled:$e,isContractNotFound:Ne,disableEditAssayButtonReason:Ie,formatNumber:function(e,t=4,a=!0){if(console.log(`[formatNumber] with number value=${e}`),isNaN(e)||null===e)return"-";const l=Math.round(e*Math.pow(10,t))/Math.pow(10,t),[o,i]=l.toString().split(".");if(!o)return"";const s=o.replace(/\B(?=(\d{3})+(?!\d))/g,",");return i||a?`${s}.${(null!=i?i:"").padEnd(t,"0")}`:s},isNullOrUndefined:ze,syncWeightLots:async()=>{if(ae.value=!0,await xe(),!de.value)return console.error("itemMethod is not defined"),void(ae.value=!1);const e=d.value.filter((e=>e.method===de.value.toString())).sort(((e,t)=>e.lot_number-t.lot_number)).map((e=>({weight:e.dry_weight,id:e.id})));if(te.value)pe.value=e.reduce(((e,t)=>e+parseFloat(t.weight)),0);else{for(const t of e){const e=oe.value.findIndex((e=>e.weight_lot_id===t.id));e<0?(console.log(`[syncWeightLots] weight lot id=${t.id} not found in assayLotsToDisplay, adding new lot instead`),We(),oe.value[oe.value.length-1].weight_lot_id=t.id,oe.value[oe.value.length-1].dry_weight=parseFloat(t.weight),oe.value[oe.value.length-1].dry_weight_uom=Ce.value,oe.value[oe.value.length-1].splitting_limit=ve.value,oe.value[oe.value.length-1].assay_uom=ce.value):(oe.value[e].dry_weight=parseFloat(t.weight),ie.value.push(oe.value[e].id||P))}for(let t=0;t<oe.value.length;t++)e.find((e=>e.id===oe.value[t].weight_lot_id))||re.value.push(oe.value[t].id||P)}ae.value=!1},isSyncingWeightLots:ae}}});const Re=e=>(h("data-v-64969d30"),e=e(),b(),e),xe={key:0},Fe={key:0},Pe={key:0},He={key:0},We={key:0},Be={class:"drawer-content"},qe={class:"same-line"},je=Re((()=>y("div",{class:"is-composite-checkbox-label"},"Is Composite",-1))),Je={key:1},Ye={class:"input-label"},Ke={key:0},Ge=["disabled"],ze=Re((()=>y("div",{class:"input-label"},"Method",-1))),Qe=Re((()=>y("div",{class:"input-label"},"Commodity",-1))),Xe=Re((()=>y("div",{class:"input-label"},"Assay UoM",-1))),Ze=Re((()=>y("div",{class:"input-label"},"Splitting limit",-1))),et={key:0},tt=Re((()=>y("div",{class:"input-label"},"Weight",-1))),at=Re((()=>y("div",{class:"input-label"},"Unit of Measure (Weight)",-1))),lt=Re((()=>y("div",{class:"input-label"},"Seller Assay",-1))),ot=Re((()=>y("div",{class:"input-label"},"Buyer Assay",-1))),it=Re((()=>y("div",{class:"input-label"},"Difference",-1))),st=Re((()=>y("div",{class:"input-label"},"To Umpire",-1))),nt=Re((()=>y("div",{class:"input-label"},"Umpire name",-1))),rt=Re((()=>y("div",{class:"input-label"},"Umpire Assay",-1))),ut=Re((()=>y("div",{class:"input-label"},"Losing party",-1))),dt=Re((()=>y("div",{class:"input-label"},"Final Assay",-1))),mt={key:1},ct=Re((()=>y("div",{class:"input-label"},"Assay Lots",-1))),vt=Re((()=>y("div",null,null,-1))),yt={key:0};var ft=[],pt=[];!function(e,t){if(e&&"undefined"!=typeof document){var a,l=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var s=ft.indexOf(i);-1===s&&(s=ft.push(i)-1,pt[s]={}),a=pt[s]&&pt[s][l]?pt[s][l]:pt[s][l]=n()}else a=n();65279===e.charCodeAt(0)&&(e=e.substring(1)),a.styleSheet?a.styleSheet.cssText+=e:a.appendChild(document.createTextNode(e))}function n(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var a=Object.keys(t.attributes),o=0;o<a.length;o++)e.setAttribute(a[o],t.attributes[a[o]]);var s="prepend"===l?"afterbegin":"beforeend";return i.insertAdjacentElement(s,e),e}}('.assay-table .table-row[data-v-64969d30] {\n  height: 30px;\n}\n.assay-table .assay_cell[data-v-64969d30] {\n  width: 100%;\n}\n.assay-table .assay_cell_highlighted[data-v-64969d30] {\n  background-color: lightsalmon !important;\n  width: 100%;\n}\n.assay-table .header_cell_with_input[data-v-64969d30] {\n  height: 60px;\n}\n.margin-top-16px[data-v-64969d30] {\n  margin-top: 16px;\n}\n.v-icon-white[data-v-64969d30] {\n  --v-icon-color: #ffffff;\n}\n.v-icon-purple[data-v-64969d30] {\n  --v-icon-color: #8866FF;\n}\n.v-icon-delete-button-small-foreground-subdued[data-v-64969d30] {\n  --v-icon-size: 18px;\n  --v-icon-color: var(--foreground-subdued);\n}\n.v-icon-delete-button-small-red[data-v-64969d30] {\n  --v-icon-size: 18px;\n  --v-icon-color: var(--red);\n}\n.v-button-red-on-hover[data-v-64969d30] {\n  --v-button-color: var(--white);\n  --v-button-background-color: var(--background-normal);\n  --v-button-color-hover: var(--white);\n  --v-button-background-color-hover: var(--red);\n}\n.v-button-red[data-v-64969d30] {\n  --v-button-color: var(--white);\n  --v-button-background-color: var(--danger);\n  --v-button-color-hover: var(--white);\n  --v-button-background-color-hover: var(--danger-125);\n}\n.drawer-content[data-v-64969d30] {\n  padding: 0 32px 40px;\n}\n.assay-drawer[data-v-64969d30] {\n  max-width: 1500px !important;\n}\n.v-sheet[data-v-64969d30] {\n  --v-sheet-color: var(-red-600);\n}\n.input-label[data-v-64969d30] {\n  color: #f0f6fc;\n  font-weight: 600;\n  font-size: 16px;\n  font-family: "Inter", -apple-system, "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica", "Arial", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n  font-style: normal;\n  line-height: 19px;\n  margin-bottom: 8px;\n  padding-top: 20px !important;\n}\n.same-line[data-v-64969d30] {\n  display: flex;\n  flex-direction: row;\n}\n.is-composite-checkbox-label[data-v-64969d30] {\n  color: #f0f6fc;\n  font-weight: 600;\n  font-size: 16px;\n  font-family: "Inter", -apple-system, "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica", "Arial", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n  font-style: normal;\n  line-height: 19px;\n  padding-left: 10px !important;\n  display: flex;\n  align-items: center;\n}',{}),Ve.render=function(e,t,a,l,o,i){const h=s("v-overlay"),b=s("v-icon"),w=s("v-table"),A=s("v-detail"),N=s("v-button"),$=s("v-notice"),I=s("v-checkbox"),S=s("v-select"),U=s("v-input"),E=s("v-drawer"),O=s("v-card-title"),C=s("v-card-text"),L=s("v-card-actions"),D=s("v-card"),T=s("v-dialog"),M=n("tooltip");return r(),u("div",null,[d(" <div>{{ assays }}</div> "),d(' <input :value="foreign_key"> '),m(h,{active:e.isEditingLotsViaApi,clickable:!1},null,8,["active"]),e.isPlannedAssaysEmpty?d("v-if",!0):(r(),c(A,{key:0,label:"Planned"},{default:v((()=>[m(w,{class:"assay-table",headers:e.assayTableHeaders,items:e.plannedAssays,rowHeight:30,"onClick:row":t[0]||(t[0]=t=>e.rowClickHandler(t)),fixedHeader:"",inline:""},{"item.seller_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.seller_assay)}${e.isNullOrUndefined(t.seller_assay)?"":t.assay_uom}`),1)])),"item.buyer_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.buyer_assay)}${e.isNullOrUndefined(t.buyer_assay)?"":t.assay_uom}`),1)])),"item.difference":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.difference)}${e.isNullOrUndefined(t.difference)?"":t.assay_uom}`),1)])),"item.splitting_limit":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.splitting_limit)}${e.isNullOrUndefined(t.splitting_limit)?"":t.assay_uom}`),1)])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",xe,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.umpire_assay)}${e.isNullOrUndefined(t.umpire_assay)?"":t.assay_uom}`),1)])),"item.final_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.final_assay)}${e.isNullOrUndefined(t.final_assay)?"":t.assay_uom}`),1)])),_:2},1032,["headers","items"])])),_:1})),e.isEstimateAssaysEmpty?d("v-if",!0):(r(),c(A,{key:1,label:"Estimate"},{default:v((()=>[m(w,{class:"assay-table",headers:e.assayTableHeaders,items:e.estimateAssays,rowHeight:30,"onClick:row":t[1]||(t[1]=t=>e.rowClickHandler(t)),fixedHeader:"",inline:""},{"item.seller_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.seller_assay)}${e.isNullOrUndefined(t.seller_assay)?"":t.assay_uom}`),1)])),"item.buyer_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.buyer_assay)}${e.isNullOrUndefined(t.buyer_assay)?"":t.assay_uom}`),1)])),"item.difference":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.difference)}${e.isNullOrUndefined(t.difference)?"":t.assay_uom}`),1)])),"item.splitting_limit":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.splitting_limit)}${e.isNullOrUndefined(t.splitting_limit)?"":t.assay_uom}`),1)])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",Fe,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.umpire_assay)}${e.isNullOrUndefined(t.umpire_assay)?"":t.assay_uom}`),1)])),"item.final_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.final_assay)}${e.isNullOrUndefined(t.final_assay)?"":t.assay_uom}`),1)])),_:2},1032,["headers","items"])])),_:1})),e.isInturnAssaysEmpty?d("v-if",!0):(r(),c(A,{key:2,label:"Inturn"},{default:v((()=>[m(w,{class:"assay-table",headers:e.assayTableHeaders,items:e.inturnAssays,rowHeight:30,"onClick:row":t[2]||(t[2]=t=>e.rowClickHandler(t)),fixedHeader:"",inline:""},{"item.seller_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.seller_assay)}${e.isNullOrUndefined(t.seller_assay)?"":t.assay_uom}`),1)])),"item.buyer_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.buyer_assay)}${e.isNullOrUndefined(t.buyer_assay)?"":t.assay_uom}`),1)])),"item.difference":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.difference)}${e.isNullOrUndefined(t.difference)?"":t.assay_uom}`),1)])),"item.splitting_limit":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.splitting_limit)}${e.isNullOrUndefined(t.splitting_limit)?"":t.assay_uom}`),1)])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",Pe,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.umpire_assay)}${e.isNullOrUndefined(t.umpire_assay)?"":t.assay_uom}`),1)])),"item.final_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.final_assay)}${e.isNullOrUndefined(t.final_assay)?"":t.assay_uom}`),1)])),_:2},1032,["headers","items"])])),_:1})),e.isInturnFinalAssaysEmpty?d("v-if",!0):(r(),c(A,{key:3,label:"Inturn Final"},{default:v((()=>[m(w,{class:"assay-table",headers:e.assayTableHeaders,items:e.inturnFinalAssays,rowHeight:30,"onClick:row":t[3]||(t[3]=t=>e.rowClickHandler(t)),fixedHeader:"",inline:""},{"item.seller_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.seller_assay)}${e.isNullOrUndefined(t.seller_assay)?"":t.assay_uom}`),1)])),"item.buyer_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.buyer_assay)}${e.isNullOrUndefined(t.buyer_assay)?"":t.assay_uom}`),1)])),"item.difference":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.difference)}${e.isNullOrUndefined(t.difference)?"":t.assay_uom}`),1)])),"item.splitting_limit":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.splitting_limit)}${e.isNullOrUndefined(t.splitting_limit)?"":t.assay_uom}`),1)])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",He,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.umpire_assay)}${e.isNullOrUndefined(t.umpire_assay)?"":t.assay_uom}`),1)])),"item.final_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.final_assay)}${e.isNullOrUndefined(t.final_assay)?"":t.assay_uom}`),1)])),_:2},1032,["headers","items"])])),_:1})),e.isOutturnAssaysEmpty?d("v-if",!0):(r(),c(A,{key:4,label:"Outturn"},{default:v((()=>[m(w,{class:"assay-table",headers:e.assayTableHeaders,items:e.outturnAssays,rowHeight:30,"onClick:row":t[4]||(t[4]=t=>e.rowClickHandler(t)),fixedHeader:"",inline:""},{"item.seller_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.seller_assay)}${e.isNullOrUndefined(t.seller_assay)?"":t.assay_uom}`),1)])),"item.buyer_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.buyer_assay)}${e.isNullOrUndefined(t.buyer_assay)?"":t.assay_uom}`),1)])),"item.difference":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.difference)}${e.isNullOrUndefined(t.difference)?"":t.assay_uom}`),1)])),"item.splitting_limit":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.splitting_limit)}${e.isNullOrUndefined(t.splitting_limit)?"":t.assay_uom}`),1)])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",We,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.umpire_assay)}${e.isNullOrUndefined(t.umpire_assay)?"":t.assay_uom}`),1)])),"item.final_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.final_assay)}${e.isNullOrUndefined(t.final_assay)?"":t.assay_uom}`),1)])),_:2},1032,["headers","items"])])),_:1})),m(E,{modelValue:e.isOpen,"onUpdate:modelValue":t[21]||(t[21]=t=>e.isOpen=t),onToggle:e.openConfirmCloseDrawerOverly,onCancel:e.openConfirmCloseDrawerOverly,icon:"gavel",title:"Edit Assay",subtitle:e.isComposite?"Composite Assay":"Assay Lots"},{actions:v((()=>[p((r(),c(N,{rounded:"",onClick:e.openConfirmSaveOverlay,disabled:e.isEditingDisabled||e.isContractNotFound,icon:""},{default:v((()=>[m(b,{name:"check"})])),_:1},8,["onClick","disabled"])),[[M,e.isEditingDisabled||e.isContractNotFound?e.disableEditAssayButtonReason??"Editing has been disabled":null,void 0,{bottom:!0}]]),p((r(),c(N,{class:"v-button-red-on-hover",rounded:"",onClick:e.openConfirmDeleteAssayOverlay,disabled:e.isEditingDisabled||e.isContractNotFound,icon:""},{default:v((()=>[m(b,{name:"delete"})])),_:1},8,["onClick","disabled"])),[[M,e.isEditingDisabled||e.isContractNotFound?e.disableEditAssayButtonReason??"Editing has been disabled":null,void 0,{bottom:!0}]])])),default:v((()=>[y("div",Be,[e.saveOperationCannotBePerformedReason?(r(),c($,{key:0},{default:v((()=>[_(f(e.saveOperationCannotBePerformedReason),1)])),_:1})):d("v-if",!0),y("div",qe,[p(m(I,{modelValue:e.isComposite,"onUpdate:modelValue":t[5]||(t[5]=t=>e.isComposite=t),"icon-on":"check_box","icon-off":"check_box_outline_blank",label:null,disabled:!e.itemMethod||!e.itemDryWeightUnit||!e.itemAssayUoM||!e.itemSplittingLimit||e.isCompositeToggleDisabled&&!e.isAddingNewAssay},null,8,["modelValue","disabled"]),[[M,e.itemMethod&&e.itemDryWeightUnit&&e.itemAssayUoM&&e.itemSplittingLimit?e.isCompositeToggleDisabled&&!e.isAddingNewAssay?e.disableEditAssayButtonReason??"Assay lot cannot be converted to composite assay":null:"Please select a method and commodity first",void 0,{bottom:!0}]]),je]),e.isComposite?d("v-if",!0):(r(),u("div",Je,[y("div",Ye,f(`Assay Result for ${e.selectedAssayForDrawerDisplay[0].commodity_name} (${e.itemMethod})`),1),m(w,{class:"assay-table",headers:e.assayTableHeaders,items:e.selectedAssayForDrawerDisplay,rowHeight:30,fixedHeader:"",inline:""},{"item.seller_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.seller_assay)}${e.isNullOrUndefined(t.seller_assay)?"":t.assay_uom}`),1)])),"item.buyer_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.buyer_assay)}${e.isNullOrUndefined(t.buyer_assay)?"":t.assay_uom}`),1)])),"item.difference":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.difference)}${e.isNullOrUndefined(t.difference)?"":t.assay_uom}`),1)])),"item.splitting_limit":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.splitting_limit)}${e.isNullOrUndefined(t.splitting_limit)?"":t.assay_uom}`),1)])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",Ke,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.umpire_assay)}${e.isNullOrUndefined(t.umpire_assay)?"":t.assay_uom}`),1)])),"item.final_assay":v((({item:t})=>[y("div",null,f(`${e.formatNumber(t.final_assay)}${e.isNullOrUndefined(t.final_assay)?"":t.assay_uom}`),1)])),_:2},1032,["headers","items"])])),y("fieldset",{disabled:e.isEditingDisabled||e.isContractNotFound},[d(" Just disabling adding a new assay by saving lot items, must first create a composite item that is then converted to lots, can be changed in the future "),d(" when a selected assay is made up of assay lots, it should not be convertible back to composite "),ze,m(S,{modelValue:e.itemMethod,"onUpdate:modelValue":t[6]||(t[6]=t=>e.itemMethod=t),items:e.methodSelection,disabled:!e.isAddingNewAssay},null,8,["modelValue","items","disabled"]),Qe,m(S,{modelValue:e.itemCommodity,"onUpdate:modelValue":t[7]||(t[7]=t=>e.itemCommodity=t),items:e.commoditySelection,disabled:!e.isAddingNewAssay},null,8,["modelValue","items","disabled"]),Xe,m(S,{modelValue:e.itemAssayUoM,"onUpdate:modelValue":t[8]||(t[8]=t=>e.itemAssayUoM=t),items:e.assayUnits,disabled:!0},null,8,["modelValue","items"]),Ze,m(U,{modelValue:e.itemSplittingLimit,"onUpdate:modelValue":t[9]||(t[9]=t=>e.itemSplittingLimit=t),type:"number",onInput:t[10]||(t[10]=()=>e.stageSplittingLimitBatchUpdate()),disabled:!0},null,8,["modelValue"]),e.isComposite?(r(),u("div",et,[tt,m(U,{modelValue:e.compositeItemWeight,"onUpdate:modelValue":t[11]||(t[11]=t=>e.compositeItemWeight=t),type:"number",disabled:!0},null,8,["modelValue"]),p((r(),c(N,{class:"margin-top-16px",onClick:e.syncWeightLots,loading:e.isSyncingWeightLots,disabled:e.isAddingNewAssay||!e.itemMethod},{default:v((()=>[_(" Sync Weight Lots ")])),_:1},8,["onClick","loading","disabled"])),[[M,e.isAddingNewAssay?"Weight lots are up to date when creating a new assay":e.itemMethod?`Sync assay lots with the weight lots for method ${e.itemMethod}`:"Please select a method first",void 0,{bottom:!0}]]),at,m(S,{modelValue:e.itemDryWeightUnit,"onUpdate:modelValue":t[12]||(t[12]=t=>e.itemDryWeightUnit=t),items:e.units,disabled:!0},null,8,["modelValue","items"]),lt,m(U,{modelValue:e.compositeItemSellerAssay,"onUpdate:modelValue":t[13]||(t[13]=t=>e.compositeItemSellerAssay=t),type:"number"},null,8,["modelValue"]),ot,m(U,{modelValue:e.compositeItemBuyerAssay,"onUpdate:modelValue":t[14]||(t[14]=t=>e.compositeItemBuyerAssay=t),type:"number"},null,8,["modelValue"]),it,m(U,{modelValue:e.compositeItemDifference,"onUpdate:modelValue":t[15]||(t[15]=t=>e.compositeItemDifference=t),type:"number"},null,8,["modelValue"]),st,p(m(I,{modelValue:e.compositeItemToUmpire,"onUpdate:modelValue":t[16]||(t[16]=t=>e.compositeItemToUmpire=t),disabled:"",label:"Requires umpire arbitration"},null,8,["modelValue"]),[[M,"Cannot be edited directly, will auto update based on seller and buyer assay difference, and splitting limit",void 0,{bottom:!0}]]),nt,m(U,{modelValue:e.compositeUmpireName,"onUpdate:modelValue":t[17]||(t[17]=t=>e.compositeUmpireName=t),disabled:!e.compositeItemToUmpire},null,8,["modelValue","disabled"]),rt,m(U,{modelValue:e.compositeItemUmpireAssay,"onUpdate:modelValue":t[18]||(t[18]=t=>e.compositeItemUmpireAssay=t),disabled:!e.compositeItemToUmpire,type:"number"},null,8,["modelValue","disabled"]),ut,p(m(U,{modelValue:e.compositeItemLosingParty,"onUpdate:modelValue":t[19]||(t[19]=t=>e.compositeItemLosingParty=t),disabled:""},null,8,["modelValue"]),[[M,"Cannot be edited directly, will auto update based on umpire assay if umpire arbitration is required",void 0,{bottom:!0}]]),dt,m(U,{modelValue:e.compositeItemFinalAssay,"onUpdate:modelValue":t[20]||(t[20]=t=>e.compositeItemFinalAssay=t),type:"number"},null,8,["modelValue"])])):(r(),u("div",mt,[ct,m(w,{class:"assay-table",headers:e.assayLotTableHeaders,items:e.assayLotsToDisplay,rowHeight:30,fixedHeader:"",inline:""},{"header.dry_weight":v((({header:t})=>[y("div",null,f(`${t.text} (${e.itemDryWeightUnit})`),1)])),"header.to_umpire":v((()=>[vt])),"item.delete":v((({item:t})=>[m(b,{class:g(e.colourDeleteIcon(t.id)),name:e.deleteIcon(t.id),onClick:()=>e.deleteButtonHandler(t.id)},null,8,["class","name","onClick"])])),"item.dry_weight":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].dry_weight,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].dry_weight=a,placeholder:0,type:"number",nullable:!0,disabled:!0,id:`assaylots-1-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","id"])])),"item.seller_assay":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].seller_assay,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].seller_assay=a,placeholder:0,type:"number",onKeydown:a=>e.onKeyDown(t,"seller_assay",a),nullable:!0,id:`assaylots-2-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","onKeydown","id"])])),"item.buyer_assay":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].buyer_assay,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].buyer_assay=a,placeholder:0,type:"number",onKeydown:a=>e.onKeyDown(t,"buyer_assay",a),nullable:!0,id:`assaylots-3-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","onKeydown","id"])])),"item.difference":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].difference,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].difference=a,placeholder:0,type:"number",onKeydown:a=>e.onKeyDown(t,null,a),nullable:!0,id:`assaylots-4-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","onKeydown","id"])])),"item.to_umpire":v((({item:e})=>[e.to_umpire?(r(),u("div",yt,[p(m(b,{class:"v-icon-purple",name:"gavel"},null,512),[[M,"Require umpire arbitration",void 0,{bottom:!0}]])])):d("v-if",!0)])),"item.umpire_name":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].umpire_name,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].umpire_name=a,disabled:!e.assayLotsToDisplay[t.lot_number-1].to_umpire,placeholder:0,type:"string",onKeydown:a=>e.onKeyDown(t,null,a),nullable:!0,id:`assaylots-5-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","disabled","onKeydown","id"])])),"item.umpire_assay":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].umpire_assay,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].umpire_assay=a,disabled:!e.assayLotsToDisplay[t.lot_number-1].to_umpire,placeholder:0,type:"number",onKeydown:a=>e.onKeyDown(t,"umpire_assay",a),nullable:!0,id:`assaylots-6-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","disabled","onKeydown","id"])])),"item.losing_party":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].losing_party,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].losing_party=a,disabled:!0,placeholder:0,type:"string",nullable:!0},null,8,["class","modelValue","onUpdate:modelValue"])])),"item.final_assay":v((({item:t})=>[m(U,{class:g(e.highlightCellToLightSalmon(t.to_umpire)),modelValue:e.assayLotsToDisplay[t.lot_number-1].final_assay,"onUpdate:modelValue":a=>e.assayLotsToDisplay[t.lot_number-1].final_assay=a,placeholder:0,type:"number",onKeydown:a=>e.onKeyDown(t,"final_assay",a),nullable:!0,id:`assaylots-7-${t.lot_number}`},null,8,["class","modelValue","onUpdate:modelValue","onKeydown","id"])])),_:2},1032,["headers","items"]),d(' <v-button \r\n\t\t\t\t\t\t\tclass="margin-top-16px"\r\n\t\t\t\t\t\t\t@click="addNewAssayLot" \r\n\t\t\t\t\t\t\t:disabled="isComposite || (isEditingDisabled || isContractNotFound) || (!itemMethod || !itemCommodity)" \r\n\t\t\t\t\t\t\tv-tooltip.bottom="isComposite ? \'Cannot add new lot for composite items\' : ((isEditingDisabled || isContractNotFound) ? (disableEditAssayButtonReason ?? \'Editing has been disabled\') : null)" \r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tAdd New Lot\r\n\t\t\t\t\t\t</v-button> '),p((r(),c(N,{class:"margin-top-16px",onClick:e.syncWeightLots,loading:e.isSyncingWeightLots,disabled:e.isAddingNewAssay||!e.itemMethod},{default:v((()=>[_(" Sync Weight Lots ")])),_:1},8,["onClick","loading","disabled"])),[[M,e.isAddingNewAssay?"Weight lots are up to date when creating a new assay":e.itemMethod?`Sync assay lots with the weight lots for method ${e.itemMethod}`:"Please select a method first",void 0,{bottom:!0}]])]))],8,Ge)])])),_:1},8,["modelValue","onToggle","onCancel","subtitle"]),m(T,{modelValue:e.confirmCloseDrawerOverlay,"onUpdate:modelValue":t[22]||(t[22]=t=>e.confirmCloseDrawerOverlay=t)},{default:v((()=>[m(D,null,{default:v((()=>[m(O,null,{default:v((()=>[_("Unsaved changes")])),_:1}),m(C,null,{default:v((()=>[_("Are you sure you want to leave this page?")])),_:1}),m(L,null,{default:v((()=>[m(N,{secondary:"",onClick:e.confirmCloseDrawer},{default:v((()=>[_("Discard Changes")])),_:1},8,["onClick"]),m(N,{onClick:e.closeConfirmCloseDrawerOverlay},{default:v((()=>[_("Keep Editing")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),m(T,{modelValue:e.confirmSaveOverlay,"onUpdate:modelValue":t[23]||(t[23]=t=>e.confirmSaveOverlay=t)},{default:v((()=>[m(D,null,{default:v((()=>[m(O,null,{default:v((()=>[_("New changes made")])),_:1}),m(C,null,{default:v((()=>[_("The changes will be saved even if other changes to the Parcel is not saved. Are you sure you want to save?")])),_:1}),m(L,null,{default:v((()=>[m(N,{secondary:"",onClick:e.closeConfirmSaveOverlay},{default:v((()=>[_("Keep Editing")])),_:1},8,["onClick"]),m(N,{loading:e.isEditingLotsViaApi,onClick:e.confirmSave},{default:v((()=>[_("Save Changes")])),_:1},8,["loading","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),m(T,{modelValue:e.confirmDeleteAssayOverlay,"onUpdate:modelValue":t[24]||(t[24]=t=>e.confirmDeleteAssayOverlay=t)},{default:v((()=>[m(D,null,{default:v((()=>[m(O,null,{default:v((()=>[_(f(`Delete ${(e.isComposite?e.itemCommodity:e.selectedAssayForDrawerDisplay[0]?.commodity_name)??"commodity"} (${e.itemMethod}) assay`),1)])),_:1}),m(C,null,{default:v((()=>[_("This action is permanent and can not be undone. Are you sure you would like to proceed?")])),_:1}),m(L,null,{default:v((()=>[m(N,{secondary:"",onClick:e.closeConfirmDeleteAssayOverlay},{default:v((()=>[_("Keep Editing")])),_:1},8,["onClick"]),m(N,{class:"v-button-red",loading:e.isEditingLotsViaApi,onClick:e.confirmDeleteAssay},{default:v((()=>[_("Delete")])),_:1},8,["loading","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),p((r(),c(N,{class:"margin-top-16px",onClick:t[25]||(t[25]=()=>e.addAssayButtonHandler()),disabled:e.isEditingDisabled||e.isContractNotFound},{default:v((()=>[_("Add Assay")])),_:1},8,["disabled"])),[[M,e.isEditingDisabled||e.isContractNotFound?e.disableEditAssayButtonReason??"Editing has been disabled":null,void 0,{bottom:!0}]]),d(" <v-form\r\n\t\t\t:fields=\"[{\r\n\t\t\t\tfield: 'method', \r\n\t\t\t\tname: 'Method', \r\n\t\t\t\ttype: 'string',\r\n\t\t\t\tmeta: {\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tchoices: methodSelection\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, {\r\n\t\t\t\tfield: 'commodity', \r\n\t\t\t\tname: 'Commodity', \r\n\t\t\t\ttype: 'string'\r\n\t\t\t}, {\r\n\t\t\t\tfield: 'assay_uom', \r\n\t\t\t\tname: 'Assay UoM', \r\n\t\t\t\ttype: 'string',\r\n\t\t\t\tmeta: {\r\n\t\t\t\t\tcollection: 'navarch_parcel',\r\n\t\t\t\t\tfield: 'assay_uom', \r\n\t\t\t\t\tinterface: 'select-dropdown',\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tchoices: assayUnits\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}]\"\r\n\t\t\t:initial-values=\"{\r\n\t\t\t\tmethod: `${itemMethod}`,\r\n\t\t\t\tcommodity: `${itemCommodity}`,\r\n\t\t\t\tassay_uom: `${itemAssayUoM ?? ''}`\r\n\t\t\t}\"\r\n\t\t/> ")])},Ve.__scopeId="data-v-64969d30",Ve.__file="src/interface.vue";var _t=t({id:"assay_result_table",name:"Assay Result Table",icon:"box",description:"Custom interface for assay result",component:Ve,options:null,types:["string"],group:"standard"});export{_t as default};
